
2007-05-22 14:48	smcgrawx@frxii.com

	Tag: T016 {65}

2007-05-22 09:19	smcgrawx@frxii.com

	* Makefile [1.15]
	Fix: Error in mv command of target "examples.txt". {62}
	Fix: Examples file at Monash ftp site has extension ".utf", not
	  ".utf8". {59}

	* perl/exparse.pl [1.5]
	Fix: Was failing to set ginf column value in gloss table output. {64}

	* perl/jmparse.pl [1.27]
	Fix: Some error messages included the seq number twice. {63}

	* perl/lib/jmdictxml.pm [1.13]
	Add lang "th" (Thai) which appears in the 2007-05-22 jmdict.xml file.
	  {60}

	* perl/lib/kwstatic.pm [1.4]
	Update due to changes in prerequite files. {61}

2007-05-21 22:54	smcgrawx@frxii.com

	* doc/Makefile [1.2]
	Move all the change log tools into doc/chglog/. {58}

2007-05-21 18:00	smcgrawx@frxii.com

	* Makefile [1.14]
	Fix: Fix copy/paste errors in the messages produced by target "all".
	  {52}
	In target "dist" remove most of the exclude options since practice
	  now is to make a distribution archive from a freshly checked out
	  working directory.  In target "clean", add the file patterns that
	  used to be excluded by target "dist", in case one wants to do
	  things the old way. {53}

	* README.txt [1.10]
	Update the documentation for the schema changes related to jmdict dtd
	  1.06 and gloss tags. {44}
	Rewrite the install section based on using Makefile (which I have
	  verified is useable on both Unix and Windows). {49}

	* doc/Makefile [1.1]
	* doc/README.txt [1.1]
	New: Added new files. {57}

	* doc/schema.dia [1.4]
	* doc/schema.odt [1.4]
	Update the documentation for the schema changes related to jmdict dtd
	  1.06 and gloss tags. {44}

	* doc/schema.html [1.3]
	* doc/schema.png [1.6]
	* perl/lib/kwstatic.pm [1.3]
	* pg/drpindex.sql [1.3]
	* pg/mkindex.sql [1.12]
	Regenerated to track changes in prerequisite files. {36}

	* perl/jmparse.pl [1.26]
	Update for the JMdict dtd changes to <lang>, <dial>. {40}
	Add new command line option, -g, to restrict glosses processed for
	  loading into database to those of the given language.  (This
	  allows, for example, extracting only english glosses from the full,
	  multi-language JMdict file.) {39}
	Add support for gloss tags. {41}

	* perl/lib/Makefile [1.2]
	Add new files kwginf.csv and kwlsrc.csv to dependencies. {28}
	Move mkkwmod.pl to ./tools/ directory from ./perl/. {46}

	* perl/lib/jmdict.pm [1.22]
	* perl/lib/jmdictpgi.pm [1.3]
	* perl/lib/tal/entr.tal [1.8]
	* perl/lib/tal/nwconf.tal [1.4]
	Update for the JMdict dtd changes to <lang>, <dial>. {40}
	Added gloss tag support. {43}

	* perl/lib/jmdictxml.pm [1.12]
	Update language tags to those currently in use in the 2007-05-01
	  JMdict xml file.  Id's are from pg/kwlang.csv which includes all
	  the ISO-639-1 two-letter codes, plus "ai" (Ainu). {27}

	* perl/showentr.pl [1.14]
	Dialect, lsource (was lang) display updated. {42}
	Added gloss tag support. {43}

	* pg/Makefile [1.3]
	Move mkindex.pl to ./tools/ directory from ./pg/. {45}

	* pg/data/kwginf.csv [1.1]
	New table for gloss tags. {31}

	* pg/data/kwlang.csv [1.2]
	Generate from the ISO-639-3 list (iso-639-3_20070323.tab) at
	  http://www.sil.org/iso639-3/download.asp, using script
	  perl/tools/mklangcsv.pl (which is not in CVS yet). {30}

	* pg/data/kwlsrc.csv [1.1]
	New table for lsource types. {32}

	* pg/data/kwmisc.csv [1.2]
	Changes to "misc" keywords in jmdict dtd 1.06.    Add keyword "eK"
	  (uppercase "K"), deprecate "ek" (lowercase "k")  and "gikun". {54}

	* pg/data/kwrinf.csv [1.2]
	Rinf "ateji" keyword deprecated in jmdict dtd 1.06. {55}

	* pg/loadkw.sql [1.5]
	Add the new tables kwginf, kwlsrc. {33}

	* pg/mkperms.sql [1.8]
	Add the new tables kwginf, kwlsrc, lsrc to load list, remove table
	  lang. {34}

	* pg/mktables.sql [1.17]
	Add >0 constraints to rdng.rdng, kanj.kanj, sens.sens, gloss.gloss,
	  hist.hist.  This makes it a little easier to enforce consecutive
	  numbering on these columns. {25}
	Changes to track jmdict changes:  + Gloss tags: add column ginf to
	  table gloss and new table  kwginf.  + <dial> now a child of
	  <sense>: make table dial child table of sense.  + <lang> replaced
	  by <lsource>.  Replace table "lang" with table "lsrc" and make
	  child table of "sens".  New table "kwlsrc". {26}

	* pg/mkviews.sql [1.17]
	Adjust functions dupentr and delentr for the dial, lsrc, and gloss
	  table changes. {35}

	* tools/mkindex.pl [1.3]
	Fix: Was creating bad "DROP INDEX" commands in drpindex.sql. {17}
	Move mkindex.pl to ./tools/ directory from ./pg/. {45}

	* tools/mkkwmod.pl [1.3]
	Add new files kwginf.csv and kwlsrc.csv to list used to generate
	  kwstatic.pm. {29}

2007-04-30 14:54	smcgrawx@frxii.com

	Tag: T015  Tagged prior to making changes for version 1.06 of the
	  JMdict XML DTD. {24}

	* perl/jmparse.pl [1.25]
	Fix: Sense notes were not being added to database. {3}

2007-04-26 20:00	smcgrawx@frxii.com

	* Makefile [1.13]
	Fix: Loadall target did not run xresolv.sql. {4}

	* pg/xresolv.sql [1.7]
	Fix: Bad table names. {5}

2007-04-26 11:00	smcgrawx@frxii.com

	* Makefile [1.12]
	Fix: Loadall target was loading jmnedict twice, examples not at all.
	  {6}

2007-04-26 09:00	smcgrawx@frxii.com

	* Makefile [1.11]
	exparse now writes raw xrefs to table xresolv like jmparse rather
	  than resolving at parse time.  This means examples.pgi need not be
	  regenerated when jmdict is. {22}

	* perl/exparse.pl [1.4]
	Since database access no longer needed for xref resolution, all  the
	  database stuff was ripped out. {8}
	Formerly, exparse would try to resolve the B line items against
	  jmdict entries while running.  Changed so that it now, like
	  jmparse.pl, doesn't resolve but writes the unresolved text
	  strings to table xresolv from where they will be resolved   later.
	  Since the Examples file identifies xref targets by   possibly a
	  reading, kanji, and sense number, the xresolv table  was expanded
	  with columns "rtxt", "ktxt", and "xsens" replacing  the single
	  "txt" column.  Also added a "ord" column since the   the B line
	  items may be repeated and order matched order of  appearance in the
	  A line text. {7}

	* perl/jmparse.pl [1.24]
	When creating xresolv table records, put text in field "rtxt" or
	  "ktxt" as appropriate. {10}
	Adjust the interval at with the progress bar dots are printed in
	  compensate for ever growing jmdict.xml file. {9}

	* perl/lib/jmdict.pm [1.22]
	Change jstr_classify() to consider any c.p. greater than 0x4E00 to
	  be a kanji character.  Previously is was >0x4E00 and <=0x9FFF but
	  that resulted in entries with kanji strings like "CTIF" (where "C"
	  is 0xFFxx) to be considered non-kanji even though it is stored in
	  a kanj table row. {11}

	* perl/lib/jmdictpgi.pm [1.3]
	In wrentr() and initialize(), adjust for table xresolv now having
	  columns "rtxt" and "ktxt", rather than just single column "txt".
	  {13}
	Fix: Remove erroneous backslash in wrentr() that was causing hist.who
	  fields to be generated as the string "SCALAR(..." {12}

	* pg/Makefile [1.2]
	Fix: Wrong name for mkindex.pl command. {14}

	* pg/drpindex.sql [1.2]
	* pg/mkindex.sql [1.11]
	Regenerated due to changes in mktables.sql. {19}

	* pg/mktables.sql [1.16]
	Replaced column txt in table xresolv with columns "ord", "rtxt",
	  "ktxt", "xsens".  See perl/exparse.pl change note for more info.
	  {15}

	* pg/mkviews.sql [1.16]
	New view hdwds. {16}

	* pg/postload.sql [1.7]
	Don't call xresolv.sql anymore.  That is now called directly from
	  makefile. {20}

	* pg/xresolv.sql [1.6]
	Completely rewritten.  Now resolves all but 33 jmdict xrefs
	  (2007-04-15 JMdict). {21}

2007-04-15	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.21]
	Fix: setids(): Glosses numbers were being incremented though an 
	  entire entry and not starting at 1 in each sense.
	Fix: Xrefs not being shown in web pages or showentr.pl because
	  the xref entry summary list ($erefs) not being populated correctly
	  xrefdetails().

	* perl/lib/jmdictpgi.pm [1.2]
	Fix: exparse.pl was not generating any xref table entries in its 
	  output file because jmdictpgi.pm::wrentr() was not processing the
	  entry's _xref or _xrer lists.

	* perl/exparse.pl [1.3]
	Added some comments.

	* Makefile [1.10]
	Fix: Add missing examples.dmp dependecy in loadex target.

2007-04-14	smcgrawx@frxii.com

	* pg/data/kwdial.csv [1.1]
	* pg/data/kwfld.csv [1.1]
	* pg/data/kwfreq.csv [1.1]
	* pg/data/kwkinf.csv [1.1]
	* pg/data/kwlang.csv [1.1]
	* pg/data/kwmisc.csv [1.1]
	* pg/data/kwpos.csv [1.1]
	* pg/data/kwrinf.csv [1.1]
	* pg/data/kwsrc.csv [1.1]
	* pg/data/kwstat.csv [1.1]
	* pg/data/kwxref.csv [1.1]
	New file.  Replaces former .sql file of same name.

	* pg/data/kwdial.sql [1.5]
	* pg/data/kwfld.sql [1.4]
	* pg/data/kwfreq.sql [1.7]
	* pg/data/kwkinf.sql [1.4]
	* pg/data/kwlang.sql [1.4]
	* pg/data/kwmisc.sql [1.5]
	* pg/data/kwpos.sql [1.6]
	* pg/data/kwrinf.sql [1.5]
	* pg/data/kwsrc.sql [1.5]
	* pg/data/kwstat.sql [1.4]
	* pg/data/kwxref.sql [1.3]
	File deleted and replaced by corresponding .csv file.

	* pg/loadkw.sql [1.4]
	Change to load .csv files instead of .sql files.

	* perl/mkkwmod.pl [1.2]
	Now creates a kwstatic.pm file from the .csv files in 
	  pg/data/ rather than from the database kw* tables.  
	  No longer requires any database access.

	* perl/lib/Makefile [1.1]
	New file: Updates kwstatic.pm when pg/data/kw*.csv file changes.

	* perl/lib/kwstatic.pm [1.2]
	Fix: Previous version erroneously contained src keywords I 
	  use in my personal implementation.
	Updated to incorporate new pos "ctr" (counter) keyword added 
	  to kwpos.csv.

	* pg/data/kwpos.csv
	* perl/lib/jmdictxml.pm
	Add 'ctr' (counter) keyword that was added to jmdict dtd 
	  around 2007-04-11,  See edict mailing list, 4/11/07 from
	  Jim Breen.

2007-04-14	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.20]
	Fix: debugging code added to dbread() in previous rev was misplaced.
	Fix: in addentr() the numbers going into rdng.rdng and kanj.kanj
	  were being incremented by 2 each record rather than 1.
	I previously tried to allow caller of EntrList() to supply the 
	  entr.id's it needs in either a temp table, or as a sql WHERE
	  clause with args.  The latter never worked right so that 
	  capability was removed.  
	That change allowed the rest of the sql statements in EntrList()
	  to be simplified.
	Moved the code that reads the entry summaries for all the entry's
	  xref out of EntrList() and into its own sub (xrefdetails()) that
	  can be called (or not) independently.
	In xrefdetails() reads example xrefs seperately so that the number
	  returned can be limited.
	In xrefdetails() use a long sql statement to read the xref entry
	  summary data because when it is a view, and joined with the temp
	  table, it is extraordinarily skow (5+ minutes!)  Since the same
	  view works fine (<100mS) when restricted by a WHERE clause, it
	  seems like the PG query planner is messing up or beyond its
	  capabilities.  Either way, the issue needs to be taken up with 
	  the postgresql people and the current arrangement is a workaround.
	Added function setkeys() that will set the primary and foreign key
	  numberic fields in the records in an entry object based on the 
	  the structural relations in the object.  This can be called 
	  prior to writing an object to the database.

	* perl/lib/jmdictpgi.pm [1.1]
	New file.  Three functions to aid in writing .pgi files.

	* perl/lib/kwstatic.pm [1.1]
	New file.  Static (no database access needed) definitions of kw*
	  table data.  Machine generated (currently not automatically) by
	  perl/mkkwmod.pl but included in cvs to simplify install procedure.

	* perl/mkkwmod.pl [1.1]
	New file.  Reads kw* table data from database and creates file
	  kwstatic.

	* perl/exparse.pl [1.2]
	Renamed from exload.pl.  Instead of writing examples entries and 
	  cross-refs directly to the database, exparse will generate a 
	  intermediate .pgi file that uses Postgresql COPY commands and
	  can be loaded into the database bt jmload.pl much faster.
	  The previous version took 12+ hours to load the 8MB Examples
	  file on a 800MHz desktop PC.  It now loads in 12+2+30m (with
	  indexes and foreign keys still in place).

	* perl/jmparse.pl [1.23]
	Previous version parsed xml file and directly generated the COPY
	  statements used to load data into database.  New version parses
	  xml file and creates a standard jmdict entry object.  Then, 
	  the COPY statements are generated from the object.  This 
	  separation of parsing and output generation will allow generating
	  load files from sources other than jmdict xml files, and the
	  parsing jmdict files to produce other output forms than
	  load files, for example, writing to the database directly.
	  It also allows a a single entry to be skipped if problems 
	  occur during parsing without aborting the entire parse.
	Use the pgi functions in perl/lib/jmdictpgi.pm.
	Account for change in "entr" table schema (see pg/mktqable.pl).
	Don't die if an error occurs when parsing.  Instead write message
	  to stderr and log file, skip that entry, and continue with the
	  next one.

	* perl/jmload.pl [1.3]
	Change jmloasd.pl's default output filename extention from .pgx
	  to .pgi which is more memonic of an intermediate file.
	Fix: Correctly adjust $eid so that when "-i 1" is given, resulting
	  .dmp file entr id numbers will start at 1, not 2.

	* perl/showentr.pl [1.13]
	Call xrefdetails() to get cross-ref info since it is no longer
	  automatically included in the entries returned by EntrList().
	Add display of glosses to cross-references.

	* pg/mkviews.sql [1.15]
	Rewrite view xrefesum to give better performance.  Previously
	  this view was horribly slow when tested on a database that
	  had the Examples files loaded.  With 2M+ xref rows, it was
	  taking more that 5 minutes to run.
	Change view xrefsum back to use esum rather than eksum because
	  having the gloss in the entry summary is important when displaying
	  Example cross-ref's.  (This will probably change back again 
	  because Example entries won't be part of production system, 
	  but is useful during development, and possibly to other users 
	  of this code.)

	* pg/reload.sql [1.4]
	* pg/postload.sql [1.6]
	Reorganized so that everything needed for creating the schema
	  is done in reload.sql, and everything needed after the tables
	  have been populated (including index and foreign key creation)
	  is done in postload.sql.

	* pg/mkindex.sql [1.10]
	* pg/mkfk.sql 
	* pg/drpindex.sql [1.1]
	* pg/mkindex.pl [1.1]
	* pg/Makefile [1.1]
	mkindex.sql and drpindex.sql (new files) are generated by mkindex.pl
	  by extracting the information from mktables.sql.  mktables.sql
	  also contains the foreign keys that were formerly in mkfk.sql
	  (now deleted).  This allows all the information about a table to
	  be kept together but executed independently so that indexes/fk's
	  be dropped prior to doing bulk loads.  

	* pg/mktables.sql [1.15]
	Moved the commands for index and foreign key creation into 
	  mktables.sql, but as non-executable comments, since they should
	  not be executed until after the tables are populated.
	Add column "srcnote" to table "entr".  This is to allow giving
	  additional src locator info for the entry, beyond the numberic
	  "seq" number.  

	* pg/data/kwsrc.sql [1.5]
	Change id of examples from 203 (which effectively inactivated it) 
	  to 3 (maaking it active.)  For the implementation for Jim Breen,
	  this will interactively changed back to 203.

	* pg/syncseq.sql [1.8]
	Have it also do a "vacuum analyze" since it is executed after
	  doing a bulk data load.

	* perl/cgi/entr.pl [1.8]
	Call xrefdetails() to get cross-ref info since it is no longer
	  automatically included in the entries returned by EntrList().

	* perl/lib/tal/entr.tal [1.8]
	* perl/lib/tal/newconf.tal [1.4]
	When kanji/reading enclose the reading in brackets only if both
	  kanji and reading are present.  Formerly assumed reading was
	  always present so checked only for presentce of kanji.
	Add display of glosses to cross references.

	* perl/cgi/srchform.pl [1.9]
	* perl/lib/tal/srchform.tal [1.9]
	Display src checkboxes in table rather than row.

	* Makefile [1.9]
	Adjust for change in default jmload.pl output from .pgx to .pgi.
	Add targets for getting, processing and loading the jmnedict and
	  examples files.
	Add loadall targets to get and load everything.
	Update info printed for default target.
	Explicitly provide a logfile name to jmparse in the jmdict.pgi 
	  and jmnedict.pgi target to prevent one from overwrite the other
	  when both target executed sequentually.

	* README.txt [1.9]
	Updated manifest and minor adjustments of install procedure.
	  Still undocumented in install procedure for jmnedict and examples
	  files.

2007-03-15	smcgrawx@frxii.com

	* perl/jmload.pl [1.2]
	Fix: Code in get_max_ids() was still trying to read hist.id which
	  no longer exists.

	* perl/exload.pl [1.1]
	New file.  Load database from examples file.  This version is
	  extremely slow (~12 hr on 900Mhz desktop pc on full examples
	  file, and algorithm for resolving text to db entry needs more 
	  work.  Commited for the historical record.

	* perl/lib/jmdict.pm [1.19]
	Add debugging statement to print sql and args received by dbread()
	  and dbinsert().

	* perl/lib/jmdictxml.pm [1.10]
	Add struct for decoding the A line notes in Examples file.

	* Makefile
	Remove noisy echo commands.

2007-03-14	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.18]
	In addentr(), don't do a commit.  Caller may want to add multiple
	  entries before commiting.

	* perl/cgi/nwsub.pl [1.7]
	Do explicit commit after calling addentr() since that function 
	  no longer does a commit for us.

2007-03-13	smcgrawx@frxii.com

	* perl/jmparse.pl [1.22]
	Name change: was load_jmdict.pl
	Now creates an intermediate .pgx file that requires post-poscessing
	  with jmload.pl, rather than a .dmp file directly.  The .pgx file 
	  contains relative entr.id numbers rather than fixed ones.  This
	  allows the file to be loaded into different databases that require
	  different entr.id numbers, by rebasing with the fast jmload.pl
	  progrm rather than rerunning slow load_jmdict.pl from scratch.
	Track table audio and hist schema changes.

	* perl/jmload.pl [1.1]
	New file: rebase the relative entr.id numbers in a .pgx file
	  generated by jmparse.pl and create a Postgresql dump file
	  suitable for loading into a jmdict database.

	* perl/cgi/nwconf.pl [1.6]
	Track table audio and hist schema changes.

	* perl/cgi/nwsub.pl [1.6]
	Force entr.src=1 (jmdict) since jmdict::addentry() doesn't anymore.

	* perl/lib/jmdict.pm [1.17]
	Track table audio and hist schema changes.
	Don't force src to 1 (jmdict); function should be able to add 
	  any kind of entry.
	Force a seq number only if one not already set, and src=1 (jmdict).
	  Non-jmdict entries may use different sequence numbering.

	* perl/showentr.pl [1.12]
	* pg/mktables.sql [1.14]
	* pg/mkviews.sql [1.14]
	* pg/mkindex.sql [1.9]
	* pg/mksyncseq.sql [1.7]
	Tables audio and hist now use composite primary keys like 
	  all the other tables rather than SERIAL pks.  Should have done
	  this as part of the 2007-02-11 pk/fk change.

	* Makefile [1.7]
	Track the split of load_jmdict.pk into jmparse.pl an jmload.pl.

	* doc/schema.dia [1.3]
	* doc/schema.png [1.5]
	* doc/schema.odt [1.3]
	* doc/schema.html [1.2]
	Track table audio and hist schema changes.

	* README.txt [1.8]
	rack the split of load_jmdict.pk into jmparse.pl an jmload.pl.

2007-03-13	smcgrawx@frxii.com

	* T014 tag
	Released on Arakawa.

	* perl/load_jmdict.pl 1.21]
	Fix: -i option didn't work.
	Fix: entr.src not set for deleted entries created from comments
	  which cause subsequent db load t fail.
	Print initial values eid, hid values when starting, in case user 
	  (me) forgets about -i option and runs before database was init'd.

	* perl/showentr.pl [1.11]
	FIX: rinf keywords were printing using text from kinf.

	* perl/lib/jmdict.pm [1.16]
	The erefs query is very slow.  Until we can speed it up, get a
	  speed improvement for majority cases by not running it if we
	  know there are no xrefs because $xref and $xrer are empty.

	* pg/mkviews.sql [1.13]
	Fix: stored procedure "dupentr" had several syntax errors.
	Add view eksum.  Like esum but doesn't include senses/glosses.
	Change view xrefesum to use eksum instead of esum to speed it 
	  up a little.

2007-03-10	smcgrawx@frxii.com

	* lib/tal/srchform.tal [1.7]
	Make jmdict dictionary checked by default.  Requires fix to
	  Petal/Utils/Decode.pm, see 
	  http://article.gmane.org/gmane.comp.lang.perl.modules.petal/369

2007-03-10	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.20]
	Support for loading JMnedict data.
	Option to start entr.id number at other than 1, either by 
	  giving explicitly on command line, or reading from database.
	Add command line option to create temp files in other than
	  current directory.

	* cgi/srchform.pl [1.8]
	Support for "src" group:
	When generating "src" option list, grep out item>200 as done
	  for other option groups.
	Pass the src option group to the tal template.

	* lib/tal/entr.tal [1.7]
	Support for "src" group: show dict after seq number.

	* lib/tal/srchform.tal [1.7]
	Support for "src" group: add "src" section.

	* lib/tal/srchres.tal [1.4]
	Support for "src" group: show a single letter indicator
	  for each result that that indicates its dictionary.

	* lib/jmdictxml.pm [1.9]
	* pg/data/kwpos.sql [1.6]
	Support for jmnedict data: add pos keywords for jmnedict
	  <name_type> tags.

	* pg/mkviews.sql [1.12]
	Support for "src" group: add columns entr.src, .stat, and .notes
	  to views esum and xrefesum.

	* pg/data/kwsrc.sql [1.4]
	Support for "src" group: change id of keyword "examples" from
	  3 to 203 so that is won't show up in srchform.pl/tal src
	  section checkboxes.

2007-03-09	smcgrawx@frxii.com

	* T013 tagged
	Released on Arakawa.

	* doc/schema.odt [1.2]
	Many tweeks.
	Added new section "Using SQL".

	* doc/schema.html [1.1]
	New file.  Add html version exported from schema.odt for 
	  those without Open Office.

	* doc/tut0.pl [1.1]
	* doc/tut1.pl [1.1]
	* doc/tut2.pl [1.1]
	* doc/tut3.pl [1.1]
	New files.  API tutorials.

	* perl/showentr.pl [1.10]
	Fix: Xrefs display broken since jmdict.pm[1.8] (when EntrList() 
	  was changed to put xref summary info in {_erefs} rather than
	  {_xref}).  Regression tests would have caught this.
	Added a lot of comments.

	* perl/lib/jmdict.pm [1.15]
	Added a lot of comments.
	EntrList(): make all three restriction lists available from top
	  of entr object.

	* perl/lib/jmdicted.pm [1.1]
	New file.  Functions for making (and to come, parsing)
	  edictish text.

	* Makefile [1.6]
	Include doc files in target "dist".

	* README.txt [1.7]
	Added documentation section.
	Updated manifest.

2007-03-05	smcgrawx@frxii.com

	* pg/mkviews.sql [1.11]
	As result of the 2007-02-11 pk/fk change, the dupentr stored 
	  proc can be greatly simplified:  all loops can be removed 
	  and all needed rows copied with simple insert statements.
	Remove unused views "xsum" and "xsumr".

	* doc/
	Add new directory for documentation.

	* doc/schema.dia [1.2]
	* doc/schema.png [1.5]
	Move from top-level directory into doc/.  This was done in
	  the CVS respository so it is retroactive.	

	* doc/schema.odt [1.1]
	New file.  Open Office Writer documentation for the database
	  schema.

	* README.txt [1.6]
	Update for new doc directory, addition of the schema.odt file.

2007-02-27	smcgrawx@frxii.com

	This change set replaces the kfreq and rfreq tables, that 
	held frequency-of-use data for readings and kanji respectively,
	with a single table, freq.  Most foU elements refer not to
	a reading or kanji independently, but to a reading-kanji pair.
	The freq table has columns [entr,rdng,kanj,kw,value] that 
	allows representation of rk pairs.  To allow for the minority 
	cases were a FoU datum refers to an individual reading or kanji
	we allow rdng and kanj to be NULL, with a constraint that forces
	at least one to be non-null.  Ideally we would like the table's
	primary key to be the first four columns, but primary keys may
	not contain nullable columns in many rdbms' including Postgresql.
	However we do enforce a unique constraint on each row, although
	the implementation is non-obvious since a standard unique 
	constraint does not work as desired with nullable columns.

	One problem not yet fixed is that when a reading (or kanji) is
	paired with two kanji (or reading) with the same FoU rtag, the
	tag will displayed twice on the reading (or kanji).  This is 
	easily fixed, but can be fixed in a couple different places and
	I'm not sure yet which is best.

	* pg/mktables.sql [1.13]
	* pg/mkfk.sql [1.8]
	Replace tables"rfreq" and "kfreq" with table "freq".  

	* pg/mkindex.sql [1.8]
	We can't put a pk on table freq because the rdng and kanj columns 
	  are nullable so a unique index is next best thing.  But nullable
	  columns also prevent a stock unique constraint from working as
	  we want.  So we build a special index that will handle nulls. 

	* pg/mkviews.sql [1.10]
	Adjust wiews pkanj, prdng, and dupentr for the freq table change.

	* pg/mkperms.sql [1.7]
	Adjust for replacement of rfreq/kfreq with freq.

	* load_jmdict.pl [1.19]
	Adjust for replacement of rfreq/kfreq with freq.  Specifically
	  we have to accumulate but not process the ke_pri and re_pri
	  info while processing the reading and kanji elements, and
	  afterwards, find any matching re_pri and ke_pri tags and
	  coallesce them before writing the freq table data.

	* perl/lib/jmdict.pm [1.14]
	In matchup() don't die if all children records are not assigned
	  to a parent.  We need this because we will read "freq" tables
	  records, some of which be be assigned to rdng parents, some to
	  kanj parents.
	EntrList(): use data from freq table rather than rfreq and kfreq.

	* perl/cgi/srchres.pl [1.9]
	Adjust code in freq_srch_clause() for schema change.

	* schema.dia [1.2]
	Update for the schema change: replace tables kfreq, rfreq with
	  table freq.

	* schema.png [1.4]
	Regenerated from updated schema.dia.
	Export with dimensions 1508x1024 rather than the default 1033x687
`	  which makes text more readable.

2007-02-25	smcgrawx@frxii.com

	* Tag T012

2007-02-24	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.13]
	The big pk/fk change made on 2007-02-11 makes it possible to 
	  greatly simplify the queries used in EntrList() to read in
	  a (set of) object(s).

2007-02-24	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.18]
	* pg/mktables.sql [1.11]
	Change primary key of tables rfreq and kfreq to include column
	  "value".  This will allow a kanji or reading to have multiple
	  freq tag belonging to the same scale (e.g. a reading could 
	  have both "ichi1" and "ichi2" tag simultaneously.)  In
	  load_jmfict.pl remove function freqs() which was responsible
	  for discarding duplicates.

	The handling of re_inf and ke_inf tag is broken.
	I had not realized that when two tags with the same scale (e.g.
	"nf20" and "nf34" occurred on the same keb or reb element, it 
	indicates a pairing with another element with the same tag [1][2].  
	I was assuming the pri tags were independent and thus such conflicting 
	tags were illogical and dropped one.  The changes to the above two
	files allow the rfreq and kfreq tables to store all the pri tags,
	for a reb/keb, even if they have the same scale.  This makes the 
	data model identical with that in the jmdict xml file, but it is
	(from a rdbms point of view) unnormalized and should be improved.

	This will probably need a schema change to fix, since we need 
	to model a different kind of information (pri information about 
	reading-kanji pairs, not (neccessarily) about individual readings
`	or kanji).  But until we do that fix, this will allow the database 
	to present the same info as wwwjdic, and contain all the tag into 
	which will help when exploring for a better solution.

	[1] Jim Breen, email to edict mailing list, 2007-02-15 in response
	    to Marc (frenchquacky).
	[2] Comment describing the ke_pri entity in the jmdict xml DTD.

2007-02-23	smcgrawx@frxii.com

	* perl/lib/tal/srchform.tal [1.4]
	* perl/cgi/srchform.pl [1.5]
	* perl/cgi/srchres.pl [1.6]
	Add section for fld (field) attributes.
	Correct typo in Readng Info caption.
	Add Reset button.

2007-02-22	smcgrawx@frxii.com

	* perl/lib/jmdictxml.pm [1.8]
	Fix: Update value of rinf.uK to match kwrinf.sql.

2007-02-21	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.17]
	Check for use of deprecated keywords and print warning
	  to logfile.
	Add comments.
	
	* perl/lib/jmdictxml.pm [1.7]
	Deprecate items that are no longer used in current jmdict 
	  xml files.

	* pg/data/kwmisc.sql [1.5]
	* pg/data/kwpos.sql [1.5]
	* pg/data/kwrinf.sql [1.5]
	Deprecate items that are no longer used in current jmdict 
	  xml files.
	Add comment about tracking jmdictxml.pm.

	* pg/data/kwdial.sql [1.5]
	* pg/data/kwfld.sql [1.4]
	* pg/data/kwfreq.sql [1.7]
	* pg/data/kwkinf.sql [1.4]
	* pg/data/kwlang.sql [1.4]
	Add comment about tracking jmdictxml.pm.

	* Makefile [1.5]
	In target "clean", don't delete skipped_comments.log since 
	  load_jmdict.pl no longer creates that file.

	* perl/lib/tal/srchform.tal [1.4]
	* perl/cgi/srchform.pl [1.5]
	* perl/cgi/srchres.pl [1.6]
	Add search for kinf, rinf attributes.

	* pg/xresolv.sql [1.5]
	Remove the query that displays unresolvable xrefs.  That info
	  is lost in postload.sql's copious output and can be dislayed
	  later if needed.

2007-02-21	smcgrawx@frxii.com

	* perl/cgi/srchres.pl
	Fix: The change to allow searching for "spec2" kfreq and rfreq
	  values made to perl/cgi/srchform.pl[1.5] on 2007-02-19 was
	  incomplete.  Also need to change srchres.pl which was too
	   smart and "knew" spec had only a "1" value.
	Commented freq_srch_clause() function.

2007-02-20	smcgrawx@frxii.com

	* Makefile
	In target "jmdict.xml", remove JMdict file before running
	  wget.  If JMdict file exists, wget will create new file with
	  a ".1" suffix and rest of commands will operate on wrong 
	  file.

2007-02-20	smcgrawx@frxii.com

	* perl/load_jmdict.pl
	Don't skip "news1/2" frequency values any more.  Ref jb email to
	  edict list, 2007-02-20, in which he said he sometimes manually
	  changes news1/2 values so the <=/>nf24 correspondence is not
	  neccessarily true.  This change will add them to database so
	  can investigate best way to handle.
	Log skipped duplicate nfxx and newsx freq values.  jb edict list 
	  mail (2007-02-15 reply to frenchquacky) says that these are
	  (contrary to what I thought) significant.  Need to gather info 
	  on how/many where they are to formulate plan to handle since
	  current data model does not allow.
	Replaced the "skipped_comments" logging code with something more
	  general.  Accept a -l option for logfile name and use that for
	  all log messages.
	Set a global $::Seq with current seq number for use in log messages.
	  I don't think any line numbers other than for <entry> and comment
	  lines is available from XML::Twig, unless we set up tag handlers
	  which seems like a lot of work. 

	* perl/lib/jmdictxml.pm
	Add 'news' value to FREQs.  (See load_jmdict.pl comments.)
	Remove 'jdd' value from FREQs.  (This should have been done
	  along with the change to pg/data/kwfreq.sql on 2007-02-19.)

	* pg/data/kwfreq.sql
	Add 'news' keyword.  (See load_jmdict.pl comments.)

2007-02-19	smcgrawx@frxii.com

	* Makefile
	Get rid of most continued command lines.  This provides better error
	  termination and in the "all" target they did not display as desired
	  on Debian.
	Clarify the help message in the "all" target.

	* Changes.txt README.txt
	Obsfucate email address since these files now exposed on internet.

	* perl/cgi/srchform.pl [1.5]
	Remove line of code that supressed generating the "spec2" option box
	  since spec2 tags do actually exist.  Not sure why I thought they 
	  didn't.

	* pg/data/kwfreq.sql [1.5]
	Remove "jdd" keyword (no longer used in jmdict xml file) per jb post 
	  to edict email list, 2007-02-19.

2007-02-18	smcgrawx@frxii.com

	* Tag T011
	This code released as development snapshot jmdict-T011.tgz on Arakawa.

	* Makefile
	Fixes and enhancements.

	* perl/cgi/nwconf.pl
	Fix: When creating history record, was erroneously using ref's for 
	  {comment} and {who}, rather than strings.

	* perl/cgi/nwsub.pl
	Fix: Check for exactly one hist record, and reset it's timesstamp
	  since there could be long delay between when it was set in nwconf.pl
	  and when nwsub.pl gets it. 

	* perl/lib/jmdict.pm
	Fix: addentr() was not writing history records to the database.

2007-02-17	smcgrawx@frxii.com

	* Makefile
	New.  Nothing equivalent for Windows yet.  

	* README.txt
	More typos and tweaks.

	* perl/showentr.pl [1.9]
	Revert use of experimental KwdsStatic module.  That was not
	  supposed to get into main branch yet.

	* perl/lib/jmdict.pm
	Fix: trailing \n in the db credentials line read from jmdict.cfg
	  which was causing authentication to fail on my Fedora test machine.

	* perl/lib/tal/nwform.tal [1.2]
	Change header at top of page so there is some way to distingish
	  it from the real wwwjdict form.

2007-02-17	smcgrawx@frxii.com

	* pg/mkviews.sql
	Add new view ssum.
	Fix typo and tweak readability in GPL notice.

	* Changes.txt
	Added additional item to the "cons" section of the pk/fk change 
	  description in the 2007-02-11 entry.

2007-02-16	smcgrawx@frxii.com

	* README.txt [1.2]
	Fix typos and make other minor corrections.

	* perl/lib/tal/entr.tal [1.5]
	* perl/lib/tal/nwconf.tal [1.2]
	Fix: display of field keywords in senses was wrong.

	* perl/cgi/entr.pl [1.7]
	Fix: If a sense had a stagr restiction but no stagk restriction,
	  fmtstag() would erroneously include all the kanji in the
	  combined list it generates.
	Move db open code to jmdict.pm.
	Fix typo and tweak readability in GPL notice.

	* perl/cgi/nwconf.pl [1.3]
	* perl/cgi/nwform.pl [1.2]
	* perl/cgi/nwsub.pl [1.3]
	* perl/cgi/srchform.pl [1.3]
	* perl/cgi/srchres.pl [1.4] 
	Move db open code to jmdict.pm.
	Fix typo and tweak readability in GPL notice.

	* perl/lib/jmdict.pm [1.10]
	Fix: uninitialized string in EntrList() when $cond is a "where" clause.
	New: dbopen() function to encapsulate reading a config file to get
	  database login credenials, something needed by all the cgi scripts.
	Fix typo and tweak readability in GPL notice.

	* perl/lib/jmdictcgi.pm [1.3]
	* perl/lib/jmdicttal.pm [1.6]
	* perl/lib/jmdictxml.pm [1.5]
	* perl/load_jmdict.pl [1.15]
	* perl/showentr.pl [1.8]
	* pg/data/kwdial.sql [1.4]
	* pg/data/kwfld.sql [1.3]
	* pg/data/kwfreq.sql [1.4]
	* pg/data/kwkinf.sql [1.3]
	* pg/data/kwlang.sql [1.3]
	* pg/data/kwmisc.sql [1.4]
	* pg/data/kwpos.sql [1.4]
	* pg/data/kwrinf.sql [1.4]
	* pg/data/kwsrc.sql [1.3]
	* pg/data/kwstat.sql [1.4]
	* pg/data/kwxref.sql [1.3]
	* pg/mkfk.sql [1.7]
	* pg/mkindex.sql [1.7]
	* pg/mkperms.sql [1.6]
	* pg/mktables.sql [1.11]
	* pg/syncseq.sql [1.6]
	* pg/xresolv.sql [1.4]
	Fix typo and tweak readability in GPL notice.

2007-02-14	smcgrawx@frxii.com

	* schema.vsd
	Microsoft Visio file schema.vsd removed, replaced by schema.dia.

	* schema.dia
	Replaces schema.vsd.  Created with Dia (http://live.gnome.org/Dia)
	  which is a free (GPL) interactive drawing app with many of the
	  capabilities of Visio, and which runs under both Unix/Linux and
	  Windows.
	Updated for current schema.

	* schema.png
	Created from schema.dia.

2007-02-12	smcgrawx@frxii.com

	Add top level README.txt.
	Explicitly add GPL license terms.
	Remove obolete mysql/ and python/ directories.
	Remove perl/README.txt (replaced by ./README.txt)
	Remove perl/load_googits.pl (better to load raw data into database
	  table and create k/rfreq data with db query.  Will be documented 
	  later.)

2007-02-11	smcgrawx@frxii.com

	Changed primary keys on tables "rdng", "kanj", "sens", "gloss",
	  from a single SERIAL column to composite key based on the 
	  table "entr"s "id" column and the former "ord" column.  For
	  example, the primary key of the rdng table was surregate key
	  using a SERIAL column named "id".  Now it is a composite key
	  ("entr","rdng") where "entr" is a foreign key to entr.id, and
	  rdng a small number (1, 2,..) that replaces the former "ord"
	  column.  This change also affects all tables that have foreign
	  keys to the changed tables mentioned above.

	  Pros:
	  - More natural representation, e.g. reading now identified
	    as reading 3 of entry 55555, rather than an arbitrary 
	    number.
	  - Allows simpler code when dealing with audio, xrefs, etc,
	    because associated entry id is always available and does  
	    not have to be recovered using a more complicated query.
	  - Eliminates the need to lookup entries by sens.id, rdng.id, 
	    etc, in user interfaces.
	  - Eliminates some possibilities for inconsistencies such
	    as restr's that have reading and kanji from different
	    entries.
	  - Greatly reduces the space required by the largest tables
	    by eliminating a 4-byte integer from each row.
	  - Eliminates need for extra sequence tables to support the
	    SERIAL columns.
	  - Number of indexes needed is greatly reduced. 
	  Cons:
	  - Joins between the changed tables and their children now
	    need to be done on two columns rather than one.  Grand-
	    children will need three columns (but there aren't any yet.)
	  - Children of the changed tables need extra column (2-byte)
	    (but because these tables are much smaller than their parent
	    table, the space saving in the parent table greatly outweighs
	    the greater space needed by these child tables.)
	  - Ordering of senses, readings, etc within an entry is no longer
	    independent of the table's pk (bad in general), but this is not
	    a problem because:
	    - It *is* idependent of the full pk, only dependent of the part
	      of the pk relevent to one entry.
	    - Because all foreign keys to the pk's are created with "ON UPDATE
	      CASCADE", the within-entry part of the key can be changed to 
	      adjust the order, and any related foreign keys will automatically
	      be updated by the database to the new value.

	Other changes:
	--------------

	* perl/load_jmdict.pl
	Pk/fk changes on major tables.
	Use "Deleted..." comments to create D history records.  
	  Unparsable comments are written to new output file
	  skipped_comments.log.
	Add -e option to specify encoding used for interactive
	  and debug messages.  Program still bombs when converting
	  unconvertable characters (european character in gloss to
	  shift_jis on Windows for example) which limits usefulness
	  of this option.

	* perl/showentr.pl
	Pk/fk changes on major tables.
	Add -e option to specify encoding used for interactive
	  and debug messages.  Program still bombs when converting
	  unconvertable characters (european character in gloss to
	  shift_jis on Windows for example) which limits usefulness
	  of this option.

	* perl/cgi/entr.css
	Format for notes and debug info.

	* perl/cgi/entr.pl
	Pk/fk changes on major tables.
	Add debug info displayed at bottom of page such as executed
	  sql statements and various timings.) 
	Display xrefs as target entry info followed by a parenthesised
	  list of senses of there are more than one.

	* perl/cgi/nwconf.pl
	Pk/fk changes on major tables.
	Rewite code that handles xref info for display.
	Allow target sense specifiers in xref text field.
	Do more validity checking of xrefs (eg complain if the xref 
	  resolved to more than one entry and explicit senses given.)
	Display xrefs as target entry info followed by a parenthesised
	  list of senses of there are more than one.

	* perl/cgi/nwsub.pl 
	Pk/fk changes on major tables.
	Use xref info rather than eref info when writing new entry
	  to database.

	* perl/cgi/srchform.pl
	Pk/fk changes on major tables.
	Changes corresponding to the jmdict modularization changes.
	Remove id search capability for sens, rdng, kanj, gloss.
	build_search_sql() and extend_from() (nee mk_from_clause())
	  were complete rewritten.

	* perl/lib/jmdict.pm
	Pk/fk changes on major tables.
	Make into regular perl module 
	Collect debug info for later displaye (such as executed sql 
	  statements and various timings.) 
	In Find() address performance problem created my using a temp
	  table to keep search results, by running a VACUUM ANALYZE
	  on it.
	Functions irestr(),istagr(),istagk() no longer used and 
	  removed.
	New functions bld_erefs(),xrefs2xrefs(),xrefs2erefs(),fmtkr(),
	  zip(),linkrecs().
	
	* perl/lib/jmdicttal.pm
	Add pertal modifiers "h2l" (convert a hash to a list) and "join"
	  (like perl join()).

	* perl/lib/tal/entr.tal perl/lib/tal/nwconf.tal
	Pk/fk changes on major tables.
	Use tables rather than lists for layout.
	Use a consise display for cross-references with each target
	  entry listed only once.  (However, this does does not
	  provide for displaying xref notes.)
	When displaying cross-refs, explicity list target senses
	  when there is more than one. 
	Add debug info displayed at bottom of page such as executed
	  sql statements and various timings.) 

	* perl/lib/tal/srchform.tal
	Pk/fk changes on major tables.
	Remove id search capability for sens, rdng, kanj, gloss.

	* per/lib/tal/srchres.tal
	Add debug info displayed at bottom of page such as executed
	  sql statements and various timings.) 

	* pg/mkfk.sql pg/mktables.sql pg/xresolv.sql pg/syncseq.sql pg/mkindex.sql 
	Pk/fk changes on major tables.

	* pg/mkviews.sql
	Pk/fk changes on major tables.
	Replace view entr_summary with esum.
	New view xrefesum.

2007-01-29	smcgrawx@frxii.com

	* Tag T010
	This tag preceeds a major revision of the database schema
	  that affects nearly all the files.  At this point, the
	  loader scripts (load_jmdict.pl, reload.sql, postload.sql),
	  work as does showentr.pl and the cgi scripts although the
	  latter have not been tested much.  load_googits.pl may 
	  work but its easier/faster/better to load the raw googit
	  data into a temp table and update the kfreq/rfreq tables 
	  using queries based on that.
	  The python and mysql directories remain obsolete.

2007-01-29	smcgrawx@frxii.com

	* pg/syncseq.sql
	Remove duplicate line.

2007-01-28	smcgrawx@frxii.com

	* load_jmdict.pl
	Change increment used for "ord" columns from 10 to 1.

	* perl/lib/jmdict.pm
	Fix errant keystroke that causes syntax error.

2007-01-27	smcgrawx@frxii.com

	* perl/cgi/entr.css
	Add entry.notice and entry.caution formats.

	* perl/cgi/entr.pl
	Add validation of url parameters.
	Generate error page if parameters are bad..

	* perl/cgi/nwform.pl
	* perl/cgi/nwconf.pl
	* perl/cgi/nwsub.pl
	New: Page generators for Add New Word web interface.

	* perl/lib/jmdict.pm
	Fix: jstr_classify not setting KATAKANA bit properly.
	Add functions dbinsert() and addrentr().
	Provide more info in cross ref display: In EntrList()
	  change the sql used to read xref data.
	
	* perl/lib/jmdictcgi.pm
	New: Support functions for the cgi code.

	* perl/lib/tal/entr.tal
	Provide more info in cross ref display: adjust template to
	  use more detailed xref data.
	Display sense notes.
	Display id info as {id/ord} rather than {ord/id}.
	Comment out gloss lang since we will be using the english
	  only jmdict from here on.  (The non-english enties in
	  the jmdict.xml file are merged in from other projects
	  and won't be maintained by the jmdict project, at least 
	  imediately.)
	Add h1 title.

	* perl/lib/tal/srchres.tal
	Add h1 title.

	* perl/lib/tal/srchform.tal
	Add notice about priority of Id Number search.
	Add usage notes at bottom of page.
	Make seq number search the defaut option (was entry id)
	Change titles of id number search text boxes.
	Change default for gA search compare from "<=" to ">=".
	Add h1 title.

	* perl/lib/tal/nwform.tal
	* perl/lib/tal/nwconf.tal
	New: Templates for Add New Word web interface.

	* perl/lib/jmdictxml.pm
	Fix: correct missing trailing space in expanded entity 
	  text for RINF/uk.

	* pg/syncseq.sql
	Update the new "seq" sequence (see mktables.sql).

	* pg/mkfk.sql
	Fix: missing fk in stagk to kanj.id.

	* pg/mktables.sql
	Add new sequence "seq" to provide seq numbers for table
	  "entr".  These expected to be obtained and used by the
	  application code -- they are not used as entr.seq default
	  values.

	* pg/mkviews.sql
	Provide more info in cross ref display: replace view sref
	  with xsum and xsumr for generating sens->entry xref records
	  from db's native sens->sens data.

2007-01-15	smcgrawx@frxii.com

	* perl/load_googits.pl [1.3]
	Fix: was warning about texts that resolved to multiple
	  entries but still added the [kr]freq googits values.
	  Now it skips them.

	* pg/mkviews [1.5]
	Add views pkanj and prdng to give a view of kanj or
	  rdng table with additional column that indicates if
	  the kanj/rdng would have "P" tag in edict.

2007-01-15	smcgrawx@frxii.com

	* perl/load_googits.pl [1.2]
	Fix call dbi method disconnect() (was typo finish()).

	* pg/mkviews.sql [1.4]
	Explicitly create the plpgsql language since it does not 
	  exist in a default Postgresql install but may be present
	  in some installs (e.g. Windows if selected at install
	  time).

2007-01-15	smcgrawx@frxii.com

	* perl/load_googits.pl [1.1]
	* pg/data/kwfreq.sql [1.2]
	Add support fo google hit counts as kfreq/rfreq FoU metric.

	* perl/cgi/srchform.pl [1.2]
	* perl/cgi/srchres.pl [1.2]
	* perl/lib/tal/srchform.tal [1.2]
	Add support for entry status and google hit counts.

	* pg/mkindex.sql [1.4]
	Disable unique indexes on (entr,txt) for tables kanj and 
	  rdng and (sens.txt) for table gloss because (as of 
	  2007-01-14) duplicates exist in the jmdict xml file.

	* pg/mktables.sql [1.7]
	Fix syntax error typo.

	* pg/mkviews.sql [1.3]
	Add experimental functions dupentr and delentr.

	* pg/data/kwstat.sql [1.2]
	Shorten 'descr' text a little.

2007-01-13	smcgrawx@frxii.com

	* Tag T009
	This bring the Perl web interface code to approxmately where 
	  the Python code was when work switched to Perl.  At this point
	  some support code has been added for better history trackng
	  and and update process but it is incomplete.

	* perl/load_jmdict.pl [1.11]
	Fix: Forgot to write out new "diff" column when creating
	  load records for table hist as needed by maketables.sql[1.6].

	* perl/cgi/entr.css [1.3]
	Tweak fomatting of srchres page.

	* perl/cgi/entr.pl [1.3]
	Fix: reading of db login info from file jmdict.cfg. 

	* perl/lib/jmdict.pm [1.5]
	Add new subs:
	  - kwrecs to get a single set of record values without duplicates 
	  from a keyword data structure.
	  - jstr_classify to identify the types of japanese characters in a
	  string.

	* perl/lib/jmdicttal.pm [1.3]
	Steal the split_args() and fetch_arg() subs from Petal::Utils and
	  rewrite our modifiers to use them.
	Add new modifiers "gt", "lt", "len", and (untested) "perl".
	Change "freqs" modifier to not require first argument "FREQ".

	* perl/lib/tal/entr.tal [1.3]
	Put single quotes around keyword type strings, and remove FREQ type
	  from modifer "freqs", as required by revised modifiers in 
	  jmdicttal.pm [1.3].

	* perl/cgi/srchform.pl
	* perl/cgi/srchres.pl
	* perl/lib/tal/srchform.tal
	* perl/lib/tal/srchres.tal
	New files to provide search form an results pages.

2007-01-09	smcgrawx@frxii.com

	* pg/mkindex.sql [1.3]
	Add unique indexes on columns (entr,ord) in tables rdng,
	  kanj,sens,gloss.  These are needed because the function 
	  (under development) that duplicates entries need to match
	  up old and new rdng's, kanj,s and sens's to duplicate the
	  restriction table entries, and uses unique ord numbers to
	  do that.
	Add unique indexes on columns (entr,txt) in tables rdng,
	  kanj, and gloss.  This disallows duplicate txt values
	  in the same entry.
	Add partial index on entr.stat.
	Add index on audio.fname.

	* pg/mktables.sql [1.6]
	Add "diff" column to "hist" table.

	* pg/mkindex.sql [1.3]
	* pg/mkperms.sql [1.4]
	* pg/mktables.sql [1.6]
	Add new "editor" table.

2007-01-08	smcgrawx@frxii.com

	* perl/lib/jmdict.pl
	Fix: Correctly index keyword records by kw string in sub 
	  Kwds.  Previously they were only indexed by id due to
	  programer brain-deadness.

2007-01-06	smcgrawx@frxii.com

	* perl/load_jmdict.pl perl/cgi/entr.pl 
	Make shebang line use env program rather than hardwiring the
	  location of the perl interpreter.

	* perl/showentr.pl
	Make shebang line use env program rather than hardwiring the
	  location of the perl interpreter.
	Replace embedded utf-8 characters with escaped notation
	  (eg "\x{3010}").  This eliminates the need for the file
	  to be utf-8 encoded, which in turn prevents Microsoft
	  windows from making the first three bytes a binary bom
	  which confuses unix machines.

2007-01-05	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.9]
	* perl/lib/jmdict.pm [1.3]
	* pg/loadkw.sql [1.3]
	* pg/mkfk.sql [1.3]
	* pg/mkperms.sql [1.3]
	* pg/mktables.sql [1.5]
	* pg/data/kwstat.sql[1.1]
	Change the "stat" column in tables "entr" and "hist" from
	  a checked character to a keyword integer that is a foreign
	  key to new table "kwstat".

	* perl/showentr.pl [1.4]
	* perl/cgi/entr.css [1.2]
	* perl/lib/jmdicttal.pm [1.2]
	* perl/lib/tal/entr.tal [1.2]
	Show status (entr.stat) when displaying entries.

2007-01-05	smcgrawx@frxii.com

	* Tag T008

2007-01-04	smcgrawx@frxii.com

	* perl/lib/jmdict.pm
	Moved jmdict.pm from directory perl/ to perl/lib/ (in CVS 
	  repository).
	Change some hash key names in the structure returned by 
	  EntrList to be more consistent with table/column names.
	In KW structure, use same 1st level key (e.g. 'POS') to 
	  hold both 'kw' hash and 'id' hash.  Formerly the latter
	  used a key prefixed with "i" (e.g. 'iPOS'). 
	Move sub filt() from showentr.pl to here.
	Add sub's irestr(), istagr(), istagk() which will convert
	  the restriction lists from the database form to jmdict form. 

	* perl/load_jmdict.pl perl/lib/jmdictxml.pm
	Moved jmdictxml.pm from directory perl/ to perl/lib/ (in CVS 
	  repository).

	* perl/showentr.pl
	Moved jmdict.pm from directory perl/ to perl/lib/ (in CVS 
	  repository).
	Track the entry hash key name changes and KW key changes made
	  in perl/lib/jmdict.pl.
	Fix: displayed kanji freq data was actually erroneously using
	  reading frequency data.
	Fix: Stagr/stagk restrictions weren't displaying.
	Fix: History notes weren't displaying.
	Eliminate some warnings reported by "use warnings".
	Move sub filt() to jmdict.pm.
	Add code to show reverse cross refs.

	* perl/cgi/entr.pl perl/cgi/entr.css perl/lib/jmdicttal.pm  
	* perl/lib/tal/entr.tal
	Add demo/devtool cgi script entr.pl and supporting files
	  jmdicttal.pm, entr.tal, entr.css

	* pg/postload.sql pg/syncseq.sql
	Set the currval of all sequences after loading database.  
	  Otherwise inserts that use a defaulted id will fail.

2006-12-30	smcgrawx@frxii.com

	* perl/showentry.pl[1.2]
	Fix handling of multiple command line args.
	Fix display of dialect and language elements.

2006-12-26	smcgrawx@frxii.com

	* perl/jmdictxml.pm[1.2]
	Renamed JMdict.pm to jmdictxml.pm.  This was done in
	  CVS repository so is "retroactive".

	* perl/load_jmdict.pl[1.7]
	Use renamed jmdictxml.pm.
	Add help option and usage() sub.

	* perl/jmdict.pm[1.1]
	New.  Contains common database access subs.

	* perl/showentry.pl[1.1]
	New.  Console app to display all info for specified jmdict
	  entries.

2006-12-26	smcgrawx@frxii.com

	* perl/load_jmdict.pl[1.6]
	When hist records are created by load_jmdixt.pl, create them 
	  with stat='A' instead of null. 

	* pg/mktables.sql[1.4]
	In table hist, change name of (what was) column 'ostat' to 'stat'
	  and add NOT NULL constraint, don't allow 'stat' to be a space 
	  character. 

	* pg/mkviews.sql[1.2]
	Changed old convention of using 'k','j' aliases for tables
	  'rdng' and 'kanj' to new convention 'r','k'.
	Add view 'sref'.

	* pg/postload.sql[1.4]
	Set permissions as last step rather than earlier so that all
	  database object will have been created.

2006-12-25	smcgrawx@frxii.com

	* perl/load_jmdict.pl[1.5]
	Fix: gloss language attribute was not read correctly and all 
	  glosses were defaulted to "en".

2006-12-23	smcgrawx@frxii.com

	* perl/load_jmdict.pl[1.4]
	Fix: was not generating correct data for tables restr, stagr, 
	  stagk when some items has restrictions (including re_nokanj)
	  and others didn't.

	* pg/mktables.sql[1.3]
	Change column name in table aufio from "start" to "strt"
	  because former is a SQL-2003 reserved word.
	
	* pg/postload.sql[1.3]
	Do a "vacuum analyze" as last step.

	* perl/README.txt
	Reorganized load instructions again.


2006-12-23	smcgrawx@frxii.com

	* load_jmdict.pl[1.3]
	Fix: hist data not written to output dmp file.
	Fix: eliminate duplicate keys kfreq and rfreq tables that
	  resulted in error when loaded into database with result
	  that both tables ended up empty.
	Guess OS based on environment variable and assume encoding
	  for interactive output of utf-8 is Unix or shift_jis is
	  Windows.
	

2006-12-22	smcgrawx@frxii.com

	* pg/mkfk.sql pg/mkindex.sql pg/mkperms.sql pg/mktables 
	* load_jmdict.pl
	Change name of table "audit" to "hist".  Add new table "audio".

	* perl/README.txt
	Reorganized load instructions.

	* pg/postload.sql pg/xresolv.sql
	xresolv.sql will create xref table extries based on contents
	  of table xresolv loaded with jmdict data.  postload.sql
	  modified to call xresolv.sql as part of postload processing.

2006-12-18	smcgrawx@frxii.com

	* Tag T007
	At this point the perl jmdict loader sucessfully loads 
	  jmdict into a postgresql database, using the instructions
	  in perl/README.txt.  The mysql stuff is obsolete and the
	  python stuff is probably broken.

	* pg/mkfk.sql pg/mkindex.sql pg/mkperms.sql pg/mktables.sql
	  pg/mkviews.sql pg/postload.sql pg/reload.sql pg/schema.sql
	Replace schema.sql with a separate scripts for creating tables,
	  indexes, foreign keys, etc.  This is because new loader method
	  uses postgresql copy commands in file and does the indexing, 
	  etc afterwards.
	Database name changed from jb to jmdict.

	* perl/load_jmdict.pl perl/JMdict.pm perl/README.txt
	Database loader written in Perl.  Requires module XML::Twig.
	JMdict.pm module maps JMdict xml file text strings to database
	keyword id numbers.

2006-12-18	smcgrawx@frxii.com

	* Tag T006
	Around 2006/11/30 a decision seems to have been taken on 
	  on the jmdict mailing list to base the jmdict database system
	  on postgreslql and perl.
	  I rearranged the cvs directory structure to support this.  (Since
	  this was done on the CVS repository, it is "retroactive".)
	  This tag identified the code base (in the new directory structure)
	  as it existed prior to switch focus to perl.  Because of the
	  directory changes, many python scripts probably won't run as-is.
	  Also, some schema changes were made related to the audit table
	  that haven't been propagated to the python scripts yet.

2006-11-03	smcgrawx@frxii.com

	* Tag T005
	Cgi search form, result list, and entry pages seem to mostly
	  work ok.  

2006-11-03	smcgrawx@frxii.com

	* jbdb.py[1.7]
	Fixed build_search_sql() which returned bad sql under a 
	  number of circumstances.
	Enhance mk_from_clause() to do left rather than inner join
	  if table name prefixed with asterisk.  Need this because we 
	  need outer join when looking for "or" of frequency values. 
	
	* entr.css
	Add formatting for srchfrm.html

	* www/srchres.py
	Accept option string as commnd argument.
	Fix the frequency-of-use input stuff so that it is functional 
	  now.
	Allow display of search sql on results page for debugging.
	Fix problem where searching for two glosses would never find 
	  anything because the generated sql asked for rows where the
	  same gloss was simulataneously equal to g1 and g2.  Now, g1
	  and g2 need only occur in the same sense.  (We probably
	  want "in the same entry" instead, but that will need to 
	  wait.)  Same problem also occured (and ws fixed) for kanji 
	  and reading searches too.

	* www/templates/entr.tal
	Fix synonym, antonym links.

	* wwww/templates/srchfrm.tal
`	Change the use of class attributes to allow better formating
	  in css.
	Correct misnamed "misc" and "nfcmp" elements.
	Minor layout changes such as moving search button and adding
	  horizonal rules between sections.

	* www/templates/srchres.tal
	Add a debug section for displaying the search sql used.

2006-10-26	smcgrawx@frxii.com

	* jbdb.py
	mk_from_clause() was broken, failed to generate valid sql in 
	  some cases because it assumed the added table always should
	  be joined to the previously added table but that is often 
	  wrong; need to join to parent table which may have been 
	  added much earlier.
	Enhance mk_from_clause() to allow multiple instances of the 
	  same table with different aliases.  This fixes problem 
	  where giving (for example) two "gloss" conditions would
	  always results in 0 records found because the sql asked
	  for a record in which gloss.txt was simultaneously equal
	  to two different values.   

2006-10-26	smcgrawx@frxii.com

	* README.txt[1.4]
	Update for cgi stuff.

	* jbdb.py[1.6]
	DbRow object wasn't keeping attribute values in sync with
	  list values, does now.  Derive from object (instead of list
	  as before) and keep values as attributes, map indexed access
	  to attribute access.
	Remove function rslv_refs() since it is no longer used
	  by anything.  
	Add function build_search_sql() and its helper, 
	  mk_from_clause()  This is a slightly rewritten version
	  of what was in showentr.py.

	* showentr.py[1.7]
	Move function build_search_sql() to jbdb.py.

	* www/entr.py[1.1] www/srchfrm.py[1.1] www/srchres.py[1.1]
	* www./simpleTalHelper.py[1.1] www/entr.css[1.1]
	* www/templates/entr.tal[1.l] www/templates/srchfrm.tal[1.l]
	* www/templates/srchres.tal[1.l]
	New files added to demonstrate access via cgi.

2006-10-19	smcgrawx@frxii.com

	Tag T004:
	Tested on Windows 2000 with postgresql-8.1.4, Python-2.5,
	  psycopg2-2.0.5.1.
	Tested on Fedora Core 5 with mysql-5.0.22, Python-2.4.3,
	  MySQLdb-1.2.0,

2006-10-16	smcgrawx@frxii.com

	* jbdb.py[1.5]
	In class jbdb.DbRow, was previously maintaining duplicate 
	  values, one set in the list part of self, the other in 
	  attributes leading to inevitable cases where they got out 
	  of sync. Instead, override __getattr__, __setattr__ to get 
	  set the list values when accessed through attributes.

	* pg/db.py[1.2]
	Pass whatever arguments dbOpen() gets directly to the dbapi
	  connect call.  This moves responsibilty for maintaining 
	  default argument values to the caller and allows not passing
	  some arguments (like usename, which psycopg2 will then 
	  default to the current user's username) if desired.  

	* mysql/db.py[1.2]
	Same changes as for pg/db.py but need to translate some args
	  into mysql dialect, and add some additional parameters for 
	  the unicode issues.
	'conn.charset' was being set to "utf-8".  I think the hyphen 
	  is an error, changed to "utf8"
	Added missing .lastauto() method to Cursor.

2006-10-15	smcgrawx@frxii.com

	* tables.py[1.2]
	Changes to support recursive read in jbdb.DbRow class:
	Add a _pk attribute to all tables.
	Add restr, stagr, and stagk related classes to kana, sens,
	  and sens tables.  This will result in then being read
	  and written automatically, instead of handling them outside
	  of this framework as previously.
	Change the contents of the _related attribute from strings
	  naming that attribute that the "related" list will be
	  attached to on the object, to a list of classes that will
	  be used to instansiate list elements.  Attribute name will
	  be taken from the classes _table attribute.
	Rearrange order of classes to prevent undefined name errors
	  when executing the class definitions.
 	  
	* jbdb.py
	Add DbRow methods() ._read() and ._readrel() that will allow
	  initializing in an instance's data by a database read, and
	  recursively for all related row instances.  This is what drove
	  the changes to tables.py.
	Added functions rslv_refs() and load() (latter moved here from 
	  showentr.py).
	Added/updated comments.

	* pg/schema.sql[1.2]
	Rename view "kr_valid" to "rk_validity".
	Add column k.id to view "re_nokanji".
	Add view rk_valid which will correctly give the valid kanji
	  (including the "nokanji" case) for all readings of any entry,
	  efficiently.

	* load_jjmdict.py
	Updated for consistency with jbdb.py[1.5] and tables.py[1.2].
	Completely rework hanfdling of restr, stagr, and stagk elements.
	  They are now inverted at the time the elements are processed
	  instead of deffering procesing until the entr object is 
	  completely built. 
	Remove debugging print statement inadvertantly left in the 
	  previous version.
	Changed the commit interval from 3975 to 200 after reading 
	  that postgres will slow down when a large number of uncommited 
	  transactions have accumulated, and that one user found (in 
	  a completely dissimilar application) the sweet spot was in 
	  the low hundreds of transactions.  (For us each entr insert 
	  represents a half dozen or more transactions, so we may still 
	  be too high.)

	* showentr.py[1.6]
	Updated for consistency with jbdb.py[1.5] and tables.py[1.2].
	Use the new recursive Entr._read() method to initialize 
	  entry data rather than executing a bunch on sql statements.
	Move function load() into jbdb.py.

	* README.txt[1.3]
	Clarify alarming messages when running the reload.sql script.

2006-10-11	smcgrawx@frxii.com

	* load_jmdict.py[1.5]
	Propagate part-of-speech information to folowing senses in
	each entry.

	Remove the Def_enc global and the code that set if from locale.  
	It wasn't used, and if we need the encoding, we can get it from 
	sys.stdout.encoding.

2006-10-10	smcgrawx@frxii.com

	Tag R002: Posted to jmdict mailing list. 2006-10-10.

2006-10-10	smcgrawx@frxii.com

	Tag T004: Changes to suppport Postgresql in addition to Mysql.

	* Changes.txt pg/db.py mysql/db.py
	New files.

	* jbdb.py[1.4]
	Move Cursor class, function dbOpen() into pg/db.py and mysql/db.py.
	Instead of executing db-specific sql to get the last used auto-number
	  value, move that sql into new cursor method .lastauto() in each
	  of the db-specific db.py modules, and call it in jbdb.py.

	* load_jmdict.py[1.5]
	Get rid of mysql specific code.

	* loadkw.sql reload,sql schema.sql 
	Move into the database-specific directories pg/ and mysql/.

	* README.txt[1.2]
	Updated to include new info about postgresql, remove
	some old info no longer relevent.

	* mysql/schema.sql[1.1]
	Add view "entr_summary".

	* showentr.py[1.4]
	Get rid of mysql specific code.
	When printing glosses, explicitly convert to default encoding
	  so can use "replace" to avoid exception when an unconvertable
	  utf8 character encountered, as commonly happens with iso9959-x
	  characters when default encoding is something like sjis.
	Use query "entr_summary" to get matched entries list, rather
	  than doing the sql in the script.  **Note**: This results
	  in very long response times for the "find>" command when
	  using Mysql, because Mysql executes the view's sql without
	  any consideration of the outer WHERE clause!
	Drop the temp table before trying to create it.
	Conditionalize the sql executed to create the temp table for 
	  mysql or postgresql.

	* sitecustomize[1.2]
	It wasn't actually setting the default encoding. Fixed.

2006/10/09	smcgrawx@frxii.com

	Tags to date:
	T003	Last (I hope) Mysql-only files.
	T002	Files distributed on the jmdict mailing list, 2006/09/21.
	T001	Initial commit
