
2008-04-05 19:29	smcgrawx@frxii.com

	* pg/mkviews.sql [1.25]
	Add "p" (wwwjdic P marker) column to view esum. {400}

2008-04-05 15:45	smcgrawx@frxii.com

	* perl/lib/tal/edconf.tal [1.17]
	* perl/lib/tal/entr.tal [1.21]
	Fix: Correct bad closing tag(s). {399}

	* pg/mkviews.sql [1.24]
	Fix: Views prfreq and pkfreq formerly erroneously considered
	  rdng/kanj with a "nf" freq tags with values less than 25 to meet
	  the "P" criteria.  Now it ignores "nf" values and bases decision
	  solely on presense of "ichi1", "gai1", "spec1", or "news1". {397}
	Add new view "is_p" that will return each row in table "entr" with an
	  additional column, "p" that indicates if the entry meets the
	  wwwjdic criteria for a "P" marking. {395}
	In functions "childrentbl" snd "children", add an additional column,
	  'dfrm'. {398}
	Fix: Changed name of view "prdng" to "prfreq" to be consistent with
	  the name of it's "pkfreq" sibling. {396}

2008-02-26 12:09	smcgrawx@frxii.com

	Tag: T0020 {393}

	* pg/mktables.sql [1.31]
	In table lsrc, column txt is part of table's primary key and is thus
	  is forced to NOT NULL.  Add "NOT NULL" to column 'txt' to make this
	  explicit. {392}

2008-01-25 21:20	smcgrawx@frxii.com

	* perl/lib/tal/edconf.tal [1.16]
	Fix: Fix tal elements displaying restr and stag restrctions. {388}
	Pass form method (get or post) as parameter to template; we want
	  "get" for development/debugging, and "post" for production. {387}

	* perl/lib/tal/edform.tal [1.9]
	* perl/lib/tal/srchform.tal [1.15]
	Pass form method (get or post) as parameter to template; we want
	  "get" for development/debugging, and "post" for production. {387}

	* web/cgi/edconf.pl [1.16]
	* web/cgi/edform.pl [1.14]
	* web/cgi/srchform.pl [1.15]
	Pass form method (get or post) as parameter to template; we want
	  "get" for development/debugging, and "post" for production. {387}
	Change lib search path so that it will work under either *nix/Apache
	  or Windows/IIS. {386}

	* web/cgi/edhelp.pl [1.9]
	* web/cgi/entr.pl [1.17]
	Change lib search path so that it will work under either *nix/Apache
	  or Windows/IIS. {386}

	* web/cgi/edsubmit.pl [1.14]
	* web/cgi/srchres.pl [1.18]
	Minor comment revisions. {389}
	Change lib search path so that it will work under either *nix/Apache
	  or Windows/IIS. {386}

2008-01-25 11:00	smcgrawx@frxii.com

	* pg/data/kwcinf.csv [1.1]
	New: Added for Kanjidic2 support. {385}

2008-01-25 10:07	smcgrawx@frxii.com

	* perl/lib/kwstatic.pm [1.14]
	* pg/drpindex.sql [1.11]
	* pg/mkindex.sql [1.20]
	Rebuilt due to changes in prerequisite files. {383}

2008-01-25 08:36	smcgrawx@frxii.com

	* Makefile [1.34]
	Fix: In target 'activate', ignore errors when renaming DBACT (which
	  may not exist) to DBOLD. {372}
	Add -g option to kdparse command. {373}

	* perl/jmparse.pl [1.41]
	JMdict XML file format changed, dialect now specified using an
	  entity. {374}
	Adjust progress bar divisor since number of entries in jmdict file
	  has grown. {382}

	* perl/lib/jmdictxml.pm [1.19]
	JMdict XML file format changed, dialect now specified using an
	  entity. {374}
	JMdict XML file changed, trainling spaces removed from many entity
	  texts. {380}

	* pg/data/kwdial.csv [1.3]
	Adjust descr text to match current JMdict XML file. {375}

	* pg/data/kwlang.csv [1.3]
	JMdict XML file seems to be using 'ain' for Ainu these days. {378}

	* pg/data/kwpos.csv [1.4]
	Add new pos keywords v4r, v5z, change descr of vz. {379}
	Change the id's of auxilary-verb and auxilary-verb to maintain id
	  order. {381}

	* pg/data/kwrinf.csv [1.5]
	Fix: Remove blank line that breaks load process. {371}

	* pg/mktables.sql [1.30]
	Add tables and seq's needed for kanjidic2 support. {364}
	On table 'entr' remove the ON DELETE CASCADE clause from the
	  entr_dfrm_fkey constraint.  We don't want to accidently delete a
	  revised current entry as the result of thoughtlessly deleting a
	  superceeded entry. {367}
	In table chr, add column 'uni' because pg has no builtin utf8->uni
	  codepoint function. {370}
	Add a seq for 'test" entries (to avoid mucking up any of the other
	  seq's.)  This presumes the addition of a "test" src in kwsrc. {365}
	Fix: In table kresolv, fix typo in 'kresolv_entr_fkey' constraint.
	  {368}
	In table kresolv, reduce size of column 'value'. {369}
	In table 'hist', remove timezone from dt column.  All times should be
	  UTC and converted to/from that by the middleware. {366}

	* tools/mkkwmod.pl [1.7]
	Fix: Stop including a trailing \n in descr fields. {376}
	Handle quoted descr fields in the input csv files.  These occur in
	  kwcinf.csv. {377}

2008-01-22 15:31	smcgrawx@frxii.com

	* perl/lib/kwstatic.pm [1.12]
	* pg/drpindex.sql [1.9]
	* pg/mkindex.sql [1.18]
	Rebuilt due to changes in prerequisite files. {363}

2008-01-22 15:18	smcgrawx@frxii.com

	* Makefile [1.33]
	* perl/jmload.pl [1.7]
	* perl/lib/jmdict.pm [1.38]
	* pg/data/kwxref.csv [1.2]
	* pg/loadkw.sql [1.8]
	* pg/mkperms.sql [1.10]
	* pg/mktables.sql [1.29]
	* tools/mkkwmod.pl [1.6]
	Add support for kanjidic2 (incomplete). {360}

	* pg/data/kwrinf.csv [1.4]
	Add support for kanjidic2 (incomplete). {360}
	Fix capitalization of "C.f." {361}

	* pg/syncseq.sql [1.10]
	Add support for kanjidic2 (incomplete). {360}
	Get kwsrc id numbers by joining with kwsrc rather than hardwiring
	  them as before. {362}

2007-10-05 00:58	smcgrawx@frxii.com

	* Makefile [1.32]
	Fix: In target 'dist', create empty tar file to prevent a "directory
	  changed" message from tar. {359}

2007-09-22 11:14	smcgrawx@frxii.com

	Tag: T019 {357}

	* Makefile [1.31]
	Fix: Use temp file as intermidiary when renaming jmnedict.xml since
	  case-only difference in names fails on caase-insensitive Windows.
	  {356}

2007-09-14 18:27	smcgrawx@frxii.com

	* perl/jmparse.pl [1.40]
	Warn if non-monotonic seq number encountered. {354}

2007-09-11 23:40	smcgrawx@frxii.com

	* perl/lib/jmdictcgi.pm [1.13]
	Factored the code that vaidates the 'e' and 'q' url parameters, out
	  of edform.pl and entr.pl and into perl/lib/jmdictcgi.pm. {347}
	In dbopen(), add "ShoWErrorStatement" flag to the DBI connect call.
	  {348}

	* perl/lib/tal/edconf.tal [1.15]
	Generate the "caution, similar entry" links with a corpus qualifier.
	  {351}

	* perl/lib/tal/srchform.tal [1.14]
	Intialize the Status checkboxes with only Active and New checked.
	  {353}

	* web/cgi/edconf.pl [1.15]
	Speed up the db query that finds entries simliar to the submitter's
	  entry. {350}
	Add function chkentr() to do some sanity checking of the entry before
	  sending it on to the submit page. {352}

	* web/cgi/edform.pl [1.13]
	Factored the code that vaidates the 'e' and 'q' url parameters, out
	  of edform.pl and entr.pl and into perl/lib/jmdictcgi.pm. {347}
	Edform.pl now accepts 'q' url param with a corpus qualifier. {349}

	* web/cgi/entr.pl [1.16]
	Factored the code that vaidates the 'e' and 'q' url parameters, out
	  of edform.pl and entr.pl and into perl/lib/jmdictcgi.pm. {347}

2007-09-10 21:59	smcgrawx@frxii.com

	* perl/lib/jmdictcgi.pm [1.12]
	New function, find_iin_inc(), that identifies a directory in @INC
	  that contains a specified file. {342}
	In dbopen() use find_in_inc() to find the directory containing the pg
	  service file. {343}

	* web/cgi/edconf.pl [1.14]
	* web/cgi/edform.pl [1.12]
	* web/cgi/edhelp.pl [1.7]
	* web/cgi/entr.pl [1.15]
	* web/cgi/srchform.pl [1.14]
	* web/cgi/srchres.pl [1.17]
	Use jmdictcgi::find_in_inc to find the relative path to the lib/tal/
	  directory, rather than a harwired path that didn't work in some
	  environments. {346}
	The relative path to the lib dir varies depending on the web server
	  and the directory layout, so push all possibilties onto @INC.  This
	  lets script run without changes under both IIS and Apache, and from
	  dev directory or an installed directory. {345}
	Use perl pragma "lib" to modify @INC rather than doing it manually.
	  {344}

	* web/cgi/edsubmit.pl [1.13]
	The relative path to the lib dir varies depending on the web server
	  and the directory layout, so push all possibilties onto @INC.  This
	  lets script run without changes under both IIS and Apache, and from
	  dev directory or an installed directory. {345}
	Use perl pragma "lib" to modify @INC rather than doing it manually.
	  {344}

2007-09-10 09:20	smcgrawx@frxii.com

	* perl/lib/jmdictcgi.pm [1.10]
	Fix: Explicitly check for undefined argument to avoid warning
	  messages. {339}

	* perl/lib/tal/entr.tal [1.20]
	Fix: Typo caused bad reverse xref links. {338}

	* web/cgi/edconf.pl [1.13]
	Fix: Make values that go into database text fields have undef value
	  rather than "".  The former will produce a NULL in database
	  consistent with other apps.  Mixing NULL and ""s makes searching
	  difficult. {341}
	Fix: When processing a new entry, make sure $eid is undef rather than
	  "".  The latter causes database entr row inserts to fail because it
	  is used to set attribute dfrm but is not numeric. {340}

2007-09-09 11:45	smcgrawx@frxii.com

	This set of changes implements submission approval and rejection
	  (including entry deletion) with support for concurrent submissions
	  (taskid 1)    A schema change to table entr was required, and long
	  pending change to hist table (taskid 71) made at same time.
	  Significant changes were made to the edhelp form. {337}

	* doc/schema.dia [1.9]
	* doc/schema.odt [1.9]
	* perl/exparse.pl [1.10]
	* perl/jmparse.pl [1.39]
	* perl/lib/jmdict.pm [1.37]
	* perl/lib/jmdictfmt.pm [1.7]
	* perl/lib/jmdictpgi.pm [1.11]
	Adjust for the changes to tables entr and hist in pg/mktables.sql.
	  {306}

	* doc/schema.html [1.7]
	* doc/schema.pdf [1.5]
	* doc/schema.png [1.11]
	* perl/lib/kwstatic.pm [1.12]
	* pg/drpindex.sql [1.9]
	* pg/mkindex.sql [1.18]
	Rebuilt due to changes in prerequisite files. {308}

	* perl/lib/jmdictcgi.pm [1.10]
	* web/cgi/entr.pl [1.14]
	Fix: Make svc param safe before using it. {312}
	Create and use a "editable" flag on entries to simplify displaying of
	  Edit button in entr.tal. {317}

	* perl/lib/jmdicttal.pm [1.7]
	Add new function rev().  But doesn't work yet. {333}

	* perl/lib/tal/edconf.tal [1.14]
	Pass svc parameter along in href links. {321}
	Display history items in table rather than ordered list. {322}
	Move the Appove/Reject selector from edconf page back to edform page.
	  {323}
	Adjust for the changes to tables entr and hist in pg/mktables.sql.
	  {306}

	* perl/lib/tal/edform.tal [1.8]
	Move the Appove/Reject selector from edconf page back to edform page.
	  {323}
	Add a "delete entry" checkbox. {326}
	Open help links in different target page. {325}
	Added some missing help links. {324}
	Adjust for the changes to tables entr and hist in pg/mktables.sql.
	  {306}
	Pass "isdelete" parameter to TAL file to simplify setting the "delete
	  entry" checkbox default. {314}

	* perl/lib/tal/edhelp.tal [1.3]
	Added srcnote, entrnote help. {328}
	TAL template now uses a kw hash rather than list and explicity
	  formats exach kw section so it can add additional text content.
	  {315}
	Added examples in the Tag Syntax section. {329}
	Fix: Internal link anchor chnged to lowercase consistently.  Case
	  differences were breaking some links. {327}

	* perl/lib/tal/entr.tal [1.19]
	Pass svc parameter along in href links. {321}
	Create and use a "editable" flag on entries to simplify displaying of
	  Edit button in entr.tal. {317}
	Display history items in table rather than ordered list. {322}
	Adjust for the changes to tables entr and hist in pg/mktables.sql.
	  {306}

	* perl/lib/tal/srchform.tal [1.13]
	Fix: Make indenting more consistent with my standard style. {330}
	Put Kinf and Rinf in same section separated horizontally. {331}
	Add "Approval" criteria selection to form. {318}
	Adjust for the changes to tables entr and hist in pg/mktables.sql.
	  {306}

	* perl/lib/tal/srchres.tal [1.9]
	Add "stat" field to entry summaries. {332}

	* pg/data/kwfreq.csv [1.2]
	Add description data. {309}

	* pg/data/kwstat.csv [1.3]
	Removed "obsolete" keyword {334}
	"reject" keyword value changed from 8 to 6. {335}
	Remove the "approval pending" statuses.  Pending status now
	  maintained as a boolean column in entr table. {310}

	* pg/mktables.sql [1.28]
	Table entr: added new columns dfrm, unap. {304}
	Table hist: added new columns edid, split column notes into notes and
	  refs, split column who into name and email. {305}

	* pg/mkviews.sql [1.23]
	Add new functions children(), xhildrentbl(), find_edit_root(),
	  find_edit_leaves(), find_chain_head(), to support new editing
	  capabilities. {307}
	Adjust for the changes to tables entr and hist in pg/mktables.sql.
	  {306}

	* web/cgi/edconf.pl [1.12]
	Fix: Make svc param safe before using it. {312}
	Fix: Get rid of "used only once" warnings about $DB::OUT. {311}
	Use changes in tables entr and hist to implement new better
	  submission handling. {313}

	* web/cgi/edform.pl [1.11]
	Fix: Make svc param safe before using it. {312}
	Pass "isdelete" parameter to TAL file to simplify setting the "delete
	  entry" checkbox default. {314}

	* web/cgi/edhelp.pl [1.6]
	Fix: Make svc param safe before using it. {312}
	TAL template now uses a kw hash rather than list and explicity
	  formats exach kw section so it can add additional text content.
	  {315}

	* web/cgi/edsubmit.pl [1.12]
	Fix: Make svc param safe before using it. {312}
	Fix: Get rid of "used only once" warnings about $DB::OUT. {311}
	Rewritten to use new entr table columns to support concurrent edits,
	  approve, and reject. {316}

	* web/cgi/srchform.pl [1.13]
	Fix: Make svc param safe before using it. {312}

	* web/cgi/srchres.pl [1.16]
	Accept text search url params of the form "\udddd" which is what
	  copy/paste from VNC window into MSIE results in.  This is for
	  developer's convenience since he uses VNC alot. {320}
	Fix: Make svc param safe before using it. {312}
	Add new url param "srchres" to force display of srchres page even if
	  only one entry in resultset (which would normally result in display
	  of entr.pl page).  Purpose is so that we can see search query stats
	  which aren't shown on entr page. {319}
	Add "Approval" criteria selection to form. {318}

	* web/jmdict.css [1.7]
	Remove color from .status, add .pend. {336}

2007-08-29 20:42	smcgrawx@frxii.com

	Rearranged directory organization.  Moved perl/cgi/* to web/cgi/*,
	  and moved/renamed perl/cgi/entr.css to web/jmdict.css.  These
	  changes made in the cvs repo so are retroactive.    The purpose is
	  to allow the same relative directory structure in the development
	  directory that is used (by default) in the cgi install directory.
	  This permits the httpd server to serve the development directory
	  which in turn facilitates development without affecting the
	  stability of the installed cgi files.  This partnered with the
	  newly added ability to specify the database used via url
	  parameters, completely decouples development and production and
	  allows development to occur on the same machine that is running a
	  production server. {301}

	* Makefile [1.30]
	Adjust for path changes and .css file location and name change.  This
	  also affects the ~/public_html/ targets.  Because the relative
	  location of the .css file is now the same as in the ~/public_html
	  tree as in the source tree, we no longer need to change the tal
	  files when copying. {302}

	* perl/lib/tal/edconf.tal [1.13]
	* perl/lib/tal/edform.tal [1.7]
	* perl/lib/tal/edhelp.tal [1.2]
	* perl/lib/tal/entr.tal [1.18]
	* perl/lib/tal/srchform.tal [1.12]
	* perl/lib/tal/srchres.tal [1.8]
	Change stylesheet from entr.css to ../jmdict.css. {303}

2007-08-25 20:36	smcgrawx@frxii.com

	* perl/jmparse.pl [1.38]
	Fix: Was failing to log warning when sense had no glosses. {300}

2007-08-25 17:16	smcgrawx@frxii.com

	* perl/exparse.pl [1.18]
	Fix: Month of date generated for kwsrc record was wrong. {298}

	* perl/lib/jmdictxml.pm [1.9]
	* pg/data/kwmisc.csv [1.4]
	Add new misc tag 'poet'. {297}

	* pg/data/README.txt [1.2]
	Clarify and expand. {299}

2007-08-25 12:32	smcgrawx@frxii.com

	* Makefile [1.29]
	Don't exit if error occurs running drpindex.sql.  It's possible not
	  all constraints were successfully created earlier and trying to
	  drop them will cause error.  Just plough on and hope for the best.
	  {295}

	* README.txt [1.14]
	Added "authentification" section. revised install procedure. {296}

	* perl/exparse.pl [1.8]
	Change -s option to accept corpus id.kw as well as id. {293}

	* perl/jmparse.pl [1.37]
	Change -s option to accept corpus id.kw as well as id. {290}
	Look for a "... created: ..." comment and extract corpus kw and date
	  from it. {291}

	* perl/lib/Makefile [1.5]
	* pg/data/kwsrc.csv [1.None]
	* pg/loadkw.sql [1.7]
	* tools/mkkwmod.pl [1.5]
	Deleted pg/data/kwsrc, table kwsrc no longer has any static data.
	  {284}

	* perl/lib/jmdictpgi.pm [1.10]
	Make function pout() use function pgesc(). {289}
	Add function wrcorp(). {287}
	Move function pgesc() from jmparse.pl to jmdictpgi.pm. {288}

	* perl/lib/kwstatic.pm [1.11]
	Remake due to changes in prerequisite files. {286}

	* pg/mktables.sql [1.27]
	Table kwsrc: add column dt. {285}

	* tools/mkindex.pl [1.4]
	Add "IF EXISTS" phrase to generated DROP INDEX statements. {294}

2007-08-23 22:35	smcgrawx@frxii.com

	* web/cgi/edhelp.pl [1.5]
	Fix: Tried to call cgi method but line that instantiated cgi was
	  commented out. {283}

2007-08-23 20:40	smcgrawx@frxii.com

	* web/cgi/edform.pl [1.10]
	Fix: syntax error. {282}

2007-08-23 00:21	smcgrawx@frxii.com

	* README.txt [1.13]
	Update install instructions for using Postgresql service file. {281}

	* perl/lib/jmdictcgi.pm [1.9]
	Function dbopen() changed to read Postgresql "service" file rather
	  the jmdict.cfg for db connection credentials. {278}

	* perl/lib/pg_service.sample [1.1]
	New: Example postgresql service file. {279}

	* perl/lib/tal/edconf.tal [1.12]
	* perl/lib/tal/edform.tal [1.6]
	* perl/lib/tal/entr.tal [1.17]
	* perl/lib/tal/srchform.tal [1.11]
	* perl/lib/tal/srchres.tal [1.7]
	* web/cgi/edconf.pl [1.11]
	* web/cgi/edform.pl [1.9]
	* web/cgi/edhelp.pl [1.4]
	* web/cgi/edsubmit.pl [1.11]
	* web/cgi/entr.pl [1.13]
	* web/cgi/srchform.pl [1.12]
	* web/cgi/srchres.pl [1.15]
	Read and propagate db service "svc" url parameter. {280}

2007-08-22 19:13	smcgrawx@frxii.com

	* Makefile []
	Fix: xresolv.pl logfile name in target loadex. {277}

	* perl/lib/jmdict.pm [1.36]
	* perl/lib/jmdictcgi.pm [1.8]
	* web/cgi/edform.pl [1.8]
	* web/cgi/edhelp.pl [1.3]
	* web/cgi/srchres.pl [1.14]
	Move function dbopen() from jmdict.pm to jmdictcgi.pm {276}

	* web/cgi/srchform.pl [1.11]
	Fix: Fix "gkwrecs" typo that crept in during last edit. {275}
	Move function dbopen() from jmdict.pm to jmdictcgi.pm {276}

2007-08-22 14:52	smcgrawx@frxii.com

	* perl/jmparse.pl [1.36]
	When possible, if a bad data item such as a keyword is encountered,
	  print warning, skip it, and continue.  Previously, would call die()
	  which skipped the entire entry. {274}
	Remove code and data that use kw values >200 to signal deprecated
	  values. {273}

	* perl/lib/jmdictxml.pm [1.17]
	* perl/lib/kwstatic.pm [1.10]
	* pg/data/kwmisc.csv [1.3]
	* pg/data/kwpos.csv [1.3]
	* pg/data/kwrinf.csv [1.3]
	* web/cgi/edhelp.pl [1.2]
	* web/cgi/srchform.pl [1.10]
	Remove code and data that use kw values >200 to signal deprecated
	  values. {273}

2007-08-21 22:38	smcgrawx@frxii.com

	* Makefile [1.27]
	Fix: Add cgi/edhelp.pl and lib/tal/edhelp.tal to cgi files list.
	  {271}

	* perl/xresolv.pl [1.2]
	Add -D (debugging) option. {269}
	Fix: Typo in debugging print statement {268}
	Add check for self-referential xrefs. {270}
	Get rid of #@$!^*%*! Microsoft utf8 BOM. {272}

2007-08-21 17:22	smcgrawx@frxii.com

	This changeset implements three main changes.    (1) The addition of
	  ktxt and rtxt columns to the xref table.  This allows db users to
	  display different reading and kanji text for xref targets than the
	  api would normaly generate.  This is intended as a temporary
	  feature until the api generation of xref text can be made more
	  reliable.    (2) Resolution of textual (kanji/kana) xref targets
	  provided by input files (e.g. the JMdict xml file) to database xref
	  records that identify target entries by id number is now done by a
	  Perl script rather than with sql.  The former, though slower, can
	  provide more complex logic than the latter.    (3) First-cut help
	  page for use with the Edit form.  Documents the JEL parser syntax.
	  {232}

	* Makefile [1.26]
	Fix: Previous version did not use same parameters when running perl
	  commands as it used for psql commands when non-default values were
	  used. {253}
	Use xresolv.pl rather than xresolv.sql to resolve xrefs. {251}
	Improve parameterization. {252}

	* doc/schema.dia [1.8]
	* doc/schema.odt [1.8]
	Update for addition of columns rdng and kanj to table xref. {231}

	* doc/schema.html [1.6]
	* doc/schema.pdf [1.4]
	* doc/schema.png [1.10]
	* perl/lib/jbparser.pm [1.6]
	* pg/drpindex.sql [1.6]
	* pg/mkindex.sql [1.16]
	Remake due to change in prerequisite file(s). {230}

	* perl/lib/jbparser.yp [1.6]
	Fix: In function resolv_xrefs() was calling jmdict::resolv_xrefs()
	  with arguments 2 and 3 were swapped. {261}
	In function resolv_xrefs(), add parameter 'src' to allow caller to
	  restrict xref resolution to a specific corpus. {262}

	* perl/lib/jmdict.pm [1.35]
	Fix: Patch to function dbopen() provided by Jason Shepherd to enable
	  use of remote host. {263}
	Fix: EntrList(): was calling entr_data() with junk when the selection
	  query returned 0 records. {234}
	add_xrefsums(), grp_xrefs(), resolv_xref(): adjust for new xref
	  columns kanj and rdng. {236}
	Fix: fmt_jitem(): avoind an unitialized string warning if $slist
	  param is undef. {235}
	In class Tmptbl, method DESTROY(), wrap the sql execution in an eval
	  in order to ignore errors.  Sometimes during normal program
	  termination, the dbi handle goes away before the Tmptbl destructor
	  is called resulting in a warning messge (safe to ignore because
	  purpose of destructor is to delete the temp table, but it will be
	  deleted automatically when the db connection is closed). {248}

	* perl/lib/jmdicted.pm [1.1]
	Removed, no longer used anywhere. {229}

	* perl/lib/jmdictfmt.pm [1.6]
	* perl/lib/jmdictpgi.pm [1.9]
	* perl/lib/tal/entr.tal [1.16]
	Adjust for addition of reading/kanji to xrefs. {249}

	* perl/lib/tal/edconf.tal [1.11]
	Adjust for addition of reading/kanji to xrefs. {249}
	Moved "Approved" checkbox from edform.tal to edconf.tal. {250}

	* perl/lib/tal/edform.tal [1.5]
	Moved "Approved" checkbox from edform.tal to edconf.tal. {250}

	* perl/lib/tal/edhelp.tal [1.1]
	* web/cgi/edhelp.pl [1.1]
	* web/jmdict.css [1.6]
	Add edhelp.pl/tal page that provides entry editing help and refer to
	  it from entry edit form. {247}

	* perl/lib/tal/srchform.tal [1.10]
	Retitle "dictionary" section to "corpus". {266}

	* perl/showentr.pl [1.21]
	Fix: "Uninitialized string" warning when print retrieval stats. {264}

	* perl/xresolv.pl [1.1]
	New: Added, replaces pg/xresolv.sql {237}

	* pg/mktables.sql [1.26]
	Adjust for addition of reading/kanji to xrefs. {249}
	Add oids to table freq to that it will be editable in PgAdmin. {257}
	Remove table xrefld and its trigger function. {256}
	Disable the unique index on xref(entr,sens,typ,xentr,xsens) because
	  the Examples file generates such xrefs (as does jmdict when there a
	  sense has two xrefs to the same target.) {255}
	Fix: Correct erroneous comment characters. {254}

	* pg/mkviews.sql [1.22]
	Rewrite (and simplify) view rk_valid. {258}
	Add new views sr_valid, sk_valid, xrefhw. {259}

	* pg/xresolv.sql [1.13]
	Removed, replaced by perl/xresolv.pl {233}

	* web/cgi/edconf.pl [1.10]
	Reenable check for possible duplicate entries. {260}

	* web/cgi/srchres.pl [1.13]
	When searching by seq#. pay attention to selected corpus (aka src).
	  {265}

2007-08-19 08:25	smcgrawx@frxii.com

	* perl/jmparse.pl [1.35]
	Fix: "restriction target not found" message did not include seq
	  number. {242}
	Add check for duplicate glosses (same lang and txt). {243}
	Fix: When duplicate keywords found, skip duplicate.  Formerly
	  generated warnng message but created duplicate anyway. {244}

	* perl/lib/jmdictxml.pm [1.16]
	Add all the ISO-639 language codes that are in pg/data/kwlang.cvs.
	  Got tired of adding languages in bits and pieces when they showed
	  up in jmdict.xml and generated an error message. {245}

	* perl/lib/kwstatic.pm [1.9]
	Remake due to change in prerequisite file. {246}

2007-08-18 23:10	smcgrawx@frxii.com

	* Makefile [1.25]
	Fix: Target "dist". {238}
	Makefile now loads file data into database "jmnew" rather than
	  "jmdict".  Add new target "activate" to rename "jmnew" to "jmdict"
	  after it is known that the new database is viable. {239}

	* README.txt [1.12]
	* pg/reload.sql [1.5]
	Makefile now loads file data into database "jmnew" rather than
	  "jmdict".  Add new target "activate" to rename "jmnew" to "jmdict"
	  after it is known that the new database is viable. {239}

	* perl/jmload.pl [1.6]
	Change default database from "jmdict" to "jmnew". {240}

2007-08-09 20:59	smcgrawx@frxii.com

	Tag T018, snapshot release. {228}

2007-08-09 20:31	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.34]
	New functions entr_data() and entr_bld() replace former EntrList().
	  EntrList() now just a wrapper that calls the two new functions.
	  {218}
	Fix: Memory leak in dbread() due to calling DBI method
	  prepare_cached().  Changed to use prepare() and memory use now
	  flat. {217}
	Replace function mktemptbl() and the code in Find() that actualy
	  created temp table, with new class Tmptbl which has a destructor
	  that will delete the table when the object goes out of scope or is
	  otherwise no longer used. {220}
	In add_xrefsums() remove the $tmptbl argument and require $entrs to
	  be given.  Get the entr.id numbers that xref summary info are need
	  for by pulling them out of @$entrs.  Use an IN() clause in the sql
	  that retrieves the summary unfo, rather than a join with $tmptbl
	  temp table. {222}
	Adjust code that uses value returned from jmdict:Find() to use a
	  Tmptbl object rather than a string naming the table. {221}
	EntrList() (via entr_data()) now supports using a sql statement, or a
	  list of entr id's, in addition to a temptable created by Find(), to
	  select the entry object it returns. {219}

	* perl/lib/tal/edconf.tal [1.10]
	Fix: Link to xref entry was wrongly to current entry. {226}

	* perl/lib/tal/entr.tal [1.15]
	Fix: Link to reverse xref entry was wrongly to current entry. {227}

	* perl/showentr.pl [1.20]
	Rework command line processing to allow a ".corpus" suffix on 'q...'
	  arguments. {225}
	Delete jmdict::Find() call since EntrList() can now use selection SQL
	  directly. {224}
	Change call of jmdict::add_xrefsums() since it no longer accepts the
	  $tmptbl argument. {223}

	* web/cgi/edform.pl [1.7]
	* web/cgi/entr.pl [1.12]
	Change call of jmdict::add_xrefsums() since it no longer accepts the
	  $tmptbl argument. {223}

2007-08-07 15:25	smcgrawx@frxii.com

	* Makefile [1.24]
	Fix: jmdictcgi.pm wasn't in LIB_FILES list. {216}

	* perl/lib/jmdictcgi.pm [1.7]
	Fix: Modularize (put in package, export functions, etc.) {215}

2007-08-07 13:48	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.33]
	addentr() now returns new entry's src in addition to id and seq.
	  {210}

	* perl/lib/tal/srchres.tal [1.6]
	Add reset buttons. {203}

	* pg/mktables.sql [1.25]
	Add a functional index using lower() on gloss.txt to provide fast
	  case-insensitive "=" search. {204}
	Add varchar_pattern_ops indexes on kanj.txt, rdng.txt to provide fast
	  LIKE search. {207}
	Add varchar_pattern_ops indexes on gloss.txt to provide fast case-
	  insensitive LIKE search. {208}

	* web/cgi/edsubmit.pl [1.10]
	Generate url to added entry with a corpus spec. {214}

	* web/cgi/entr.pl [1.11]
	Permit specifying corpus by allow q=n.c url parameters. {211}
	Push the main body of processing down into a sub. {212}
	Fix: Detect and provide message on error page when there are no
	  entries. {213}

	* web/cgi/srchres.pl [1.12]
	Change the sql generation for text matching.  For gloss always use
	  lowercase which gives case-nsensitive searching since indexes built
	  same way.  For {209}

2007-08-05 13:22	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.32]
	* web/cgi/srchres.pl [1.11]
	Move function build_search_sql() from perl/cgi/srchres.pl to
	  perl/lib/jmdict.pm. {202}

2007-08-05 12:05	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.31]
	Remove exported variable Tables which was used by perl/cgi/srchres.pl
	  (extend_from_clause()) but is no longer needed. {201}

	* web/cgi/srchres.pl [1.10]
	Greatly simplify build_search_sql() and remove extend_from_clause().
	  This simplification made possible by the big pk/fk change made on
	  2007-02-11. {200}

2007-08-05 10:01	smcgrawx@frxii.com

	* perl/jmparse.pl [1.34]
	When missing restr item found, warn and skip it.  Don't die as
	  previously, which skips entire entry. {199}
	Check for and ignore (but log warning) duplicate reb and keb
	  elements. {198}

2007-08-05 07:27	smcgrawx@frxii.com

	* pg/drpindex.sql [1.6]
	* pg/mkindex.sql [1.16]
	Remake due to changes in prerequisite file mktables.sq. {197}

	* pg/mktables.sql [1.24]
	Move xref column trigger from table xref to table xrefld. {195}
	Add xref resolution staging table, "xrefld". {194}

	* pg/xresolv.sql [1.13]
	Use new table xrefld as linking table between xresolv and xref. {196}

2007-08-04 11:48	smcgrawx@frxii.com

	* perl/jmparse.pl [1.33]
	Parse new style KK.RR.s xrefs. {192}

	* pg/xresolv.sql [1.12]
	Modify to work with "new-style" KK.RR.s jmdict xrefs by adding a 5th
	  subquery to the _xrsv insert statement that finds target with
	  matching kanji and kana, and modifying the xrefs insert to restrict
	  the senses created when an explict sense is in xresolv.tsens. {193}

2007-08-03 19:40	smcgrawx@frxii.com

	* perl/jmparse.pl [1.32]
	Fix: "Unfound restr" message had nothing where the bad restr text was
	  supposed to be.  Problem due to trying to interpolate a method call
	  in a string.  Fixed several other occurances of the same problem.
	  {191}

2007-08-03 16:28	smcgrawx@frxii.com

	Changeset 23.    In addition to bug fixes, main change is API and cgi
	  change in the way xrefs are represented and displayed.  Formerly
	  all the xrefs targeting an entry with multiple senses were shown
	  with one line for the entry, and all xrefs to senses of that entry
	  listed in parens.  Showentr.pl still does this (but displays the
	  glosses for only the xref's senses, not all in entry as previously)
	  but cgi/entr.pl and friends now list every entry/sense xref target
	  on a separate line. {190}

	* perl/lib/jbparser.pm [1.4]
	* perl/lib/kwstatic.pm [1.8]
	Remake due to changes in prerequisite file. {173}

	* perl/lib/jbparser.yp [1.5]
	Fix: Remove the code that added psuedo-keyword 'restr' to $::KW.  If
	  caller sets $::KW themself change got overridden. {187}
	Change jbparser::resolv_xref() to create {_xref} elements rather than
	  {_erefs} elements since that is now what jmdict::resolv_xref() now
	  returns. {184}
	Fix: In lookup_tag(), hardwire detection and processing of restr tag
	  rather than relying on a psuedo-tag dynamically added to the $::KW
	  hash. {188}

	* perl/lib/jmdict.pm [1.30]
	Fix: setkeys(): was not setting correct xref field "xref" values.
	  {178}
	Add timing stats collector around all the matchup() calls in
	  EntrList(). {171}
	Correct comments in function EntrList(). {170}
	Replace function xrefdetails() with non-equivalent (but better :-)
	  function add_xrefsums(). {169}
	jmdict::resolv_xref() now returns list of augmented xrefs rather than
	  a _erefs object. {174}
	Replace functions bld_erefs(), erefs2xrefs(), xrefs2erefs() with with
	  non-equivalent (but bettter :-) function grp_xrefs(). {168}
	Fix: setkeys(): was not setting entr id's when $eid arg not supplied.
	  {177}

	* perl/lib/jmdictcgi.pm [1.6]
	Move functions fmt_restr(), fmt_stag(), set_audio_flag from
	  perl/cgi/entr.pl to perl/lib/jmdictcgi.pm since they are also
	  needed by cgi/edconf.pl. {185}

	* perl/lib/jmdictfmt.pm [1.5]
	Rework the xref display based on new jmdict::add_xrefsums() function.
	  {165}
	Fix: Entry notes not being displayed. {163}
	Display entry srcnote. {164}

	* perl/lib/jmdictxml.pm [1.15]
	* pg/data/kwpos.csv [1.2]
	New PoS tag, "v-nu". {175}

	* perl/lib/tal/edconf.tal [1.9]
	* perl/lib/tal/entr.tal [1.14]
	Display cross refs from _xref list rather than _erefs list. {179}

	* perl/showentr.pl [1.19]
	Use add_xrefsums() rather than now non-existent xrefdetails(). {180}
	Print timing information at botton of output. {181}

	* pg/mkviews.sql [1.21]
	Delete views eksum, xrefesum. {189}
	Change view hdwds to return entr.* rather than only entr.id. {167}
	Change view esum to get rdng and kanj strings from join on view
	  hdwds, rather than generating them independently. {162}
	Add new view essum. {166}

	* pg/xresolv.sql [1.11]
	Fix: Missing semi colon that causes syntax error when exceuted. {176}

	* web/cgi/edconf.pl [1.9]
	Fix: nokanji tag not being displayed.  Fix by calling fmt_restr() on
	  entry before display. {186}
	Fix: Remove extra dbopen() call thet produced a "connection closed"
	  warning from DBI. {182}

	* web/cgi/edform.pl [1.6]
	Use add_xrefsums() rather than now non-existent xrefdetails(). {180}

	* web/cgi/entr.pl [1.10]
	Move functions fmt_restr(), fmt_stag(), set_audio_flag from
	  perl/cgi/entr.pl to perl/lib/jmdictcgi.pm since they are also
	  needed by cgi/edconf.pl. {185}
	Use add_xrefsums() rather than now non-existent xrefdetails(). {180}

2007-07-29 18:20	smcgrawx@frxii.com

	* Makefile [1.23]
	Fix: Previous change to "sh gunzip ..." command doesn't work on Unix.
	  Change to "gzip -d" which hopefully will work everywhere.  Also
	  change all occurances of gunzip. {159}

	* perl/lib/jmdict.pm [1.29]
	In function bld_erefs() include new xref table field "xref" to that
	  it will mantain xref order. {161}

	* pg/xresolv.sql [1.10]
	Fix: The previous changes intended to generate xrefs in jmdict order
	  did not do so.  Think it is fixed now. {160}

2007-07-28 22:20	smcgrawx@frxii.com

	* Makefile [1.22]
	Fix: The gunzip command in section jmdict.xml started failing with
	  message that it could not find file.  Problem seems to be related
	  to space characterr in directory name.  Suspect it started after
	  gunzip or make was upgraded during a Cygwin upgrade.  Changed
	  command to "sh gunzip ..." which seems to fix problem. {158}

	* doc/schema.dia [1.7]
	* doc/schema.html [1.5]
	* doc/schema.odt [1.7]
	* doc/schema.pdf [1.3]
	* doc/schema.png [1.8]
	Updated for changes to xref table. {149}

	* perl/lib/jmdict.pm [1.28]
	* perl/lib/jmdictpgi.pm [1.8]
	Adjust for changes to table xref. {154}

	* perl/lib/jmdictcgi.pm [1.5]
	Remove functions cgientr(), resolv_xrefs(), and parse_xref().
	  cgientr() created an entr object from wwwjdic-like entry form and
	  has been replaced by the jbparser:: stuff.  The xref_resolv() is
	  replaced by a similar function with same name in jmdict::. {145}

	* perl/lib/jmdictfmt.pm [1.4]
	Print the xref target sense list in brackets rather than parens to
	  match the syntax used by the JEL parser. {157}
	Supress printing xref target sense numbers only if there is one xref
	  to target entry and target entry has only one sense.  Formerly they
	  were suppressed when the number of target senses matched the number
	  of xrefs, but I think we want to know when there is more than one.
	  {156}

	* pg/drpindex.sql [1.5]
	* pg/mkindex.sql [1.15]
	Remade due to changes in prerequisite mktables.sql. {153}

	* pg/mktables.sql [1.23]
	Add column "xref" to table xref, and change the PK from
	  (entr,sens,xentr,xsens,typ) to (entr,sens,xref).  What was formerly
	  the PK is now a unique index. {150}
	Create an insert trigger on table xref that will automatically assign
	  value to column "xref". {151}

	* pg/mkviews.sql [1.20]
	Adjust function adddup() and view xrefsum for change to xref table.
	  {152}

	* pg/xresolv.sql [1.9]
	Expand comments significantly. {155}
	Adjust for changes to table xref. {154}

2007-07-28 12:30	smcgrawx@frxii.com

	Tag: T017 - prior to adding ordered xrefs (taskid-82) {146}

	* pg/mktables.sql [1.22]
	Move creation of plpgsql language from mkviews.sql to mktables.sql
	  because it is needed for triggers in mktable.sql. {147}

	* pg/mkviews.sql [1.19]
	Wrap all actions in a transaction. {148}
	Move creation of plpgsql language from mkviews.sql to mktables.sql
	  because it is needed for triggers in mktable.sql. {147}

2007-07-25 23:59	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.27]
	Removed function get_seq() since addentr() no longer uses it per
	  chgid-133. {139}
	In function addentr() call setkeys() to set all the key values rather
	  than doing it ourself. {138}
	In function addentr(), don't assign a 'seq' value, leave it NULL and
	  rely on the new entr table insert trigger to set it. {133}

	* perl/lib/tal/edconf.tal [1.8]
	Allow editing of entr data seq, srcnote, notes. {135}
	Adjust layout of entr data to match current entr.tal {137}

	* perl/lib/tal/edform.tal [1.4]
	Make 'src' selection a drop-down box. {136}
	Allow editing of entr data seq, srcnote, notes. {135}

	* perl/lib/tal/entr.tal [1.13]
	Display entr.srcnote and entr.notes fields. {134}

	* perl/lib/tal/srchres.tal [1.5]
	Give the full src tag for all src's rather than a one letter
	  abbreviation for src's 1,2, and 3.. {143}

	* pg/data/kwsrc.csv [1.3]
	Add new column 'seq' to table 'kwsrc' for the name of the seq used to
	  supply default 'seq' values to new 'entr' table rows. {130}

	* pg/mktables.sql [1.21]
	Add new column 'seq' to table 'kwsrc' for the name of the seq used to
	  supply default 'seq' values to new 'entr' table rows. {130}
	Create insert trigger on table 'entr' to assign src-depndent default
	  seq values. {132}
	New sequences 'seq_jmdict', 'seq_jmnedict', and 'seq_examples' to
	  provide src-dependent default entr.seq values. {131}

	* pg/syncseq.sql [1.9]
	New sequences 'seq_jmdict', 'seq_jmnedict', and 'seq_examples' to
	  provide src-dependent default entr.seq values. {131}

	* web/cgi/edform.pl [1.5]
	Make 'src' selection a drop-down box. {136}

	* web/cgi/edsubmit.pl [1.9]
	Set 'seq' to undef rather then 0 to force db to assign from
	  appropriate sequence. {144}

	* web/cgi/entr.pl [1.9]
	Formerly checked that the received q=number was a 7-digit number
	  since that is true for all jmdict seq numbers.  But not true for
	  other corpuses so change to accept any number. {140}

2007-07-25 15:19	smcgrawx@frxii.com

	* perl/jmparse.pl []
	Fix: jmparse was not generating any restr records when a reading was
	  marked "no_kanji". {142}

2007-07-13 17:07	smcgrawx@frxii.com

	* perl/jmload.pl [1.5]
	New options -m and -x to support the change to fixed entr.id numbers.
	  {127}
	Process files containing fixed entr.id numbers (now produced by
	  jmparse.pl and exparse.pl, or ordinary pgdump files) rather than
	  requiring the symbolic entr.id values used previously. {126}

	* perl/lib/jmdictpgi.pm [1.7]
	Make wrentr() write fixed entr.id numbers rather the symbolic form
	  previously used. {125}
	In finalize(), add additional parameter that will cause copy commands
	  in output file to be wrapped in a transaction so that if anything
	  fails when loading the file, nothing will be changed in the
	  database. {129}

	* perl/lib/tal/entr.tal [1.12]
	Changed to allow display of entry even if there are no glosses in
	  some senses, or no senses.  Previously those conditions caused the
	  cgi/petal code to bomb. {128}

	* pg/data/kwsrc.csv [1.2]
	Add new column 'notes' to table kwsrc to allow recording some extra
	  arbitrary info (e.g. file date). {124}

	* pg/mktables.sql [1.20]
	Fix: Add column 'lang' to the unique index gloss(entr,sens,lang,txt)
	  since the different languages may have glosses with the same
	  spelling. {123}
	Add new column 'notes' to table kwsrc to allow recording some extra
	  arbitrary info (e.g. file date). {124}

2007-07-12 13:13	smcgrawx@frxii.com

	* perl/jmload.pl [1.4]
	Fix: Remove lingering obsolete references to hist.id in the comments
	  and builtin help text. {122}

	* web/cgi/jbparser.pl [1.4]
	Fix: Add missing semicolon left out in the previous DB::OUT warning
	  message fix. {121}

2007-06-17 21:44	smcgrawx@frxii.com

	* Makefile [1.21]
	Remove the subdirs dependencies added in previous revision -- they
	  unconditionally cause the target to be out-of-date and remade.
	  {116}
	Renamed the nw*.* cgi and tal files to ed*.* {117}

	* doc/schema.odt [1.6]
	Add footnote to description of table "gloss" pointing out that gloss
	  is a misnomer and the table holds several types of translational
	  enties. {111}

	* perl/jmparse.pl [1.30]
	Function extract_lit() was missing literals matching "^lit:" (and
	  similar for trans). {115}

	* perl/lib/jbparser.pm [1.4]
	* web/cgi/jbparser.pl [1.3]
	Fix: Get rid of "DB::OUT" used only once" warning message that
	  appears when running on *nix machines but nor MS Windows. {107}

	* perl/lib/jbparser.yp [1.4]
	When creating lsrc and gloss records, make sure all fields are
	  created even if they have default values (e.g. lang and ginf in
	  gloss, and lang, part, and wasei in lsrc.) {112}
	In function gcleanup() reduce multiple WS characters to a single one.
	  {113}
	Add new function qcleanup() like gcleanup but for quoted strings.
	  {114}

	* perl/lib/jmdict.pm [1.26]
	Minor clarification to comments in filt(). {110}

	* perl/lib/jmdictfmt.pm [1.3]
	Add jel_* functions for formattng entries in JEL (JMdict Edit
	  Language). {109}

	* perl/lib/kwstatic.pm [1.8]
	* pg/data/kwstat.csv [1.2]
	Swap kw values 'D' and 'X'.  X is now 5-"Deleted pending approval",
	  and D is now 4-"Deleted".  jmparse.pl creates deleted entries with
	  "stat" value of "D"  which was 5.  But they should be created as 4
	  "Deleted".  Rather that change jmparse.pl, changed kwstat.csv.
	  {108}

	* perl/lib/tal/edconf.tal [1.7]
	* perl/lib/tal/edform.tal [1.3]
	* web/cgi/edconf.pl [1.8]
	* web/cgi/edform.pl [1.4]
	* web/cgi/edsubmit.pl [1.8]
	Rewritten to support both new entries and edit of existing entries.
	  {118}
	Renamed the nw*.* cgi and tal files to ed*.* {117}

	* perl/lib/tal/entr.tal [1.11]
	Add "edit" button. {119}

	* perl/showentr.pl [1.18]
	Add -j option to format output in jel (jmdict edit language). {120}

2007-06-14 21:15	smcgrawx@frxii.com

	* perl/lib/jbparser.pm [1.3]
	* perl/lib/jbparser.yp [1.3]
	Fix: Was not correctly parsing tags that included a language. {106}

	* perl/lib/jmdictfmt.pm [1.2]
	In function f_lsrc(), supress quotes arount the text string if empty
	  or consists only of alphanumeric characters. {105}

2007-06-14 18:51	smcgrawx@frxii.com

	* Makefile [1.20]
	Fix: Update "web" target: need additional files in lib dir for
	  jbparser to work: jbparser.yp, kwstatic.pm {102}

	* perl/lib/jbparser.pm [1.2]
	Rebuild due to change in prerequisite file perl/lib/jbparser.yp {104}

	* perl/lib/jbparser.yp [1.2]
	Unescape backslashes in gloss text in function gcleanup(), which was
	  renamed from trim(). {103}

	* web/cgi/jbparser.pl [1.2]
	Fix: Remove Microsoft BOM which Apache web server doesn't like. {100}
	Fix: Make permissions 755, also for Apache. {101}

2007-06-14 14:09	smcgrawx@frxii.com

	* Makefile [1.19]
	* perl/lib/Makefile [1.4]
	* perl/lib/jbparser.pm [1.1]
	* perl/lib/jbparser.yp [1.1]
	* web/cgi/jbparser.pl [1.1]
	Input language parser (preliminary) {95}

	* doc/schema.dia [1.6]
	* doc/schema.png [1.8]
	Fix: FK annotation on table "lsrc". {94}

	* perl/lib/jmdict.pm [1.25]
	Add new function resolv_xref().  This is a sightly modified version
	  of the same-named function in perl/lib/jmdictcgi.pm. {97}
	Add new function fmt_jitem(). {98}

	* perl/lib/jmdictfmt.pm [1.1]
	* perl/showentr.pl [1.17]
	Move entry formatting code out of perl/showentr.pl and into
	  perl/lib/jmdictfmt.pm. {92}

	* perl/lib/kwstatic.pm [1.7]
	Rebuild due to change in prerequisite file pg/data/ginf.csv. {96}

	* pg/data/kwginf.csv [1.3]
	Add "expl" (explanatory) tag.  (Was formerly an lsrc tag.) {99}

	* pg/xresolv.sql [1.8]
	When loading xref table from _xrsv table, exclude self-referential
	  ones. {93}

2007-06-09 11:15	smcgrawx@frxii.com

	* Makefile [1.18]
	Do recursive makes on subdirectories pg/ and perl/lib/. {89}

	* perl/lib/Makefile [1.3]
	* tools/mkkwmod.pl [1.4]
	Changes needed for removal of table "kwlsrc" but missed in the
	  previous commit set. {90}

	* perl/lib/kwstatic.pm [1.6]
	Rebuild due to changes in prerequisite files. {80}

	* perl/showentr.pl [1.16]
	Fix: Syntax error and several typos introduced in the lsrc changes
	  made in last revision. {88}

2007-06-08 20:00	smcgrawx@frxii.com

	* Makefile [1.17]
	Add option (-y) to extract "literal" and "lsource" information from
	  glosses. {82}

	* doc/MANIFEST.txt [1.2]
	* doc/schema.dia [1.5]
	Updated doc for changes to lsrc table, etc, in chgid-77. {83}

	* doc/Makefile [1.4]
	Fix: Add MANIFEST.txt to target "Changes". {87}

	* doc/schema.html [1.4]
	* doc/schema.pdf [1.2]
	* doc/schema.png [1.7]
	* pg/drpindex.sql [1.4]
	* pg/mkindex.sql [1.13]
	Rebuild due to changes in prerequisite files. {80}

	* doc/schema.odt [1.5]
	Updated doc for changes to lsrc table, etc, in chgid-77. {83}
	Add footer with author, last update date, page number. {84}

	* perl/exparse.pl [1.7]
	Previous version looked for unicode overline character (0x203e) to
	  identify the B line item for exemplar sentences because this was
	  the character that was used in a few versions of the Examples file
	  after this feature was introduced.  However, the Examples file was
	  corrected after approx 2007/06/06 to use the advertised "~" (0x7e)
	  character and exparse.pl was changed accordingly. {76}

	* perl/jmparse.pl [1.29]
	Adjust code for schema change to table lsrc made in chgid-77. {79}
	Add option (-y) to extract "literal" and "lsource" information from
	  glosses. {82}

	* perl/lib/jmdict.pm [1.24]
	* perl/lib/jmdictpgi.pm [1.6]
	* perl/showentr.pl [1.15]
	* pg/mkviews.sql [1.18]
	Adjust code for schema change to table lsrc made in chgid-77. {79}

	* perl/lib/tal/edconf.tal [1.6]
	* perl/lib/tal/entr.tal [1.10]
	Put gloss tags after sense number, rather that in front of. {85}
	Rearrange lsourcew display and include the "waasei" and "part"
	  attributes as a letter in parens after the language code. {86}

	* pg/data/kwginf.csv [1.2]
	Remove "trans" entry.  JB currently proposing to treat "trans" info
	  as lsource (table lsrc) entry, usually with "wasei" attribute. {81}

	* pg/data/kwlsrc.csv []
	* pg/loadkw.sql [1.6]
	* pg/mkperms.sql [1.9]
	Remove table kwlsrc and in table lsrc, replace column "kw" with
	  columns "part" and "wasei". {77}

	* pg/mktables.sql [1.19]
	Activate unique indexes on the (entr,txt) columns of tables rdng,
	  kanj, and gloss.  These were formerly disabled because of
	  duplicates in the input files, but those problems have been
	  corrected. {78}
	Remove table kwlsrc and in table lsrc, replace column "kw" with
	  columns "part" and "wasei". {77}

2007-06-05 09:16	smcgrawx@frxii.com

	* Makefile [1.16]
	In target examples.pgi, change name of log file from exparse.log to
	  examples.log. {75}

	* README.txt [1.11]
	* doc/MANIFEST.txt [1.1]
	* doc/Makefile [1.3]
	New: Moved the file manifest list out of README.txt and into an
	  independent file so that Makefile can (re-)generate it from the
	  ChgLog Access database. {66}

	* doc/schema.pdf [1.1]
	New: Added to CVS after discovering that the copies in other working
	  directories were out-of-date and it was not included in the T016
	  snapshot {67}

	* perl/exparse.pl [1.6]
	* perl/lib/jmdictpgi.pm [1.5]
	* pg/mktables.sql [1.18]
	Support for exemplar sentences in Examples file. {71}

	* perl/jmparse.pl [1.28]
	Fix: Check for colon after dialect keyword.  Formerly blindy
	  discarded last character, assuming it was a colon. {72}

	* perl/lib/jmdictcgi.pm [1.4]
	Move subs cgientr() and resolv_xrefs() from perl/cgi/nwconf.pl to
	  perl/lib/jmdictcgi.pm {68}
	Fix: When creating a gloss record in cgientr(), explicitly set a ginf
	  value to prevent a "uninitializesd" warning and empty pair of
	  brackets from being displayed in the page generated from
	  nwconf.tal. {69}

	* perl/lib/jmdictxml.pm [1.14]
	Add dialect 'kyu'. {73}
	Add language ty (Tahitian) {70}

	* perl/lib/kwstatic.pm [1.5]
	Rebuild due to prerequisite file changes. {74}

	* pg/data/kwdial.csv [1.2]
	Add dialect 'kyu'. {73}

	* web/cgi/edconf.pl [1.7]
	Move subs cgientr() and resolv_xrefs() from perl/cgi/nwconf.pl to
	  perl/lib/jmdictcgi.pm {68}

2007-05-22 14:48	smcgrawx@frxii.com

	Tag: T016 {65}

2007-05-22 09:19	smcgrawx@frxii.com

	* Makefile [1.15]
	Fix: Examples file at Monash ftp site has extension ".utf", not
	  ".utf8". {59}
	Fix: Error in mv command of target "examples.txt". {62}

	* perl/exparse.pl [1.5]
	Fix: Was failing to set ginf column value in gloss table output. {64}

	* perl/jmparse.pl [1.27]
	Fix: Some error messages included the seq number twice. {63}

	* perl/lib/jmdictxml.pm [1.13]
	Add lang "th" (Thai) which appears in the 2007-05-22 jmdict.xml file.
	  {60}

	* perl/lib/kwstatic.pm [1.4]
	Update due to changes in prerequite files. {61}

2007-05-21 22:54	smcgrawx@frxii.com

	* doc/Makefile [1.2]
	Move all the change log tools into doc/chglog/. {58}

2007-05-21 18:00	smcgrawx@frxii.com

	* Makefile [1.14]
	Fix: Fix copy/paste errors in the messages produced by target "all".
	  {52}
	In target "dist" remove most of the exclude options since practice
	  now is to make a distribution archive from a freshly checked out
	  working directory.  In target "clean", add the file patterns that
	  used to be excluded by target "dist", in case one wants to do
	  things the old way. {53}

	* README.txt [1.10]
	Update the documentation for the schema changes related to jmdict dtd
	  1.06 and gloss tags. {44}
	Rewrite the install section based on using Makefile (which I have
	  verified is useable on both Unix and Windows). {49}

	* doc/Makefile [1.1]
	* doc/README.txt [1.1]
	New: Added new files. {57}

	* doc/schema.dia [1.4]
	* doc/schema.odt [1.4]
	Update the documentation for the schema changes related to jmdict dtd
	  1.06 and gloss tags. {44}

	* doc/schema.html [1.3]
	* doc/schema.png [1.6]
	* perl/lib/kwstatic.pm [1.3]
	* pg/drpindex.sql [1.3]
	* pg/mkindex.sql [1.12]
	Regenerated to track changes in prerequisite files. {36}

	* perl/jmparse.pl [1.26]
	Update for the JMdict dtd changes to <lang>, <dial>. {40}
	Add new command line option, -g, to restrict glosses processed for
	  loading into database to those of the given language.  (This
	  allows, for example, extracting only english glosses from the full,
	  multi-language JMdict file.) {39}
	Add support for gloss tags. {41}

	* perl/lib/Makefile [1.2]
	Add new files kwginf.csv and kwlsrc.csv to dependencies. {28}
	Move mkkwmod.pl to ./tools/ directory from ./perl/. {46}

	* perl/lib/jmdict.pm [1.22]
	* perl/lib/jmdictpgi.pm [1.3]
	* perl/lib/tal/edconf.tal [1.4]
	* perl/lib/tal/entr.tal [1.8]
	Update for the JMdict dtd changes to <lang>, <dial>. {40}
	Added gloss tag support. {43}

	* perl/lib/jmdictxml.pm [1.12]
	Update language tags to those currently in use in the 2007-05-01
	  JMdict xml file.  Id's are from pg/kwlang.csv which includes all
	  the ISO-639-1 two-letter codes, plus "ai" (Ainu). {27}

	* perl/showentr.pl [1.14]
	Dialect, lsource (was lang) display updated. {42}
	Added gloss tag support. {43}

	* pg/Makefile [1.3]
	Move mkindex.pl to ./tools/ directory from ./pg/. {45}

	* pg/data/kwginf.csv [1.1]
	New table for gloss tags. {31}

	* pg/data/kwlang.csv [1.2]
	Generate from the ISO-639-3 list (iso-639-3_20070323.tab) at
	  http://www.sil.org/iso639-3/download.asp, using script
	  perl/tools/mklangcsv.pl (which is not in CVS yet). {30}

	* pg/data/kwlsrc.csv [1.1]
	New table for lsource types. {32}

	* pg/data/kwmisc.csv [1.2]
	Changes to "misc" keywords in jmdict dtd 1.06.    Add keyword "eK"
	  (uppercase "K"), deprecate "ek" (lowercase "k")  and "gikun". {54}

	* pg/data/kwrinf.csv [1.2]
	Rinf "ateji" keyword deprecated in jmdict dtd 1.06. {55}

	* pg/loadkw.sql [1.5]
	Add the new tables kwginf, kwlsrc. {33}

	* pg/mkperms.sql [1.8]
	Add the new tables kwginf, kwlsrc, lsrc to load list, remove table
	  lang. {34}

	* pg/mktables.sql [1.17]
	Changes to track jmdict changes:  + Gloss tags: add column ginf to
	  table gloss and new table  kwginf.  + <dial> now a child of
	  <sense>: make table dial child table of sense.  + <lang> replaced
	  by <lsource>.  Replace table "lang" with table "lsrc" and make
	  child table of "sens".  New table "kwlsrc". {26}
	Add >0 constraints to rdng.rdng, kanj.kanj, sens.sens, gloss.gloss,
	  hist.hist.  This makes it a little easier to enforce consecutive
	  numbering on these columns. {25}

	* pg/mkviews.sql [1.17]
	Adjust functions dupentr and delentr for the dial, lsrc, and gloss
	  table changes. {35}

	* tools/mkindex.pl [1.3]
	Fix: Was creating bad "DROP INDEX" commands in drpindex.sql. {17}
	Move mkindex.pl to ./tools/ directory from ./pg/. {45}

	* tools/mkkwmod.pl [1.3]
	Add new files kwginf.csv and kwlsrc.csv to list used to generate
	  kwstatic.pm. {29}

2007-04-30 14:54	smcgrawx@frxii.com

	Tag: T015  Tagged prior to making changes for version 1.06 of the
	  JMdict XML DTD. {24}

	* perl/jmparse.pl [1.25]
	Fix: Sense notes were not being added to database. {3}

2007-04-26 20:00	smcgrawx@frxii.com

	* Makefile [1.13]
	Fix: Loadall target did not run xresolv.sql. {4}

	* pg/xresolv.sql [1.7]
	Fix: Bad table names. {5}

2007-04-26 11:00	smcgrawx@frxii.com

	* Makefile [1.12]
	Fix: Loadall target was loading jmnedict twice, examples not at all.
	  {6}

2007-04-26 09:00	smcgrawx@frxii.com

	* Makefile [1.11]
	exparse now writes raw xrefs to table xresolv like jmparse rather
	  than resolving at parse time.  This means examples.pgi need not be
	  regenerated when jmdict is. {22}

	* perl/exparse.pl [1.4]
	Since database access no longer needed for xref resolution, all  the
	  database stuff was ripped out. {8}
	Formerly, exparse would try to resolve the B line items against
	  jmdict entries while running.  Changed so that it now, like
	  jmparse.pl, doesn't resolve but writes the unresolved text
	  strings to table xresolv from where they will be resolved   later.
	  Since the Examples file identifies xref targets by   possibly a
	  reading, kanji, and sense number, the xresolv table  was expanded
	  with columns "rtxt", "ktxt", and "xsens" replacing  the single
	  "txt" column.  Also added a "ord" column since the   the B line
	  items may be repeated and order matched order of  appearance in the
	  A line text. {7}

	* perl/jmparse.pl [1.24]
	When creating xresolv table records, put text in field "rtxt" or
	  "ktxt" as appropriate. {10}
	Adjust the interval at with the progress bar dots are printed in
	  compensate for ever growing jmdict.xml file. {9}

	* perl/lib/jmdict.pm [1.22]
	Change jstr_classify() to consider any c.p. greater than 0x4E00 to
	  be a kanji character.  Previously is was >0x4E00 and <=0x9FFF but
	  that resulted in entries with kanji strings like "CTIF" (where "C"
	  is 0xFFxx) to be considered non-kanji even though it is stored in
	  a kanj table row. {11}

	* perl/lib/jmdictpgi.pm [1.3]
	In wrentr() and initialize(), adjust for table xresolv now having
	  columns "rtxt" and "ktxt", rather than just single column "txt".
	  {13}
	Fix: Remove erroneous backslash in wrentr() that was causing hist.who
	  fields to be generated as the string "SCALAR(..." {12}

	* pg/Makefile [1.2]
	Fix: Wrong name for mkindex.pl command. {14}

	* pg/drpindex.sql [1.2]
	* pg/mkindex.sql [1.11]
	Regenerated due to changes in mktables.sql. {19}

	* pg/mktables.sql [1.16]
	Replaced column txt in table xresolv with columns "ord", "rtxt",
	  "ktxt", "xsens".  See perl/exparse.pl change note for more info.
	  {15}

	* pg/mkviews.sql [1.16]
	New view hdwds. {16}

	* pg/postload.sql [1.7]
	Don't call xresolv.sql anymore.  That is now called directly from
	  makefile. {20}

	* pg/xresolv.sql [1.6]
	Completely rewritten.  Now resolves all but 33 jmdict xrefs
	  (2007-04-15 JMdict). {21}

2007-04-15	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.21]
	Fix: setids(): Glosses numbers were being incremented though an 
	  entire entry and not starting at 1 in each sense.
	Fix: Xrefs not being shown in web pages or showentr.pl because
	  the xref entry summary list ($erefs) not being populated correctly
	  xrefdetails().

	* perl/lib/jmdictpgi.pm [1.2]
	Fix: exparse.pl was not generating any xref table entries in its 
	  output file because jmdictpgi.pm::wrentr() was not processing the
	  entry's _xref or _xrer lists.

	* perl/exparse.pl [1.3]
	Added some comments.

	* Makefile [1.10]
	Fix: Add missing examples.dmp dependecy in loadex target.

2007-04-14	smcgrawx@frxii.com

	* pg/data/kwdial.csv [1.1]
	* pg/data/kwfld.csv [1.1]
	* pg/data/kwfreq.csv [1.1]
	* pg/data/kwkinf.csv [1.1]
	* pg/data/kwlang.csv [1.1]
	* pg/data/kwmisc.csv [1.1]
	* pg/data/kwpos.csv [1.1]
	* pg/data/kwrinf.csv [1.1]
	* pg/data/kwsrc.csv [1.1]
	* pg/data/kwstat.csv [1.1]
	* pg/data/kwxref.csv [1.1]
	New file.  Replaces former .sql file of same name.

	* pg/data/kwdial.sql [1.5]
	* pg/data/kwfld.sql [1.4]
	* pg/data/kwfreq.sql [1.7]
	* pg/data/kwkinf.sql [1.4]
	* pg/data/kwlang.sql [1.4]
	* pg/data/kwmisc.sql [1.5]
	* pg/data/kwpos.sql [1.6]
	* pg/data/kwrinf.sql [1.5]
	* pg/data/kwsrc.sql [1.5]
	* pg/data/kwstat.sql [1.4]
	* pg/data/kwxref.sql [1.3]
	File deleted and replaced by corresponding .csv file.

	* pg/loadkw.sql [1.4]
	Change to load .csv files instead of .sql files.

	* perl/mkkwmod.pl [1.2]
	Now creates a kwstatic.pm file from the .csv files in 
	  pg/data/ rather than from the database kw* tables.  
	  No longer requires any database access.

	* perl/lib/Makefile [1.1]
	New file: Updates kwstatic.pm when pg/data/kw*.csv file changes.

	* perl/lib/kwstatic.pm [1.2]
	Fix: Previous version erroneously contained src keywords I 
	  use in my personal implementation.
	Updated to incorporate new pos "ctr" (counter) keyword added 
	  to kwpos.csv.

	* pg/data/kwpos.csv
	* perl/lib/jmdictxml.pm
	Add 'ctr' (counter) keyword that was added to jmdict dtd 
	  around 2007-04-11,  See edict mailing list, 4/11/07 from
	  Jim Breen.

2007-04-14	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.20]
	Fix: debugging code added to dbread() in previous rev was misplaced.
	Fix: in addentr() the numbers going into rdng.rdng and kanj.kanj
	  were being incremented by 2 each record rather than 1.
	I previously tried to allow caller of EntrList() to supply the 
	  entr.id's it needs in either a temp table, or as a sql WHERE
	  clause with args.  The latter never worked right so that 
	  capability was removed.  
	That change allowed the rest of the sql statements in EntrList()
	  to be simplified.
	Moved the code that reads the entry summaries for all the entry's
	  xref out of EntrList() and into its own sub (xrefdetails()) that
	  can be called (or not) independently.
	In xrefdetails() reads example xrefs seperately so that the number
	  returned can be limited.
	In xrefdetails() use a long sql statement to read the xref entry
	  summary data because when it is a view, and joined with the temp
	  table, it is extraordinarily skow (5+ minutes!)  Since the same
	  view works fine (<100mS) when restricted by a WHERE clause, it
	  seems like the PG query planner is messing up or beyond its
	  capabilities.  Either way, the issue needs to be taken up with 
	  the postgresql people and the current arrangement is a workaround.
	Added function setkeys() that will set the primary and foreign key
	  numberic fields in the records in an entry object based on the 
	  the structural relations in the object.  This can be called 
	  prior to writing an object to the database.

	* perl/lib/jmdictpgi.pm [1.1]
	New file.  Three functions to aid in writing .pgi files.

	* perl/lib/kwstatic.pm [1.1]
	New file.  Static (no database access needed) definitions of kw*
	  table data.  Machine generated (currently not automatically) by
	  perl/mkkwmod.pl but included in cvs to simplify install procedure.

	* perl/mkkwmod.pl [1.1]
	New file.  Reads kw* table data from database and creates file
	  kwstatic.

	* perl/exparse.pl [1.2]
	Renamed from exload.pl.  Instead of writing examples entries and 
	  cross-refs directly to the database, exparse will generate a 
	  intermediate .pgi file that uses Postgresql COPY commands and
	  can be loaded into the database bt jmload.pl much faster.
	  The previous version took 12+ hours to load the 8MB Examples
	  file on a 800MHz desktop PC.  It now loads in 12+2+30m (with
	  indexes and foreign keys still in place).

	* perl/jmparse.pl [1.23]
	Previous version parsed xml file and directly generated the COPY
	  statements used to load data into database.  New version parses
	  xml file and creates a standard jmdict entry object.  Then, 
	  the COPY statements are generated from the object.  This 
	  separation of parsing and output generation will allow generating
	  load files from sources other than jmdict xml files, and the
	  parsing jmdict files to produce other output forms than
	  load files, for example, writing to the database directly.
	  It also allows a a single entry to be skipped if problems 
	  occur during parsing without aborting the entire parse.
	Use the pgi functions in perl/lib/jmdictpgi.pm.
	Account for change in "entr" table schema (see pg/mktqable.pl).
	Don't die if an error occurs when parsing.  Instead write message
	  to stderr and log file, skip that entry, and continue with the
	  next one.

	* perl/jmload.pl [1.3]
	Change jmloasd.pl's default output filename extention from .pgx
	  to .pgi which is more memonic of an intermediate file.
	Fix: Correctly adjust $eid so that when "-i 1" is given, resulting
	  .dmp file entr id numbers will start at 1, not 2.

	* perl/showentr.pl [1.13]
	Call xrefdetails() to get cross-ref info since it is no longer
	  automatically included in the entries returned by EntrList().
	Add display of glosses to cross-references.

	* pg/mkviews.sql [1.15]
	Rewrite view xrefesum to give better performance.  Previously
	  this view was horribly slow when tested on a database that
	  had the Examples files loaded.  With 2M+ xref rows, it was
	  taking more that 5 minutes to run.
	Change view xrefsum back to use esum rather than eksum because
	  having the gloss in the entry summary is important when displaying
	  Example cross-ref's.  (This will probably change back again 
	  because Example entries won't be part of production system, 
	  but is useful during development, and possibly to other users 
	  of this code.)

	* pg/reload.sql [1.4]
	* pg/postload.sql [1.6]
	Reorganized so that everything needed for creating the schema
	  is done in reload.sql, and everything needed after the tables
	  have been populated (including index and foreign key creation)
	  is done in postload.sql.

	* pg/mkindex.sql [1.10]
	* pg/mkfk.sql 
	* pg/drpindex.sql [1.1]
	* pg/mkindex.pl [1.1]
	* pg/Makefile [1.1]
	mkindex.sql and drpindex.sql (new files) are generated by mkindex.pl
	  by extracting the information from mktables.sql.  mktables.sql
	  also contains the foreign keys that were formerly in mkfk.sql
	  (now deleted).  This allows all the information about a table to
	  be kept together but executed independently so that indexes/fk's
	  be dropped prior to doing bulk loads.  

	* pg/mktables.sql [1.15]
	Moved the commands for index and foreign key creation into 
	  mktables.sql, but as non-executable comments, since they should
	  not be executed until after the tables are populated.
	Add column "srcnote" to table "entr".  This is to allow giving
	  additional src locator info for the entry, beyond the numberic
	  "seq" number.  

	* pg/data/kwsrc.sql [1.5]
	Change id of examples from 203 (which effectively inactivated it) 
	  to 3 (maaking it active.)  For the implementation for Jim Breen,
	  this will interactively changed back to 203.

	* pg/syncseq.sql [1.8]
	Have it also do a "vacuum analyze" since it is executed after
	  doing a bulk data load.

	* perl/cgi/entr.pl [1.8]
	Call xrefdetails() to get cross-ref info since it is no longer
	  automatically included in the entries returned by EntrList().

	* perl/lib/tal/entr.tal [1.8]
	* perl/lib/tal/newconf.tal [1.4]
	When kanji/reading enclose the reading in brackets only if both
	  kanji and reading are present.  Formerly assumed reading was
	  always present so checked only for presentce of kanji.
	Add display of glosses to cross references.

	* perl/cgi/srchform.pl [1.9]
	* perl/lib/tal/srchform.tal [1.9]
	Display src checkboxes in table rather than row.

	* Makefile [1.9]
	Adjust for change in default jmload.pl output from .pgx to .pgi.
	Add targets for getting, processing and loading the jmnedict and
	  examples files.
	Add loadall targets to get and load everything.
	Update info printed for default target.
	Explicitly provide a logfile name to jmparse in the jmdict.pgi 
	  and jmnedict.pgi target to prevent one from overwrite the other
	  when both target executed sequentually.

	* README.txt [1.9]
	Updated manifest and minor adjustments of install procedure.
	  Still undocumented in install procedure for jmnedict and examples
	  files.

2007-03-15	smcgrawx@frxii.com

	* perl/jmload.pl [1.2]
	Fix: Code in get_max_ids() was still trying to read hist.id which
	  no longer exists.

	* perl/exload.pl [1.1]
	New file.  Load database from examples file.  This version is
	  extremely slow (~12 hr on 900Mhz desktop pc on full examples
	  file, and algorithm for resolving text to db entry needs more 
	  work.  Commited for the historical record.

	* perl/lib/jmdict.pm [1.19]
	Add debugging statement to print sql and args received by dbread()
	  and dbinsert().

	* perl/lib/jmdictxml.pm [1.10]
	Add struct for decoding the A line notes in Examples file.

	* Makefile
	Remove noisy echo commands.

2007-03-14	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.18]
	In addentr(), don't do a commit.  Caller may want to add multiple
	  entries before commiting.

	* perl/cgi/nwsub.pl [1.7]
	Do explicit commit after calling addentr() since that function 
	  no longer does a commit for us.

2007-03-13	smcgrawx@frxii.com

	* perl/jmparse.pl [1.22]
	Name change: was load_jmdict.pl
	Now creates an intermediate .pgx file that requires post-poscessing
	  with jmload.pl, rather than a .dmp file directly.  The .pgx file 
	  contains relative entr.id numbers rather than fixed ones.  This
	  allows the file to be loaded into different databases that require
	  different entr.id numbers, by rebasing with the fast jmload.pl
	  progrm rather than rerunning slow load_jmdict.pl from scratch.
	Track table audio and hist schema changes.

	* perl/jmload.pl [1.1]
	New file: rebase the relative entr.id numbers in a .pgx file
	  generated by jmparse.pl and create a Postgresql dump file
	  suitable for loading into a jmdict database.

	* perl/cgi/nwconf.pl [1.6]
	Track table audio and hist schema changes.

	* perl/cgi/nwsub.pl [1.6]
	Force entr.src=1 (jmdict) since jmdict::addentry() doesn't anymore.

	* perl/lib/jmdict.pm [1.17]
	Track table audio and hist schema changes.
	Don't force src to 1 (jmdict); function should be able to add 
	  any kind of entry.
	Force a seq number only if one not already set, and src=1 (jmdict).
	  Non-jmdict entries may use different sequence numbering.

	* perl/showentr.pl [1.12]
	* pg/mktables.sql [1.14]
	* pg/mkviews.sql [1.14]
	* pg/mkindex.sql [1.9]
	* pg/mksyncseq.sql [1.7]
	Tables audio and hist now use composite primary keys like 
	  all the other tables rather than SERIAL pks.  Should have done
	  this as part of the 2007-02-11 pk/fk change.

	* Makefile [1.7]
	Track the split of load_jmdict.pk into jmparse.pl an jmload.pl.

	* doc/schema.dia [1.3]
	* doc/schema.png [1.5]
	* doc/schema.odt [1.3]
	* doc/schema.html [1.2]
	Track table audio and hist schema changes.

	* README.txt [1.8]
	rack the split of load_jmdict.pk into jmparse.pl an jmload.pl.

2007-03-13	smcgrawx@frxii.com

	* T014 tag
	Released on Arakawa.

	* perl/load_jmdict.pl 1.21]
	Fix: -i option didn't work.
	Fix: entr.src not set for deleted entries created from comments
	  which cause subsequent db load t fail.
	Print initial values eid, hid values when starting, in case user 
	  (me) forgets about -i option and runs before database was init'd.

	* perl/showentr.pl [1.11]
	FIX: rinf keywords were printing using text from kinf.

	* perl/lib/jmdict.pm [1.16]
	The erefs query is very slow.  Until we can speed it up, get a
	  speed improvement for majority cases by not running it if we
	  know there are no xrefs because $xref and $xrer are empty.

	* pg/mkviews.sql [1.13]
	Fix: stored procedure "dupentr" had several syntax errors.
	Add view eksum.  Like esum but doesn't include senses/glosses.
	Change view xrefesum to use eksum instead of esum to speed it 
	  up a little.

2007-03-10	smcgrawx@frxii.com

	* lib/tal/srchform.tal [1.7]
	Make jmdict dictionary checked by default.  Requires fix to
	  Petal/Utils/Decode.pm, see 
	  http://article.gmane.org/gmane.comp.lang.perl.modules.petal/369

2007-03-10	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.20]
	Support for loading JMnedict data.
	Option to start entr.id number at other than 1, either by 
	  giving explicitly on command line, or reading from database.
	Add command line option to create temp files in other than
	  current directory.

	* cgi/srchform.pl [1.8]
	Support for "src" group:
	When generating "src" option list, grep out item>200 as done
	  for other option groups.
	Pass the src option group to the tal template.

	* lib/tal/entr.tal [1.7]
	Support for "src" group: show dict after seq number.

	* lib/tal/srchform.tal [1.7]
	Support for "src" group: add "src" section.

	* lib/tal/srchres.tal [1.4]
	Support for "src" group: show a single letter indicator
	  for each result that that indicates its dictionary.

	* lib/jmdictxml.pm [1.9]
	* pg/data/kwpos.sql [1.6]
	Support for jmnedict data: add pos keywords for jmnedict
	  <name_type> tags.

	* pg/mkviews.sql [1.12]
	Support for "src" group: add columns entr.src, .stat, and .notes
	  to views esum and xrefesum.

	* pg/data/kwsrc.sql [1.4]
	Support for "src" group: change id of keyword "examples" from
	  3 to 203 so that is won't show up in srchform.pl/tal src
	  section checkboxes.

2007-03-09	smcgrawx@frxii.com

	* T013 tagged
	Released on Arakawa.

	* doc/schema.odt [1.2]
	Many tweeks.
	Added new section "Using SQL".

	* doc/schema.html [1.1]
	New file.  Add html version exported from schema.odt for 
	  those without Open Office.

	* doc/tut0.pl [1.1]
	* doc/tut1.pl [1.1]
	* doc/tut2.pl [1.1]
	* doc/tut3.pl [1.1]
	New files.  API tutorials.

	* perl/showentr.pl [1.10]
	Fix: Xrefs display broken since jmdict.pm[1.8] (when EntrList() 
	  was changed to put xref summary info in {_erefs} rather than
	  {_xref}).  Regression tests would have caught this.
	Added a lot of comments.

	* perl/lib/jmdict.pm [1.15]
	Added a lot of comments.
	EntrList(): make all three restriction lists available from top
	  of entr object.

	* perl/lib/jmdicted.pm [1.1]
	New file.  Functions for making (and to come, parsing)
	  edictish text.

	* Makefile [1.6]
	Include doc files in target "dist".

	* README.txt [1.7]
	Added documentation section.
	Updated manifest.

2007-03-05	smcgrawx@frxii.com

	* pg/mkviews.sql [1.11]
	As result of the 2007-02-11 pk/fk change, the dupentr stored 
	  proc can be greatly simplified:  all loops can be removed 
	  and all needed rows copied with simple insert statements.
	Remove unused views "xsum" and "xsumr".

	* doc/
	Add new directory for documentation.

	* doc/schema.dia [1.2]
	* doc/schema.png [1.5]
	Move from top-level directory into doc/.  This was done in
	  the CVS respository so it is retroactive.	

	* doc/schema.odt [1.1]
	New file.  Open Office Writer documentation for the database
	  schema.

	* README.txt [1.6]
	Update for new doc directory, addition of the schema.odt file.

2007-02-27	smcgrawx@frxii.com

	This change set replaces the kfreq and rfreq tables, that 
	held frequency-of-use data for readings and kanji respectively,
	with a single table, freq.  Most foU elements refer not to
	a reading or kanji independently, but to a reading-kanji pair.
	The freq table has columns [entr,rdng,kanj,kw,value] that 
	allows representation of rk pairs.  To allow for the minority 
	cases were a FoU datum refers to an individual reading or kanji
	we allow rdng and kanj to be NULL, with a constraint that forces
	at least one to be non-null.  Ideally we would like the table's
	primary key to be the first four columns, but primary keys may
	not contain nullable columns in many rdbms' including Postgresql.
	However we do enforce a unique constraint on each row, although
	the implementation is non-obvious since a standard unique 
	constraint does not work as desired with nullable columns.

	One problem not yet fixed is that when a reading (or kanji) is
	paired with two kanji (or reading) with the same FoU rtag, the
	tag will displayed twice on the reading (or kanji).  This is 
	easily fixed, but can be fixed in a couple different places and
	I'm not sure yet which is best.

	* pg/mktables.sql [1.13]
	* pg/mkfk.sql [1.8]
	Replace tables"rfreq" and "kfreq" with table "freq".  

	* pg/mkindex.sql [1.8]
	We can't put a pk on table freq because the rdng and kanj columns 
	  are nullable so a unique index is next best thing.  But nullable
	  columns also prevent a stock unique constraint from working as
	  we want.  So we build a special index that will handle nulls. 

	* pg/mkviews.sql [1.10]
	Adjust wiews pkanj, prdng, and dupentr for the freq table change.

	* pg/mkperms.sql [1.7]
	Adjust for replacement of rfreq/kfreq with freq.

	* load_jmdict.pl [1.19]
	Adjust for replacement of rfreq/kfreq with freq.  Specifically
	  we have to accumulate but not process the ke_pri and re_pri
	  info while processing the reading and kanji elements, and
	  afterwards, find any matching re_pri and ke_pri tags and
	  coallesce them before writing the freq table data.

	* perl/lib/jmdict.pm [1.14]
	In matchup() don't die if all children records are not assigned
	  to a parent.  We need this because we will read "freq" tables
	  records, some of which be be assigned to rdng parents, some to
	  kanj parents.
	EntrList(): use data from freq table rather than rfreq and kfreq.

	* perl/cgi/srchres.pl [1.9]
	Adjust code in freq_srch_clause() for schema change.

	* schema.dia [1.2]
	Update for the schema change: replace tables kfreq, rfreq with
	  table freq.

	* schema.png [1.4]
	Regenerated from updated schema.dia.
	Export with dimensions 1508x1024 rather than the default 1033x687
`	  which makes text more readable.

2007-02-25	smcgrawx@frxii.com

	* Tag T012

2007-02-24	smcgrawx@frxii.com

	* perl/lib/jmdict.pm [1.13]
	The big pk/fk change made on 2007-02-11 makes it possible to 
	  greatly simplify the queries used in EntrList() to read in
	  a (set of) object(s).

2007-02-24	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.18]
	* pg/mktables.sql [1.11]
	Change primary key of tables rfreq and kfreq to include column
	  "value".  This will allow a kanji or reading to have multiple
	  freq tag belonging to the same scale (e.g. a reading could 
	  have both "ichi1" and "ichi2" tag simultaneously.)  In
	  load_jmfict.pl remove function freqs() which was responsible
	  for discarding duplicates.

	The handling of re_inf and ke_inf tag is broken.
	I had not realized that when two tags with the same scale (e.g.
	"nf20" and "nf34" occurred on the same keb or reb element, it 
	indicates a pairing with another element with the same tag [1][2].  
	I was assuming the pri tags were independent and thus such conflicting 
	tags were illogical and dropped one.  The changes to the above two
	files allow the rfreq and kfreq tables to store all the pri tags,
	for a reb/keb, even if they have the same scale.  This makes the 
	data model identical with that in the jmdict xml file, but it is
	(from a rdbms point of view) unnormalized and should be improved.

	This will probably need a schema change to fix, since we need 
	to model a different kind of information (pri information about 
	reading-kanji pairs, not (neccessarily) about individual readings
`	or kanji).  But until we do that fix, this will allow the database 
	to present the same info as wwwjdic, and contain all the tag into 
	which will help when exploring for a better solution.

	[1] Jim Breen, email to edict mailing list, 2007-02-15 in response
	    to Marc (frenchquacky).
	[2] Comment describing the ke_pri entity in the jmdict xml DTD.

2007-02-23	smcgrawx@frxii.com

	* perl/lib/tal/srchform.tal [1.4]
	* perl/cgi/srchform.pl [1.5]
	* perl/cgi/srchres.pl [1.6]
	Add section for fld (field) attributes.
	Correct typo in Readng Info caption.
	Add Reset button.

2007-02-22	smcgrawx@frxii.com

	* perl/lib/jmdictxml.pm [1.8]
	Fix: Update value of rinf.uK to match kwrinf.sql.

2007-02-21	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.17]
	Check for use of deprecated keywords and print warning
	  to logfile.
	Add comments.
	
	* perl/lib/jmdictxml.pm [1.7]
	Deprecate items that are no longer used in current jmdict 
	  xml files.

	* pg/data/kwmisc.sql [1.5]
	* pg/data/kwpos.sql [1.5]
	* pg/data/kwrinf.sql [1.5]
	Deprecate items that are no longer used in current jmdict 
	  xml files.
	Add comment about tracking jmdictxml.pm.

	* pg/data/kwdial.sql [1.5]
	* pg/data/kwfld.sql [1.4]
	* pg/data/kwfreq.sql [1.7]
	* pg/data/kwkinf.sql [1.4]
	* pg/data/kwlang.sql [1.4]
	Add comment about tracking jmdictxml.pm.

	* Makefile [1.5]
	In target "clean", don't delete skipped_comments.log since 
	  load_jmdict.pl no longer creates that file.

	* perl/lib/tal/srchform.tal [1.4]
	* perl/cgi/srchform.pl [1.5]
	* perl/cgi/srchres.pl [1.6]
	Add search for kinf, rinf attributes.

	* pg/xresolv.sql [1.5]
	Remove the query that displays unresolvable xrefs.  That info
	  is lost in postload.sql's copious output and can be dislayed
	  later if needed.

2007-02-21	smcgrawx@frxii.com

	* perl/cgi/srchres.pl
	Fix: The change to allow searching for "spec2" kfreq and rfreq
	  values made to perl/cgi/srchform.pl[1.5] on 2007-02-19 was
	  incomplete.  Also need to change srchres.pl which was too
	   smart and "knew" spec had only a "1" value.
	Commented freq_srch_clause() function.

2007-02-20	smcgrawx@frxii.com

	* Makefile
	In target "jmdict.xml", remove JMdict file before running
	  wget.  If JMdict file exists, wget will create new file with
	  a ".1" suffix and rest of commands will operate on wrong 
	  file.

2007-02-20	smcgrawx@frxii.com

	* perl/load_jmdict.pl
	Don't skip "news1/2" frequency values any more.  Ref jb email to
	  edict list, 2007-02-20, in which he said he sometimes manually
	  changes news1/2 values so the <=/>nf24 correspondence is not
	  neccessarily true.  This change will add them to database so
	  can investigate best way to handle.
	Log skipped duplicate nfxx and newsx freq values.  jb edict list 
	  mail (2007-02-15 reply to frenchquacky) says that these are
	  (contrary to what I thought) significant.  Need to gather info 
	  on how/many where they are to formulate plan to handle since
	  current data model does not allow.
	Replaced the "skipped_comments" logging code with something more
	  general.  Accept a -l option for logfile name and use that for
	  all log messages.
	Set a global $::Seq with current seq number for use in log messages.
	  I don't think any line numbers other than for <entry> and comment
	  lines is available from XML::Twig, unless we set up tag handlers
	  which seems like a lot of work. 

	* perl/lib/jmdictxml.pm
	Add 'news' value to FREQs.  (See load_jmdict.pl comments.)
	Remove 'jdd' value from FREQs.  (This should have been done
	  along with the change to pg/data/kwfreq.sql on 2007-02-19.)

	* pg/data/kwfreq.sql
	Add 'news' keyword.  (See load_jmdict.pl comments.)

2007-02-19	smcgrawx@frxii.com

	* Makefile
	Get rid of most continued command lines.  This provides better error
	  termination and in the "all" target they did not display as desired
	  on Debian.
	Clarify the help message in the "all" target.

	* Changes.txt README.txt
	Obsfucate email address since these files now exposed on internet.

	* perl/cgi/srchform.pl [1.5]
	Remove line of code that supressed generating the "spec2" option box
	  since spec2 tags do actually exist.  Not sure why I thought they 
	  didn't.

	* pg/data/kwfreq.sql [1.5]
	Remove "jdd" keyword (no longer used in jmdict xml file) per jb post 
	  to edict email list, 2007-02-19.

2007-02-18	smcgrawx@frxii.com

	* Tag T011
	This code released as development snapshot jmdict-T011.tgz on Arakawa.

	* Makefile
	Fixes and enhancements.

	* perl/cgi/nwconf.pl
	Fix: When creating history record, was erroneously using ref's for 
	  {comment} and {who}, rather than strings.

	* perl/cgi/nwsub.pl
	Fix: Check for exactly one hist record, and reset it's timesstamp
	  since there could be long delay between when it was set in nwconf.pl
	  and when nwsub.pl gets it. 

	* perl/lib/jmdict.pm
	Fix: addentr() was not writing history records to the database.

2007-02-17	smcgrawx@frxii.com

	* Makefile
	New.  Nothing equivalent for Windows yet.  

	* README.txt
	More typos and tweaks.

	* perl/showentr.pl [1.9]
	Revert use of experimental KwdsStatic module.  That was not
	  supposed to get into main branch yet.

	* perl/lib/jmdict.pm
	Fix: trailing \n in the db credentials line read from jmdict.cfg
	  which was causing authentication to fail on my Fedora test machine.

	* perl/lib/tal/nwform.tal [1.2]
	Change header at top of page so there is some way to distingish
	  it from the real wwwjdict form.

2007-02-17	smcgrawx@frxii.com

	* pg/mkviews.sql
	Add new view ssum.
	Fix typo and tweak readability in GPL notice.

	* Changes.txt
	Added additional item to the "cons" section of the pk/fk change 
	  description in the 2007-02-11 entry.

2007-02-16	smcgrawx@frxii.com

	* README.txt [1.2]
	Fix typos and make other minor corrections.

	* perl/lib/tal/entr.tal [1.5]
	* perl/lib/tal/nwconf.tal [1.2]
	Fix: display of field keywords in senses was wrong.

	* perl/cgi/entr.pl [1.7]
	Fix: If a sense had a stagr restiction but no stagk restriction,
	  fmtstag() would erroneously include all the kanji in the
	  combined list it generates.
	Move db open code to jmdict.pm.
	Fix typo and tweak readability in GPL notice.

	* perl/cgi/nwconf.pl [1.3]
	* perl/cgi/nwform.pl [1.2]
	* perl/cgi/nwsub.pl [1.3]
	* perl/cgi/srchform.pl [1.3]
	* perl/cgi/srchres.pl [1.4] 
	Move db open code to jmdict.pm.
	Fix typo and tweak readability in GPL notice.

	* perl/lib/jmdict.pm [1.10]
	Fix: uninitialized string in EntrList() when $cond is a "where" clause.
	New: dbopen() function to encapsulate reading a config file to get
	  database login credenials, something needed by all the cgi scripts.
	Fix typo and tweak readability in GPL notice.

	* perl/lib/jmdictcgi.pm [1.3]
	* perl/lib/jmdicttal.pm [1.6]
	* perl/lib/jmdictxml.pm [1.5]
	* perl/load_jmdict.pl [1.15]
	* perl/showentr.pl [1.8]
	* pg/data/kwdial.sql [1.4]
	* pg/data/kwfld.sql [1.3]
	* pg/data/kwfreq.sql [1.4]
	* pg/data/kwkinf.sql [1.3]
	* pg/data/kwlang.sql [1.3]
	* pg/data/kwmisc.sql [1.4]
	* pg/data/kwpos.sql [1.4]
	* pg/data/kwrinf.sql [1.4]
	* pg/data/kwsrc.sql [1.3]
	* pg/data/kwstat.sql [1.4]
	* pg/data/kwxref.sql [1.3]
	* pg/mkfk.sql [1.7]
	* pg/mkindex.sql [1.7]
	* pg/mkperms.sql [1.6]
	* pg/mktables.sql [1.11]
	* pg/syncseq.sql [1.6]
	* pg/xresolv.sql [1.4]
	Fix typo and tweak readability in GPL notice.

2007-02-14	smcgrawx@frxii.com

	* schema.vsd
	Microsoft Visio file schema.vsd removed, replaced by schema.dia.

	* schema.dia
	Replaces schema.vsd.  Created with Dia (http://live.gnome.org/Dia)
	  which is a free (GPL) interactive drawing app with many of the
	  capabilities of Visio, and which runs under both Unix/Linux and
	  Windows.
	Updated for current schema.

	* schema.png
	Created from schema.dia.

2007-02-12	smcgrawx@frxii.com

	Add top level README.txt.
	Explicitly add GPL license terms.
	Remove obolete mysql/ and python/ directories.
	Remove perl/README.txt (replaced by ./README.txt)
	Remove perl/load_googits.pl (better to load raw data into database
	  table and create k/rfreq data with db query.  Will be documented 
	  later.)

2007-02-11	smcgrawx@frxii.com

	Changed primary keys on tables "rdng", "kanj", "sens", "gloss",
	  from a single SERIAL column to composite key based on the 
	  table "entr"s "id" column and the former "ord" column.  For
	  example, the primary key of the rdng table was surregate key
	  using a SERIAL column named "id".  Now it is a composite key
	  ("entr","rdng") where "entr" is a foreign key to entr.id, and
	  rdng a small number (1, 2,..) that replaces the former "ord"
	  column.  This change also affects all tables that have foreign
	  keys to the changed tables mentioned above.

	  Pros:
	  - More natural representation, e.g. reading now identified
	    as reading 3 of entry 55555, rather than an arbitrary 
	    number.
	  - Allows simpler code when dealing with audio, xrefs, etc,
	    because associated entry id is always available and does  
	    not have to be recovered using a more complicated query.
	  - Eliminates the need to lookup entries by sens.id, rdng.id, 
	    etc, in user interfaces.
	  - Eliminates some possibilities for inconsistencies such
	    as restr's that have reading and kanji from different
	    entries.
	  - Greatly reduces the space required by the largest tables
	    by eliminating a 4-byte integer from each row.
	  - Eliminates need for extra sequence tables to support the
	    SERIAL columns.
	  - Number of indexes needed is greatly reduced. 
	  Cons:
	  - Joins between the changed tables and their children now
	    need to be done on two columns rather than one.  Grand-
	    children will need three columns (but there aren't any yet.)
	  - Children of the changed tables need extra column (2-byte)
	    (but because these tables are much smaller than their parent
	    table, the space saving in the parent table greatly outweighs
	    the greater space needed by these child tables.)
	  - Ordering of senses, readings, etc within an entry is no longer
	    independent of the table's pk (bad in general), but this is not
	    a problem because:
	    - It *is* idependent of the full pk, only dependent of the part
	      of the pk relevent to one entry.
	    - Because all foreign keys to the pk's are created with "ON UPDATE
	      CASCADE", the within-entry part of the key can be changed to 
	      adjust the order, and any related foreign keys will automatically
	      be updated by the database to the new value.

	Other changes:
	--------------

	* perl/load_jmdict.pl
	Pk/fk changes on major tables.
	Use "Deleted..." comments to create D history records.  
	  Unparsable comments are written to new output file
	  skipped_comments.log.
	Add -e option to specify encoding used for interactive
	  and debug messages.  Program still bombs when converting
	  unconvertable characters (european character in gloss to
	  shift_jis on Windows for example) which limits usefulness
	  of this option.

	* perl/showentr.pl
	Pk/fk changes on major tables.
	Add -e option to specify encoding used for interactive
	  and debug messages.  Program still bombs when converting
	  unconvertable characters (european character in gloss to
	  shift_jis on Windows for example) which limits usefulness
	  of this option.

	* perl/cgi/entr.css
	Format for notes and debug info.

	* perl/cgi/entr.pl
	Pk/fk changes on major tables.
	Add debug info displayed at bottom of page such as executed
	  sql statements and various timings.) 
	Display xrefs as target entry info followed by a parenthesised
	  list of senses of there are more than one.

	* perl/cgi/nwconf.pl
	Pk/fk changes on major tables.
	Rewite code that handles xref info for display.
	Allow target sense specifiers in xref text field.
	Do more validity checking of xrefs (eg complain if the xref 
	  resolved to more than one entry and explicit senses given.)
	Display xrefs as target entry info followed by a parenthesised
	  list of senses of there are more than one.

	* perl/cgi/nwsub.pl 
	Pk/fk changes on major tables.
	Use xref info rather than eref info when writing new entry
	  to database.

	* perl/cgi/srchform.pl
	Pk/fk changes on major tables.
	Changes corresponding to the jmdict modularization changes.
	Remove id search capability for sens, rdng, kanj, gloss.
	build_search_sql() and extend_from() (nee mk_from_clause())
	  were complete rewritten.

	* perl/lib/jmdict.pm
	Pk/fk changes on major tables.
	Make into regular perl module 
	Collect debug info for later displaye (such as executed sql 
	  statements and various timings.) 
	In Find() address performance problem created my using a temp
	  table to keep search results, by running a VACUUM ANALYZE
	  on it.
	Functions irestr(),istagr(),istagk() no longer used and 
	  removed.
	New functions bld_erefs(),xrefs2xrefs(),xrefs2erefs(),fmtkr(),
	  zip(),linkrecs().
	
	* perl/lib/jmdicttal.pm
	Add pertal modifiers "h2l" (convert a hash to a list) and "join"
	  (like perl join()).

	* perl/lib/tal/entr.tal perl/lib/tal/nwconf.tal
	Pk/fk changes on major tables.
	Use tables rather than lists for layout.
	Use a consise display for cross-references with each target
	  entry listed only once.  (However, this does does not
	  provide for displaying xref notes.)
	When displaying cross-refs, explicity list target senses
	  when there is more than one. 
	Add debug info displayed at bottom of page such as executed
	  sql statements and various timings.) 

	* perl/lib/tal/srchform.tal
	Pk/fk changes on major tables.
	Remove id search capability for sens, rdng, kanj, gloss.

	* per/lib/tal/srchres.tal
	Add debug info displayed at bottom of page such as executed
	  sql statements and various timings.) 

	* pg/mkfk.sql pg/mktables.sql pg/xresolv.sql pg/syncseq.sql pg/mkindex.sql 
	Pk/fk changes on major tables.

	* pg/mkviews.sql
	Pk/fk changes on major tables.
	Replace view entr_summary with esum.
	New view xrefesum.

2007-01-29	smcgrawx@frxii.com

	* Tag T010
	This tag preceeds a major revision of the database schema
	  that affects nearly all the files.  At this point, the
	  loader scripts (load_jmdict.pl, reload.sql, postload.sql),
	  work as does showentr.pl and the cgi scripts although the
	  latter have not been tested much.  load_googits.pl may 
	  work but its easier/faster/better to load the raw googit
	  data into a temp table and update the kfreq/rfreq tables 
	  using queries based on that.
	  The python and mysql directories remain obsolete.

2007-01-29	smcgrawx@frxii.com

	* pg/syncseq.sql
	Remove duplicate line.

2007-01-28	smcgrawx@frxii.com

	* load_jmdict.pl
	Change increment used for "ord" columns from 10 to 1.

	* perl/lib/jmdict.pm
	Fix errant keystroke that causes syntax error.

2007-01-27	smcgrawx@frxii.com

	* perl/cgi/entr.css
	Add entry.notice and entry.caution formats.

	* perl/cgi/entr.pl
	Add validation of url parameters.
	Generate error page if parameters are bad..

	* perl/cgi/nwform.pl
	* perl/cgi/nwconf.pl
	* perl/cgi/nwsub.pl
	New: Page generators for Add New Word web interface.

	* perl/lib/jmdict.pm
	Fix: jstr_classify not setting KATAKANA bit properly.
	Add functions dbinsert() and addrentr().
	Provide more info in cross ref display: In EntrList()
	  change the sql used to read xref data.
	
	* perl/lib/jmdictcgi.pm
	New: Support functions for the cgi code.

	* perl/lib/tal/entr.tal
	Provide more info in cross ref display: adjust template to
	  use more detailed xref data.
	Display sense notes.
	Display id info as {id/ord} rather than {ord/id}.
	Comment out gloss lang since we will be using the english
	  only jmdict from here on.  (The non-english enties in
	  the jmdict.xml file are merged in from other projects
	  and won't be maintained by the jmdict project, at least 
	  imediately.)
	Add h1 title.

	* perl/lib/tal/srchres.tal
	Add h1 title.

	* perl/lib/tal/srchform.tal
	Add notice about priority of Id Number search.
	Add usage notes at bottom of page.
	Make seq number search the defaut option (was entry id)
	Change titles of id number search text boxes.
	Change default for gA search compare from "<=" to ">=".
	Add h1 title.

	* perl/lib/tal/nwform.tal
	* perl/lib/tal/nwconf.tal
	New: Templates for Add New Word web interface.

	* perl/lib/jmdictxml.pm
	Fix: correct missing trailing space in expanded entity 
	  text for RINF/uk.

	* pg/syncseq.sql
	Update the new "seq" sequence (see mktables.sql).

	* pg/mkfk.sql
	Fix: missing fk in stagk to kanj.id.

	* pg/mktables.sql
	Add new sequence "seq" to provide seq numbers for table
	  "entr".  These expected to be obtained and used by the
	  application code -- they are not used as entr.seq default
	  values.

	* pg/mkviews.sql
	Provide more info in cross ref display: replace view sref
	  with xsum and xsumr for generating sens->entry xref records
	  from db's native sens->sens data.

2007-01-15	smcgrawx@frxii.com

	* perl/load_googits.pl [1.3]
	Fix: was warning about texts that resolved to multiple
	  entries but still added the [kr]freq googits values.
	  Now it skips them.

	* pg/mkviews [1.5]
	Add views pkanj and prdng to give a view of kanj or
	  rdng table with additional column that indicates if
	  the kanj/rdng would have "P" tag in edict.

2007-01-15	smcgrawx@frxii.com

	* perl/load_googits.pl [1.2]
	Fix call dbi method disconnect() (was typo finish()).

	* pg/mkviews.sql [1.4]
	Explicitly create the plpgsql language since it does not 
	  exist in a default Postgresql install but may be present
	  in some installs (e.g. Windows if selected at install
	  time).

2007-01-15	smcgrawx@frxii.com

	* perl/load_googits.pl [1.1]
	* pg/data/kwfreq.sql [1.2]
	Add support fo google hit counts as kfreq/rfreq FoU metric.

	* perl/cgi/srchform.pl [1.2]
	* perl/cgi/srchres.pl [1.2]
	* perl/lib/tal/srchform.tal [1.2]
	Add support for entry status and google hit counts.

	* pg/mkindex.sql [1.4]
	Disable unique indexes on (entr,txt) for tables kanj and 
	  rdng and (sens.txt) for table gloss because (as of 
	  2007-01-14) duplicates exist in the jmdict xml file.

	* pg/mktables.sql [1.7]
	Fix syntax error typo.

	* pg/mkviews.sql [1.3]
	Add experimental functions dupentr and delentr.

	* pg/data/kwstat.sql [1.2]
	Shorten 'descr' text a little.

2007-01-13	smcgrawx@frxii.com

	* Tag T009
	This bring the Perl web interface code to approxmately where 
	  the Python code was when work switched to Perl.  At this point
	  some support code has been added for better history trackng
	  and and update process but it is incomplete.

	* perl/load_jmdict.pl [1.11]
	Fix: Forgot to write out new "diff" column when creating
	  load records for table hist as needed by maketables.sql[1.6].

	* perl/cgi/entr.css [1.3]
	Tweak fomatting of srchres page.

	* perl/cgi/entr.pl [1.3]
	Fix: reading of db login info from file jmdict.cfg. 

	* perl/lib/jmdict.pm [1.5]
	Add new subs:
	  - kwrecs to get a single set of record values without duplicates 
	  from a keyword data structure.
	  - jstr_classify to identify the types of japanese characters in a
	  string.

	* perl/lib/jmdicttal.pm [1.3]
	Steal the split_args() and fetch_arg() subs from Petal::Utils and
	  rewrite our modifiers to use them.
	Add new modifiers "gt", "lt", "len", and (untested) "perl".
	Change "freqs" modifier to not require first argument "FREQ".

	* perl/lib/tal/entr.tal [1.3]
	Put single quotes around keyword type strings, and remove FREQ type
	  from modifer "freqs", as required by revised modifiers in 
	  jmdicttal.pm [1.3].

	* perl/cgi/srchform.pl
	* perl/cgi/srchres.pl
	* perl/lib/tal/srchform.tal
	* perl/lib/tal/srchres.tal
	New files to provide search form an results pages.

2007-01-09	smcgrawx@frxii.com

	* pg/mkindex.sql [1.3]
	Add unique indexes on columns (entr,ord) in tables rdng,
	  kanj,sens,gloss.  These are needed because the function 
	  (under development) that duplicates entries need to match
	  up old and new rdng's, kanj,s and sens's to duplicate the
	  restriction table entries, and uses unique ord numbers to
	  do that.
	Add unique indexes on columns (entr,txt) in tables rdng,
	  kanj, and gloss.  This disallows duplicate txt values
	  in the same entry.
	Add partial index on entr.stat.
	Add index on audio.fname.

	* pg/mktables.sql [1.6]
	Add "diff" column to "hist" table.

	* pg/mkindex.sql [1.3]
	* pg/mkperms.sql [1.4]
	* pg/mktables.sql [1.6]
	Add new "editor" table.

2007-01-08	smcgrawx@frxii.com

	* perl/lib/jmdict.pl
	Fix: Correctly index keyword records by kw string in sub 
	  Kwds.  Previously they were only indexed by id due to
	  programer brain-deadness.

2007-01-06	smcgrawx@frxii.com

	* perl/load_jmdict.pl perl/cgi/entr.pl 
	Make shebang line use env program rather than hardwiring the
	  location of the perl interpreter.

	* perl/showentr.pl
	Make shebang line use env program rather than hardwiring the
	  location of the perl interpreter.
	Replace embedded utf-8 characters with escaped notation
	  (eg "\x{3010}").  This eliminates the need for the file
	  to be utf-8 encoded, which in turn prevents Microsoft
	  windows from making the first three bytes a binary bom
	  which confuses unix machines.

2007-01-05	smcgrawx@frxii.com

	* perl/load_jmdict.pl [1.9]
	* perl/lib/jmdict.pm [1.3]
	* pg/loadkw.sql [1.3]
	* pg/mkfk.sql [1.3]
	* pg/mkperms.sql [1.3]
	* pg/mktables.sql [1.5]
	* pg/data/kwstat.sql[1.1]
	Change the "stat" column in tables "entr" and "hist" from
	  a checked character to a keyword integer that is a foreign
	  key to new table "kwstat".

	* perl/showentr.pl [1.4]
	* perl/cgi/entr.css [1.2]
	* perl/lib/jmdicttal.pm [1.2]
	* perl/lib/tal/entr.tal [1.2]
	Show status (entr.stat) when displaying entries.

2007-01-05	smcgrawx@frxii.com

	* Tag T008

2007-01-04	smcgrawx@frxii.com

	* perl/lib/jmdict.pm
	Moved jmdict.pm from directory perl/ to perl/lib/ (in CVS 
	  repository).
	Change some hash key names in the structure returned by 
	  EntrList to be more consistent with table/column names.
	In KW structure, use same 1st level key (e.g. 'POS') to 
	  hold both 'kw' hash and 'id' hash.  Formerly the latter
	  used a key prefixed with "i" (e.g. 'iPOS'). 
	Move sub filt() from showentr.pl to here.
	Add sub's irestr(), istagr(), istagk() which will convert
	  the restriction lists from the database form to jmdict form. 

	* perl/load_jmdict.pl perl/lib/jmdictxml.pm
	Moved jmdictxml.pm from directory perl/ to perl/lib/ (in CVS 
	  repository).

	* perl/showentr.pl
	Moved jmdict.pm from directory perl/ to perl/lib/ (in CVS 
	  repository).
	Track the entry hash key name changes and KW key changes made
	  in perl/lib/jmdict.pl.
	Fix: displayed kanji freq data was actually erroneously using
	  reading frequency data.
	Fix: Stagr/stagk restrictions weren't displaying.
	Fix: History notes weren't displaying.
	Eliminate some warnings reported by "use warnings".
	Move sub filt() to jmdict.pm.
	Add code to show reverse cross refs.

	* perl/cgi/entr.pl perl/cgi/entr.css perl/lib/jmdicttal.pm  
	* perl/lib/tal/entr.tal
	Add demo/devtool cgi script entr.pl and supporting files
	  jmdicttal.pm, entr.tal, entr.css

	* pg/postload.sql pg/syncseq.sql
	Set the currval of all sequences after loading database.  
	  Otherwise inserts that use a defaulted id will fail.

2006-12-30	smcgrawx@frxii.com

	* perl/showentry.pl[1.2]
	Fix handling of multiple command line args.
	Fix display of dialect and language elements.

2006-12-26	smcgrawx@frxii.com

	* perl/jmdictxml.pm[1.2]
	Renamed JMdict.pm to jmdictxml.pm.  This was done in
	  CVS repository so is "retroactive".

	* perl/load_jmdict.pl[1.7]
	Use renamed jmdictxml.pm.
	Add help option and usage() sub.

	* perl/jmdict.pm[1.1]
	New.  Contains common database access subs.

	* perl/showentry.pl[1.1]
	New.  Console app to display all info for specified jmdict
	  entries.

2006-12-26	smcgrawx@frxii.com

	* perl/load_jmdict.pl[1.6]
	When hist records are created by load_jmdixt.pl, create them 
	  with stat='A' instead of null. 

	* pg/mktables.sql[1.4]
	In table hist, change name of (what was) column 'ostat' to 'stat'
	  and add NOT NULL constraint, don't allow 'stat' to be a space 
	  character. 

	* pg/mkviews.sql[1.2]
	Changed old convention of using 'k','j' aliases for tables
	  'rdng' and 'kanj' to new convention 'r','k'.
	Add view 'sref'.

	* pg/postload.sql[1.4]
	Set permissions as last step rather than earlier so that all
	  database object will have been created.

2006-12-25	smcgrawx@frxii.com

	* perl/load_jmdict.pl[1.5]
	Fix: gloss language attribute was not read correctly and all 
	  glosses were defaulted to "en".

2006-12-23	smcgrawx@frxii.com

	* perl/load_jmdict.pl[1.4]
	Fix: was not generating correct data for tables restr, stagr, 
	  stagk when some items has restrictions (including re_nokanj)
	  and others didn't.

	* pg/mktables.sql[1.3]
	Change column name in table aufio from "start" to "strt"
	  because former is a SQL-2003 reserved word.
	
	* pg/postload.sql[1.3]
	Do a "vacuum analyze" as last step.

	* perl/README.txt
	Reorganized load instructions again.


2006-12-23	smcgrawx@frxii.com

	* load_jmdict.pl[1.3]
	Fix: hist data not written to output dmp file.
	Fix: eliminate duplicate keys kfreq and rfreq tables that
	  resulted in error when loaded into database with result
	  that both tables ended up empty.
	Guess OS based on environment variable and assume encoding
	  for interactive output of utf-8 is Unix or shift_jis is
	  Windows.
	

2006-12-22	smcgrawx@frxii.com

	* pg/mkfk.sql pg/mkindex.sql pg/mkperms.sql pg/mktables 
	* load_jmdict.pl
	Change name of table "audit" to "hist".  Add new table "audio".

	* perl/README.txt
	Reorganized load instructions.

	* pg/postload.sql pg/xresolv.sql
	xresolv.sql will create xref table extries based on contents
	  of table xresolv loaded with jmdict data.  postload.sql
	  modified to call xresolv.sql as part of postload processing.

2006-12-18	smcgrawx@frxii.com

	* Tag T007
	At this point the perl jmdict loader sucessfully loads 
	  jmdict into a postgresql database, using the instructions
	  in perl/README.txt.  The mysql stuff is obsolete and the
	  python stuff is probably broken.

	* pg/mkfk.sql pg/mkindex.sql pg/mkperms.sql pg/mktables.sql
	  pg/mkviews.sql pg/postload.sql pg/reload.sql pg/schema.sql
	Replace schema.sql with a separate scripts for creating tables,
	  indexes, foreign keys, etc.  This is because new loader method
	  uses postgresql copy commands in file and does the indexing, 
	  etc afterwards.
	Database name changed from jb to jmdict.

	* perl/load_jmdict.pl perl/JMdict.pm perl/README.txt
	Database loader written in Perl.  Requires module XML::Twig.
	JMdict.pm module maps JMdict xml file text strings to database
	keyword id numbers.

2006-12-18	smcgrawx@frxii.com

	* Tag T006
	Around 2006/11/30 a decision seems to have been taken on 
	  on the jmdict mailing list to base the jmdict database system
	  on postgreslql and perl.
	  I rearranged the cvs directory structure to support this.  (Since
	  this was done on the CVS repository, it is "retroactive".)
	  This tag identified the code base (in the new directory structure)
	  as it existed prior to switch focus to perl.  Because of the
	  directory changes, many python scripts probably won't run as-is.
	  Also, some schema changes were made related to the audit table
	  that haven't been propagated to the python scripts yet.

2006-11-03	smcgrawx@frxii.com

	* Tag T005
	Cgi search form, result list, and entry pages seem to mostly
	  work ok.  

2006-11-03	smcgrawx@frxii.com

	* jbdb.py[1.7]
	Fixed build_search_sql() which returned bad sql under a 
	  number of circumstances.
	Enhance mk_from_clause() to do left rather than inner join
	  if table name prefixed with asterisk.  Need this because we 
	  need outer join when looking for "or" of frequency values. 
	
	* entr.css
	Add formatting for srchfrm.html

	* www/srchres.py
	Accept option string as commnd argument.
	Fix the frequency-of-use input stuff so that it is functional 
	  now.
	Allow display of search sql on results page for debugging.
	Fix problem where searching for two glosses would never find 
	  anything because the generated sql asked for rows where the
	  same gloss was simulataneously equal to g1 and g2.  Now, g1
	  and g2 need only occur in the same sense.  (We probably
	  want "in the same entry" instead, but that will need to 
	  wait.)  Same problem also occured (and ws fixed) for kanji 
	  and reading searches too.

	* www/templates/entr.tal
	Fix synonym, antonym links.

	* wwww/templates/srchfrm.tal
`	Change the use of class attributes to allow better formating
	  in css.
	Correct misnamed "misc" and "nfcmp" elements.
	Minor layout changes such as moving search button and adding
	  horizonal rules between sections.

	* www/templates/srchres.tal
	Add a debug section for displaying the search sql used.

2006-10-26	smcgrawx@frxii.com

	* jbdb.py
	mk_from_clause() was broken, failed to generate valid sql in 
	  some cases because it assumed the added table always should
	  be joined to the previously added table but that is often 
	  wrong; need to join to parent table which may have been 
	  added much earlier.
	Enhance mk_from_clause() to allow multiple instances of the 
	  same table with different aliases.  This fixes problem 
	  where giving (for example) two "gloss" conditions would
	  always results in 0 records found because the sql asked
	  for a record in which gloss.txt was simultaneously equal
	  to two different values.   

2006-10-26	smcgrawx@frxii.com

	* README.txt[1.4]
	Update for cgi stuff.

	* jbdb.py[1.6]
	DbRow object wasn't keeping attribute values in sync with
	  list values, does now.  Derive from object (instead of list
	  as before) and keep values as attributes, map indexed access
	  to attribute access.
	Remove function rslv_refs() since it is no longer used
	  by anything.  
	Add function build_search_sql() and its helper, 
	  mk_from_clause()  This is a slightly rewritten version
	  of what was in showentr.py.

	* showentr.py[1.7]
	Move function build_search_sql() to jbdb.py.

	* www/entr.py[1.1] www/srchfrm.py[1.1] www/srchres.py[1.1]
	* www./simpleTalHelper.py[1.1] www/entr.css[1.1]
	* www/templates/entr.tal[1.l] www/templates/srchfrm.tal[1.l]
	* www/templates/srchres.tal[1.l]
	New files added to demonstrate access via cgi.

2006-10-19	smcgrawx@frxii.com

	Tag T004:
	Tested on Windows 2000 with postgresql-8.1.4, Python-2.5,
	  psycopg2-2.0.5.1.
	Tested on Fedora Core 5 with mysql-5.0.22, Python-2.4.3,
	  MySQLdb-1.2.0,

2006-10-16	smcgrawx@frxii.com

	* jbdb.py[1.5]
	In class jbdb.DbRow, was previously maintaining duplicate 
	  values, one set in the list part of self, the other in 
	  attributes leading to inevitable cases where they got out 
	  of sync. Instead, override __getattr__, __setattr__ to get 
	  set the list values when accessed through attributes.

	* pg/db.py[1.2]
	Pass whatever arguments dbOpen() gets directly to the dbapi
	  connect call.  This moves responsibilty for maintaining 
	  default argument values to the caller and allows not passing
	  some arguments (like usename, which psycopg2 will then 
	  default to the current user's username) if desired.  

	* mysql/db.py[1.2]
	Same changes as for pg/db.py but need to translate some args
	  into mysql dialect, and add some additional parameters for 
	  the unicode issues.
	'conn.charset' was being set to "utf-8".  I think the hyphen 
	  is an error, changed to "utf8"
	Added missing .lastauto() method to Cursor.

2006-10-15	smcgrawx@frxii.com

	* tables.py[1.2]
	Changes to support recursive read in jbdb.DbRow class:
	Add a _pk attribute to all tables.
	Add restr, stagr, and stagk related classes to kana, sens,
	  and sens tables.  This will result in then being read
	  and written automatically, instead of handling them outside
	  of this framework as previously.
	Change the contents of the _related attribute from strings
	  naming that attribute that the "related" list will be
	  attached to on the object, to a list of classes that will
	  be used to instansiate list elements.  Attribute name will
	  be taken from the classes _table attribute.
	Rearrange order of classes to prevent undefined name errors
	  when executing the class definitions.
 	  
	* jbdb.py
	Add DbRow methods() ._read() and ._readrel() that will allow
	  initializing in an instance's data by a database read, and
	  recursively for all related row instances.  This is what drove
	  the changes to tables.py.
	Added functions rslv_refs() and load() (latter moved here from 
	  showentr.py).
	Added/updated comments.

	* pg/schema.sql[1.2]
	Rename view "kr_valid" to "rk_validity".
	Add column k.id to view "re_nokanji".
	Add view rk_valid which will correctly give the valid kanji
	  (including the "nokanji" case) for all readings of any entry,
	  efficiently.

	* load_jjmdict.py
	Updated for consistency with jbdb.py[1.5] and tables.py[1.2].
	Completely rework hanfdling of restr, stagr, and stagk elements.
	  They are now inverted at the time the elements are processed
	  instead of deffering procesing until the entr object is 
	  completely built. 
	Remove debugging print statement inadvertantly left in the 
	  previous version.
	Changed the commit interval from 3975 to 200 after reading 
	  that postgres will slow down when a large number of uncommited 
	  transactions have accumulated, and that one user found (in 
	  a completely dissimilar application) the sweet spot was in 
	  the low hundreds of transactions.  (For us each entr insert 
	  represents a half dozen or more transactions, so we may still 
	  be too high.)

	* showentr.py[1.6]
	Updated for consistency with jbdb.py[1.5] and tables.py[1.2].
	Use the new recursive Entr._read() method to initialize 
	  entry data rather than executing a bunch on sql statements.
	Move function load() into jbdb.py.

	* README.txt[1.3]
	Clarify alarming messages when running the reload.sql script.

2006-10-11	smcgrawx@frxii.com

	* load_jmdict.py[1.5]
	Propagate part-of-speech information to folowing senses in
	each entry.

	Remove the Def_enc global and the code that set if from locale.  
	It wasn't used, and if we need the encoding, we can get it from 
	sys.stdout.encoding.

2006-10-10	smcgrawx@frxii.com

	Tag R002: Posted to jmdict mailing list. 2006-10-10.

2006-10-10	smcgrawx@frxii.com

	Tag T004: Changes to suppport Postgresql in addition to Mysql.

	* Changes.txt pg/db.py mysql/db.py
	New files.

	* jbdb.py[1.4]
	Move Cursor class, function dbOpen() into pg/db.py and mysql/db.py.
	Instead of executing db-specific sql to get the last used auto-number
	  value, move that sql into new cursor method .lastauto() in each
	  of the db-specific db.py modules, and call it in jbdb.py.

	* load_jmdict.py[1.5]
	Get rid of mysql specific code.

	* loadkw.sql reload,sql schema.sql 
	Move into the database-specific directories pg/ and mysql/.

	* README.txt[1.2]
	Updated to include new info about postgresql, remove
	some old info no longer relevent.

	* mysql/schema.sql[1.1]
	Add view "entr_summary".

	* showentr.py[1.4]
	Get rid of mysql specific code.
	When printing glosses, explicitly convert to default encoding
	  so can use "replace" to avoid exception when an unconvertable
	  utf8 character encountered, as commonly happens with iso9959-x
	  characters when default encoding is something like sjis.
	Use query "entr_summary" to get matched entries list, rather
	  than doing the sql in the script.  **Note**: This results
	  in very long response times for the "find>" command when
	  using Mysql, because Mysql executes the view's sql without
	  any consideration of the outer WHERE clause!
	Drop the temp table before trying to create it.
	Conditionalize the sql executed to create the temp table for 
	  mysql or postgresql.

	* sitecustomize[1.2]
	It wasn't actually setting the default encoding. Fixed.

2006/10/09	smcgrawx@frxii.com

	Tags to date:
	T003	Last (I hope) Mysql-only files.
	T002	Files distributed on the jmdict mailing list, 2006/09/21.
	T001	Initial commit
