Title:	Multiple rdng/kanj freq tags displayed
Stat:	closed
Disp:	done
Prio:	high
Cats:	bug
Reqtrs:	
AssdTo:	stuart@friix.com

2007-02-26 00:00:00 stuart@friix.com
  If a reading (or kanji) has a the same FoU tag paired with two 
  (or more) kanji (or readings), the tag will be shown twice (or 
  more) on the reading (or kanji).  Example: seq 1579780 (主人).

2008-05-07 23:09:00 stuart@friix.com
  Freq tags for display were generated by iterating the entry's 
  freq list, and getting the kw string for each non-null kanj 
  (for kfreq) ot rdng (for rfreq) value.

  For seq 1579780, there are one kanji and two readings with a
  "spec1" tag.  This results in freq table records:

   entr | rdng | kanj | kw | value |  kw
  ------+------+------+----+-------+------
    546 |    1 |    1 |  4 |     1 | spec
    546 |    4 |    1 |  4 |     1 | spec

  Iterating the kanj values results in the double spec1's in
  the kanji display.

  Fixed by filtering out duplicate values after generating the 
  freq list.  There are three places this needed to be done:
	tal.py (function TALfreqs())
	fmt.py (functions kanj() and rdng())
	fmtxml.py (function freqs())
  The dup filtering code was moved from jmxml.py (unique() and 
  remove_dups()) to jdb.py (unique() and rmdups()).  We use that
  function (rather than the more conventional use of Python's 
  "set" datatype, because we want to preserve the order of the
  items.)
