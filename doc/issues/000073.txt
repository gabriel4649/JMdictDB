Title:	Some lit or trans glosses w nested parens wrongly parsed
Stat:	closed
Disp:	done
Prio:	low
Cats:	bug
Reqtrs:	
AssdTo:	stuart@friix.com

2007-06-17 00:00:00 stuart@friix.com
  jmparse.pl erroneously parses litteral glosses embedded in a regular
  gloss if the former contains embedded parens.  For example, 2149180 
  (行ってまいります), has the gloss: "So long (lit:"(I'm) going and coming back")".

  In jmparse.pl, function extract_lit() uses the regex "/(lit:[^)]+)/ to
  extract the literal text.  But it appears that some such glosses contain
  parens as part of the lit text so the above pattern recognises it
  incorrectly.  
  
  Similar problem in 1029490 extracing lsrc (trans:) info from
  <gloss>foam rubber (trans: Eversoft (trademark))</gloss>
  (reported by JB).

  A second problem isthat glosses like "lit: xxxx" are not recognised as
  litteral glosses at all.

2007-06-17 00:00:00 stuart@friix.com
  Since this is a temp hack until JB decides on an xml representation, it
  may not be worth spending much time on this.  Perhaps we could generate
  a warning and do manual fixup later since there probably aren't too many
  of these.

2008-04-15 17:44:00 stuart@friix.com
  Fixed this in Perl jmparse.pl since I am not sure when the Python parser
  will be available.  Now uses the regex:
    m/(\((lit|trans):\s*((?:(?:[^()]+)|(?:\(?:[^)]+\)))+)\))/g
  which will allow matching one set of embedded parens.  Could be easily
  extended to multiple (but non-nested) sets of parens but I don't think
  there is any need as there are no such currently in JMdict.

  Also fixed second problem, some glosses have the form "lit: ..." where 
  the entire gloss is a litteral gloss.  This now generate a "lit" rather
  than an "equ" gloss.

  Entries useful for testing: 
    2149180 So long (lit:"(I'm) going and coming back")
    2087840 Super Nintendo (trans: super fam(ily) com(puter))
    1398300 lit: Value-Creation Society
    1127010 (regular) screwdriver (trans: minus(-) driver)
