Title:	edconf.py crash when copying freqs.
Stat:	closed
Disp:	done
Prio:	high
Cats:	dev
Reqtrs:	
AssdTo:	

2010-06-28 20:22:00 stuart
  To reproduce:
  Ass a non-editor, edit seq number 1198180 and click Next.  Result
  is traceback:
  ----
  Traceback (most recent call last):
    File "/home/smg/public_html/cgi-bin/edconf.py", line 317, in <module>
      main (args, opts)
    File "/home/smg/public_html/cgi-bin/edconf.py", line 135, in main
      jdb.copy_freqs (pentr, entr)
    File "../lib/jdb.py", line 880, in copy_freqs
      idx = freq_map (fromentr)
    File "../lib/jdb.py", line 912, in freq_map
      if idx[f]:
  KeyError: Freq(kanj=3, rdng=None, value=34, entr=18750, kw=5)
  ----
  This does not happen when logged in as editor.

2010-06-30 09:34:00 stuart
  Problem was in jdb.copy_freqs():

  	  if idx[f]: ...
          else: ...

  If f is not in idx, a KeyError is raise, rather than the 
  else statment being executed as we wanted.  Changed the 
  "idx[f]" to "idx.get(f)".
