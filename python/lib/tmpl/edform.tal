<html xmlns:tal="http://www.owlfish.com/simpletal/4.1/">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="../jmdict.css"/>
  <title>JMdictDB Entry Edit Form</title>
  <script type="text/javascript" tal:content="structure string: <!--
    function sf(){document.getElementById('kanj').focus();}
    -->" >
    </script>
  </head>
<body class="edform" onload="sf()">
  <span tal:condition="not:e/id" tal:define="global page_title string:Enter a new entry"/>
  <span tal:condition="e/id" tal:define="global page_title string:Edit an existing entry"/>
  <div metal:use-macro="macros/macros/login">
    <h3 metal:fill-slot="title">Entry Edit Form</h3>
    </div>
  <span tal:repeat="e entrs" tal:omit-tag="">
    <comment tal:condition="0">
    This form requires a modified form of Entr object.  It has three
    additional attributes: ktxt, rtxt, stxt.  The values of these are
    JEL formatted text strings that will be used to intialize the Kanji
    Readings, and Senses boxes on this form.  The native ._kanj, ._rng,
    and ._sens attributes of the Entr object are ignored.

    If an entry does not have an id number, is is treated as a new entry.
    It can have other info such as a sense element with PoS list, which
    will set the default text in the appropriate fields.

    We also accept a parameter, "extra" that contains any of the items,
    "ref", "comments", "name", "email" which are used to initialize the
    input boxes of the same names.

    Tab order is set to traverse the main text boxes first (1200-1219)
    advanced (editor-only) text boxes (1220-1239), submission buttons
    (1240-1249), tag help links (1250-1269), text input help links
    (1270-1289), everything else.  Tabindex numbers are above 1000
    because the login controls, which are defined in a different file
    and are used by all pages, use the range 990-999.  For discussion
    see the edict email list, 2011-09-07, "Entry Edit Form: Usability
    improvements".
    </comment>
    <form action="edconf.py" name="edconf" tal:attributes="method method">
      <table class="form">
        <tbody>
          <tr>
            <td colspan="3">
              <span tal:condition="e/id" tal:omit-tag="">
                <h4>Edit an existing entry</h4>
                Make corrections to this entry by changing the information in
                the text boxes below.
                </span>
              <span tal:condition="not: e/id" tal:omit-tag="">
                <h4>Enter a new entry</h4>
                Enter a new Japanese dictionary entry using the text boxes below.
                </span>
              <br/>Please be sure you are familiar with the 
              <a href="http://www.edrdg.org/wiki/index.php/Editorial_policy" tabindex="1270">
                JMdict/EDICT Editorial Policy</a>.
              First-time users should read the
              <a tal:attributes="href string:edhelpq.py?svc=${svc}&amp;sid=${sid}" tabindex="1271">
              quick overview</a> before proceeding.
              For detailed help on the information and syntax required in the various
              fields, please use the "help" links beside each field, or view the
              <a tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}" tabindex="1272">
              full help file</a>.
              <p/>
              </td>
            </tr>

          <tr>
            <td> </td>
            <td>

              <!-- Entry block -->
              <table width="100%" border="1">
                <tr tal:condition="e/id">
                  <td colspan="2">Status:
                    <span tal:condition="e/stat" tal:replace="python:TALdescr('STAT',e.stat)">status</span>
                    <span tal:condition="e/unap" class="pend">(Unapproved)</span>
                    </td>
                  <td colspan="2">Id:
                    <a tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;e=${e/id}" tal:content="e/id"/>
                    <span tal:condition="e/dfrm">(parent:
                      <span tal:condition="e/dfrm" tal:omit-tag="">
                        <a tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;e=${e/dfrm}" tal:content="e/dfrm"/>
                        </span>)
                      </span>
                    </td>
                  </tr>
                <tr tal:condition="e/id">
                  <td colspan="2">Corpus:
                    <span tal:condition="e/src" tal:content="structure python:TALabbr('SRC',e.src)">src</span>
                    </td>
                  <td>Seq:
                    <a tal:condition="e/seq" tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;q=${e/seq}.${e/src}" tal:content="e/seq">seq#</a>
                    </td>
                  </tr>
                <tr tal:condition="e/srcnote">
                  <td colspan="5">Src note: <span tal:content="e/srcnote">src note</span></td>
                  </tr>
                <tr tal:condition="e/notes">
                  <td colspan="5">Entr note: <span tal:content="e/notes">entr note</span></td>
                  </tr>
                <tr tal:condition="e/_grp">
                  <td colspan="5">Groups: <span tal:content="python:TALgrps(e)">groups list</span></td>
                  </tr>
                </table>

              </td>
            </tr>

          <tr tal:condition="not:e/id">
            <td>Corpus: <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#corpus" tabindex="1273">help</a></td>
            <td colspan="2">
              <!-- #1 src parameter when new entry and user is editor (or non-ed w corp option). -->
              <select name="src" tabindex="1201" tal:condition="python:not e.NOCORPOPT or is_editor or not e.src">
                <option tal:condition="not:e/src" tal:attributes="name string:src;value string:0" tal:content=" "/>
                <span tal:repeat="s srcs" tal:omit-tag="">
                  <span tal:omit-tag="">
                    <option name="src" tal:condition="python:s.id==e.src" selected="1" tal:attributes="value s/id" tal:content="s/kw"/>
                    <option name="src" tal:condition="python:s.id!=e.src"              tal:attributes="value s/id" tal:content="s/kw"/>
                    </span>
                  </span>
                </select>
              <span tal:condition="python:not(not e.NOCORPOPT or is_editor or not e.src)" tal:omit-tag="">
                <span tal:replace="structure python:TALabbr('SRC',e.src)">corpus</span>
                <!-- #2 src parameter when new entry and user is not editor w/o corp option. -->
                <input type="hidden" name="src" tal:attributes="value e/src"/>
                </span>
              </td>
            </tr>
          <tr>
            <td>Kanji: <br/><a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kanji" tabindex="1274">help</a></td>
            <td><textarea tal:content="e/ktxt" id="kanj" name="kanj" wrap="physical" cols="60" rows="3" tabindex="1202"></textarea></td>
            <td>
              Tags Help: <br>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_kinf" tabindex="1253">kanji info</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_freq" tabindex="1254">frequency info</a>
              </td></tr>
          <tr>
            <td>Reading(s): <br/><a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#readings" tabindex="1275">help</a></td>
            <td><textarea tal:content="e/rtxt" name="rdng" wrap="physical" cols="60" rows="3" tabindex="1203"></textarea></td>
            <td>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_rinf" tabindex="1255">reading info</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_freq" tabindex="1256">frequency info</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#syn_restr" tabindex="1257">restrictions</a>
              </td></tr>
          <tr>
            <td>Meaning(s): <br/><a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#senses" tabindex="1276">help</a></td>
            <td><textarea tal:content="e/stxt" name="sens" wrap="physical" cols="60" rows="6" tabindex="1204"></textarea></td>
            <td>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_pos" tabindex="1258">part-of-speech</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_misc" tabindex="1259">miscellaneous</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_fld" tabindex="1260">field/domain</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#kw_dial" tabindex="1261">dialect</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#syn_lsrc" tabindex="1262">source-language</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#syn_ginf" tabindex="1263">gloss info</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#syn_restr" tabindex="1264">restrictions</a><br/>
              <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#syn_xref" tabindex="1265">cross-references</a><br/>
              </td></tr>
          <tr tal:condition="e/id">
            <td> </td>
            <td><input type="checkbox" name="delete" tal:attributes="checked e/ISDELETE"/> This entry should be deleted.  (Please justify in Comments and References boxes.)
              &nbsp; <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#delete" tabindex="1277">help</a>
              </td>
            <td></td>
            </tr>
          <tr tal:condition="0"><!-- disabled for now, see IS-143. -->
            <td> </td>
            <td><input type="checkbox" name="makecopy" tal:attributes="checked makecopy"/> Treat as new entry.
              &nbsp; <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#makecopy" tabindex="1278">help</a>
              </td>
            <td></td>
            </tr>
          <tr>
            <td>References: <br/><a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#references" tabindex="1279">help</a></td>
            <td><textarea name="reference" wrap="physical" cols="60" rows="6" tal:content="extra/ref" tabindex="1205"></textarea></td>
            <td></td>
            </tr>
          <tr>
            <td>Comments: <br/><a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#comments" tabindex="1280">help</a></td>
            <td><textarea name="comment" wrap="physical" cols="60" rows="6" tal:content="extra/comment" tabindex="1206"></textarea></td>
            <td></td>
            </tr>
          <tr>
            <td>Name: <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#name" tabindex="1281">help</a></td>
            <td><input type="text" name="name" size="30" tal:attributes="value extra/name|session/fullname" tabindex="1207"/></td>
            <td></td>
            </tr>
          <tr>
            <td>Email: <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#email" tabindex="1282">help</a></td>
            <td><input type="text" name="email" size="30" tal:attributes="value extra/email|session/email" tabindex="1208"/></td>
            <td></td>
            </tr>
          <tr>
            <td></td>
            <td>
              <input type="submit" value=" Next " tabindex="1242"/> &nbsp;
              <span tal:condition="is_editor" tal:omit-tag="">
                &nbsp;&nbsp;
                Action: <select name="disp" tabindex="1241">
                  <option name="disp" value="">Submit</option>
                  <option name="disp" value="a" selected="1">Approve</option>
                  <option name="disp" value="r">Reject</option>
                  </select>
                <a class="helplink" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#action" tabindex="1283">help</a>
                </span>

              <input type="hidden" name="svc" tal:condition="svc" tal:attributes="value svc"/>
              <input type="hidden" name="sid" tal:condition="sid" tal:attributes="value sid"/>
              <input type="hidden" name="id" tal:condition="e/id" tal:attributes="value e/id"/>
              <input type="hidden" name="stat" tal:condition="e/id" tal:attributes="value e/stat"/>
              <input type="hidden" name="dbg" tal:condition="dbg" tal:attributes="value dbg"/>
              <span tal:condition="not:session/userid" tal:omit-tag="">
                <!-- #3 src parameter when existing entry and user is not editor. -->
                <input type="hidden" tal:condition="e/id" name="src" tal:attributes="value e/src"/>
                <input type="hidden" name="seq" tal:attributes="value e/seq"/>
                <input type="hidden" name="srcnote" tal:attributes="value e/srcnote"/>
                <input type="hidden" name="notes" tal:attributes="value e/notes"/>
                </span>
                <br/><span class="notes">
                  Clicking <b>Next</b> will show you a confirmation page from which you can submit your changes.</span>
              </td>
            <td></td>
            </tr>

          <span tal:condition="session/userid" tal:omit-tag="">
            <tr>
              <td colspan="3">
                <br/>
                The following may require changing in rare circumstances...
                </td>
              </tr>
            <tr tal:condition="e/id">
              <td>Corpus: <a class="helplink" target="edhelp" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#corpus" tabindex="1284">help</a></td>
              <td>
                <select name="src" tabindex="1220">
                  <span tal:repeat="s srcs" tal:omit-tag="">
                    <!-- #4 src parameter when existing entry and user is editor. -->
                    <option name="src" tal:condition="not:e/id" tal:attributes="value s/id" tal:content="s/kw"/>
                    <span tal:condition="e/id" tal:omit-tag="">
                      <option name="src" tal:condition="python: s.id==e.src" selected="1" tal:attributes="value s/id" tal:content="s/kw"/>
                      <option name="src" tal:condition="python: s.id!=e.src"              tal:attributes="value s/id" tal:content="s/kw"/>
                      </span>
                    </span>
                  </select>
                </td>
              </tr>
            <tr>
              <td>Seq: <a class="helplink" target="edhelp" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#seq" tabindex="1285">help</a></td>
              <td tal:condition="not:e/id"><input type="text" name="seq" size="8" tal:attributes="value 'default'" tabindex="1221"/></td>
              <td tal:condition="e/id"><input type="text" name="seq" size="8" tal:attributes="value e/seq"/></td>
              </tr>
            <tr>
              <td>Src note: <a class="helplink" target="edhelp" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#srcnote" tabindex="1286">help</a></td>
              <td colspan="3">
                <input name="srcnote" tal:condition="not:e/id" type="text" size="50" tabindex="1222"/>
                <input name="srcnote" tal:condition="e/id" type="text" size="50" tal:attributes="value e/srcnote" tabindex="1223"/>
                </td>
              </tr>
            <tr>
              <td>Entr note: <a class="helplink" target="edhelp" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#entrnote" tabindex="1287">help</a></td>
              <td colspan="3">
                <textarea name="notes" tal:condition="not:e/id" wrap="physical" width="100%" cols="60" rows="2" tabindex="1224"></textarea>
                <textarea name="notes" tal:condition="e/id" wrap="physical" width="100%" cols="60" rows="2" tal:content="e/notes" tabindex="1225"></textarea>
                </td>
              </tr>
            <tr>
              <td>Groups: <a class="helplink" target="edhelp" target="edhelp" tal:attributes="href string:edhelp.py?svc=${svc}&amp;sid=${sid}#groups" tabindex="1288">help</a></td>
              <td colspan="3">
                <textarea name="grp" tal:condition="not:e/id" wrap="physical" width="100%" cols="60" rows="2" tabindex="1226"></textarea>
                <textarea name="grp" tal:condition="e/id" wrap="physical" width="100%" cols="60" rows="2" tal:content="python:TALgrps(e)" tabindex="1227"></textarea>
                </td>
              </tr>
            </span>

          </tbody>
        </table>
      </form>
    </span>
  <span class="notes">
    </span>
  <div metal:use-macro="macros/macros/footer"/>
</body>
</html>
