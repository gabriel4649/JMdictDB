<html xmlns:tal="http://www.owlfish.com/simpletal/4.1/">
<!--? Copyright (c) 2008-2010 Stuart McGraw -->
<!--? $Revision$ $Date$ -->

<!--? ***NOTE***
      Much of this form is very similar to edconf.tal and edits made
      to this form likely also need to be made to edform.tal. -->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="../jmdict.css"/>
  <title>JMdictDB Entries</title>
</head>
<body>
  <div metal:use-macro="macros/macros/login">
    <h3 metal:fill-slot="title">Entries</h3>
    </div>
  <div class="entry" tal:condition="not:entries"> 
     No entries found.
     </div>
  <span tal:repeat="epair entries" tal:omit-tag="">
    <span tal:define="global e    epair/0" tal:omit-tag=""/>
    <span tal:define="global etxt epair/1" tal:omit-tag=""/>
    <div class="entry">
      <span tal:replace="python:TALabbr('SRC',e.src)">src</span>
      <a tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;q=${e/seq}.${e/src}" tal:content="e/seq">seq#</a>
      <span class="status">
	<span tal:condition="e/unap" class="pend">
	  <span tal:content="python:TALdescr('STAT',e.stat)">status</span> pending
	  </span>
	<span tal:condition="not:e/unap" tal:content="python:TALdescr('STAT',e.stat)">status</span>
        <span tal:condition="e/dfrm" tal:omit-tag=""> 
	  (parent: <a tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;e=${e/dfrm}" tal:content="e/dfrm"/>)
	  </span>
	</span>
      <span class="pkid" tal:condition="python:e.id&gt;0">{id:<span tal:replace="e/id" tal:omit-tag=""/>}</span>

      <span tal:condition="not:etxt" tal:omit-tag="">
	<span tal:condition="e/srcnote" tal:omit-tag="">
	  <br/>Src Notes: <span tal:replace="e/srcnote" tal:omit-tag="">srcnote</span>
	  </span>
	<span tal:condition="e/notes">
	  <br/>Entry Notes: <span tal:replace="e/notes" tal:omit-tag="">srcnote</span>
	  </span>

	<br/> 
	<span tal:condition="e/_kanj" tal:repeat="k e/_kanj" tal:omit-tag="">
	  <span tal:condition="not:repeat/k/start" tal:omit-tag="">； </span>
	  <span class="kanj" tal:content="k/txt">kanji text</span>
	  <span class="kattrs" tal:condition="python:TALattror(k,'_inf','_freq')">
	    [<span class="kinf" tal:condition="k/_inf" tal:content="python:TALabbrs('KINF',k,'_inf')">kinf</span>
	     <span tal:condition="python:TALattrand(k,'_inf','_freq')" tal:replace="string:/">/</span>
	     <span class="kfreq" tal:condition="k/_freq" tal:content="python:TALfreqs(k)">kfreq</span>]
	    </span>
	  </span>

	<br tal:condition="e/HAS_RESTR"/>
	<span tal:condition="python:TALattrand(e,'_kanj','_rdng')" tal:omit-tag="">【</span>
	<span tal:repeat="r e/_rdng">
	  <span tal:condition="not:repeat/r/start" tal:omit-tag="">； </span>
	  <span class="rdng" tal:content="r/txt">reading text</span>
	  <span class="restr" tal:condition="r/_RESTR">(
	    <span tal:repeat="z r/_RESTR" tal:omit-tag="">
	      <span tal:condition="not:repeat/z/start" tal:omit-tag="">,</span>
	      <span tal:replace="z"/>
	      </span>)
	    </span>
	  <span class="rattrs" tal:condition="python:TALattror(r,'_inf','_freq')">
	    [<span class="rinf" tal:condition="r/_inf" tal:content="python:TALabbrs('RINF',r,'_inf')">rinf</span>
	    <span tal:condition="python:TALattrand(r,'_inf','_freq')" tal:replace="string:/">/</span>
	    <span class="rfreq" tal:condition="r/_freq" tal:content="python:TALfreqs(r)">rfreq</span>]
	    </span>
	  </span>
	<span tal:condition="python:TALattrand(e,'_kanj','_rdng')" tal:omit-tag="">】</span>

	<table class="senses" border="0" tal:condition="e/_sens">
	  <tr class="sense" tal:repeat="s e/_sens">
	    <td valign="top" tal:content="string:${s/sens}.">n.</td>
	    <td colspan="2">
	      <span class="stag" tal:condition="s/_STAG">
		(<span tal:condition="s/_STAG" tal:repeat="z s/_STAG" tal:omit-tag="">
		  <span tal:condition="not:repeat/z/start" tal:omit-tag="">,</span>
		  <span tal:replace="z" tal:omit-tag="">stag-restr</span>
		  </span> only)
		</span>
	      <span class="pos" tal:condition="s/_pos">
		[<span tal:replace="python:TALabbrs('POS',s,'_pos')">pos</span>]
		</span>
	      <span class="misc" tal:condition="s/_misc">
		[<span tal:replace="python:TALabbrs('MISC',s,'_misc')">misc</span>]
		</span>
	      <span class="fld" tal:condition="s/_fld">
		{<span tal:replace="python:TALdescrs('FLD',s,'_fld')">fields</span>}
		</span>

	      <span class="dial" tal:condition="s/_dial">, 
		Dialect: <span tal:replace="python:TALabbrs('DIAL',s,'_dial')">dial</span>
		</span>
	      <span class="lsrc" tal:condition="s/_lsrc">, 
		From
		<span tal:repeat="z s/_lsrc" tal:omit-tag="">
		  <span tal:replace="python:TALabbr('LANG',z.lang)">(xx)</span
		  ><span tal:condition="python:TALattror(z,'part','wasei')" tal:omit-tag=""
		    >(<span tal:condition="z/part" tal:replace="string: p">p</span
		    ><span tal:condition="python:TALattrand(z,'part','wasei')" tal:replace="string: ,">,</span
		    ><span tal:condition="z/wasei" tal:replace="string: w">w</span
		    >)</span
		  >:<span tal:condition="z/txt" tal:omit-tag="">
		    "<span tal:replace="z/txt">lsource text</span
		    >"</span
		  ><span tal:condition="not:repeat/z/end" tal:omit-tag="">,</span>
		  </span>
		</span>

	      <br/>
	      <span class="note" tal:condition="s/notes">
		《<span tal:replace="s/notes">sense-notes</span>》<br/>
		</span>

	      <span tal:condition="s/_gloss" tal:omit-tag="">
		<span tal:repeat="g s/_gloss" tal:omit-tag="">
		<span class="gloss" tal:replace="string:▶">num.</span>
		  <span tal:condition="python:1!=g.lang" tal:omit-tag="">
		    <span class="glang" tal:replace="python:TALabbr('LANG',g.lang)">lang</span>:
		    </span>
		  <span tal:condition="python:1!=g.ginf" tal:omit-tag="">
		    [<span class="ginf" tal:replace="python:TALabbr('GINF',g.ginf)">lang</span>.]
		    </span>
		  <span tal:replace="g/txt">gloss</span><br/>
		  </span>
		</span>

	      <table class="xrefs" tal:condition="python:TALattror(s,'XREF','XRER','_xrslv')">
                <!-- s.XREF and s.XRER are identical to s._xref and s._xrer except
                     some refs (e.g. to unapproved entries) have been removed. They
                     can be added to an entry by jmcgi.add_filtered_xrefs(). -->
		<tr tal:condition="s/XREF">
		  <td colspan="2">Cross references:</td>   
		  </tr>
		<tr tal:condition="s/XREF" tal:repeat="x s/XREF">
		  <td>&nbsp;</td>
		  <td>
		    <span tal:replace="python:TALabbr('XREF',x.typ)">xref-type</span>:
		    <a tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;e=${x/xentr}" tal:content="x/TARG/seq">seq-num</a>
		    <span tal:condition="x/TARG/_kanj" tal:replace="python:TALkrtxt(x.TARG,'_kanj',x.kanj)">xref-kanj</span>
		    <span tal:condition="python:TALattrand(x,'kanj','rdng')" tal:omit-tag="">【</span>
		    <span tal:condition="x/TARG/_rdng" tal:replace="python:TALkrtxt(x.TARG,'_rdng',x.rdng)">xref-rdng</span>
		    <span tal:condition="python:TALattrand(x,'kanj','rdng')" tal:omit-tag="">】</span>
		    <span tal:replace="x/xsens">s#</span
		    >.<span tal:replace="python:TALtxts(x.TARG._sens[x.xsens-1],'_gloss')"></span>
		    <span tal:condition="x/notes" replace="x/notes">xref-note</span>
		    </td>
		  </tr>
		<tr tal:condition="s/_xrslv">
		  <td colspan="2">Unresolved cross references:</td>   
		  </tr>
		<tr tal:condition="s/_xrslv" tal:repeat="x s/_xrslv">
		  <td>&nbsp;</td>
		  <td>
		    <span tal:replace="python:TALabbr('XREF',x.typ)">xrslv-type</span>:
		    <span tal:condition="x/ktxt" tal:replace="x/ktxt">xrslv-kanj</span>
		    <span tal:condition="python:TALattrand(x,'ktxt','rtxt')" tal:omit-tag="">・</span>
		    <span tal:condition="x/rtxt" tal:replace="x/rtxt">xrslv-rdng</span>
		    </td>
		  </tr>
		<tr tal:condition="s/XRER">
		  <td colspan="2">References to this sense:</td>
		  </tr>
		<tr tal:condition="s/XRER" tal:repeat="x s/XRER">
		  <td>&nbsp;</td>
		  <td>
		    <span tal:replace="python:TALabbr('XREF',x.typ)">xref-type</span>:
		    <a tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;e=${x/entr}" tal:content="x/TARG/seq">seq-num</a>
		    <span tal:condition="x/TARG/_kanj" tal:replace="x/TARG/_kanj/0/txt">xref-kanj</span>
		    <span tal:condition="python:TALattrand(x.TARG,'_kanj','_rdng')" tal:omit-tag="">【</span>
		    <span tal:condition="x/TARG/_rdng" tal:replace="x/TARG/_rdng/0/txt">xref-rdng</span>
		    <span tal:condition="python:TALattrand(x.TARG,'_kanj','_rdng')" tal:omit-tag="">】</span>
		    <span tal:replace="x/sens">s#</span
		    >.<span tal:replace="python:TALtxts(x.TARG._sens[x.sens-1],'_gloss')"></span>
		    <span tal:condition="x/notes" replace="x/notes">xref-note</span>
		    </td>
		  </tr>
		</table>
	      </td>
	    </tr>
	  </table>

	<span tal:condition="e/_grp" tal:omit-tag=""><br/>Belongs to groups:
	  <span tal:repeat="g e/_grp" tal:omit-tag="">
	    <span class="grp">
	      <span tal:replace="python:TALabbr('GRP',g.kw)" tal:omit-tag="">grpname</span
	      >(<span tal:replace="g/ord">ord</span 
	      >)<span tal:condition="not:repeat/g/end" tal:omit-tag="">,</span>
	      </span>
	    </span>
	  </span>

	<span tal:condition="e/HAS_AUDIO" tal:omit-tag=""><br/>Audio:
	  <table class="audio" border=1>
	    <tr tal:repeat="a e/_snd">
	      <td>&nbsp;</td>
	      <td tal:content="a/snd">snd-id</td>
	      <span tal:condition="a/CLIP" tal:omit-tag="">
		<td tal:content="a/CLIP/sdir">snd-dir</td>
		<td tal:content="a/CLIP/sfile">snd-file</td>
		<td tal:content="a/CLIP/strt">snd-strt</td>
		<td tal:content="a/CLIP/leng">snd-leng</td>
		</span>
	      </tr>
	    <span tal:repeat="r e/_rdng" tal:omit-tag="">
	      <tr tal:repeat="a r/_snd">
		<td tal:content="r/txt">reading-text</td>
		<td tal:repeat="a r/_snd">snd-id</td>
		<span tal:condition="a/CLIP" tal:omit-tag="">
		  <td tal:content="a/CLIP/sdir">snd-dir</td>
		  <td tal:content="a/CLIP/sfile">snd-file</td>
		  <td tal:content="a/CLIP/strt">snd-strt</td>
		  <td tal:content="a/CLIP/leng">snd-leng</td>
		  </span>
		</tr>
	      </span>
	    </table>
	  </span>
        </span>

      <span class="preformat" tal:condition="python: etxt and disp=='ed'">
	<!-- Used for edict format only. -->
	<span tal:content="etxt"/>
	</span>

      <span class="preformat" tal:condition="python: etxt and disp!='ed'">
	<pre tal:content="etxt"/>
	</span>

      <form tal:condition="e/EDITABLE" action="edform.py" method="get">
	<input type="submit" value="Edit"/>
	<input type="hidden" name="e" tal:attributes="value e/id"/>
	<input type="hidden" name="svc" tal:condition="svc" tal:attributes="value svc"/>
	<input type="hidden" name="sid" tal:condition="sid" tal:attributes="value sid"/>
	</form>

      <span tal:condition="not:etxt" tal:omit-tag="">
	<div class="hist" tal:condition="e/_hist">History:
	  <table>
           <tbody class="histtab">
	    <span tal:repeat="h e/_hist">
	      <span tal:condition="h/email" tal:omit-tag="">
		<span tal:condition="session/userid">
		  <span tal:define="global email string:&lt;${h/email}&gt;"/>
		  </span>
	        <span tal:condition="not:session/userid">
		  <span tal:define="global email string:&lt;...address hidden...&gt;"/>
		  </span>
		</span>
	      <span tal:condition="not:h/email" tal:omit-tag="">
		<span tal:define="global email string:"/>
		</span>
	      <tr>
		<td tal:content="string:${h/hist}.">#.</td> 
		<td class="hhdr" colspan="2">
		  <span tal:content="string: ${python:TALabbr('STAT',h.stat)}${python:'*' if h.unap else ''}"/>
		  <span tal:content="h/dt">timestamp</span>&nbsp;
		  <span class="submitter_name" tal:content="h/name">name</span>
		  <span tal:content="email">email</span>
		  </td>
		</tr>
	      <tr tal:condition="h/refs">
		<td>&nbsp;</td>
		<td valign="top">Refs:</td>
		<td><pre class="preformat" tal:content="h/refs">refs</pre></td>
	       </tr>
	      <tr tal:condition="h/notes">
		<td>&nbsp;</td>
		<td valign="top">Comments:</td>
		<td><pre class="preformat" tal:content="h/notes">notes</pre></td>
	       </tr>
	      <tr tal:condition="h/diff">
		<td>&nbsp;</td>
		<td valign="top">Diff:</td>
		<td><pre class="preformat" tal:content="h/diff">diff</pre></td>
	       </tr>
	      </span>
             </tbody>
	    </table>
	  </div>
	</span>

      <span class="notes">
	View entry in alternate formats:
        <a class="displink" tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;disp=jel&amp;e=${e/id}">jel</a> |
        <a class="displink" tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;disp=ed&amp;e=${e/id}">edict</a> |
        <a class="displink" tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;disp=jm&amp;e=${e/id}">jmdict xml</a> |
        <a class="displink" tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;disp=jmne&amp;e=${e/id}">jmnedict xml</a> | 
        <a class="displink" tal:attributes="href string:entr.py?svc=${svc}&amp;sid=${sid}&amp;disp=xml&amp;e=${e/id}">jmdictdb xml</a>
	</span>

      </div>
    </span>
  <div metal:use-macro="macros/macros/footer"></div>
  <div class="debug" tal:condition="dbg">
    <span tal:repeat="d h2l: dbg">
      <span tal:replace="d/key">key</span>: <span tal:replace="d/val">value</span><br/>
      </span>
    </div>
  </body>
</html>
